<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Missing values and imputation | Data science in R</title>
  <meta name="description" content="An applied tutorial" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Missing values and imputation | Data science in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="An applied tutorial" />
  <meta name="github-repo" content="ck37/Data-Science-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Missing values and imputation | Data science in R" />
  
  <meta name="twitter:description" content="An applied tutorial" />
  



<meta name="date" content="2020-06-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="initial-data-import.html"/>
<link rel="next" href="dataset-finalization.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Overview</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#rmarkdown-files"><i class="fa fa-check"></i><b>1.1</b> RMarkdown files</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#directory-structure"><i class="fa fa-check"></i><b>1.2</b> Directory structure</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i><b>1.3</b> Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="initial-data-import.html"><a href="initial-data-import.html"><i class="fa fa-check"></i><b>2</b> Initial data import</a><ul>
<li class="chapter" data-level="2.1" data-path="initial-data-import.html"><a href="initial-data-import.html#import-raw-data"><i class="fa fa-check"></i><b>2.1</b> Import raw data</a></li>
<li class="chapter" data-level="2.2" data-path="initial-data-import.html"><a href="initial-data-import.html#merge-data"><i class="fa fa-check"></i><b>2.2</b> Merge data</a></li>
<li class="chapter" data-level="2.3" data-path="initial-data-import.html"><a href="initial-data-import.html#recoding"><i class="fa fa-check"></i><b>2.3</b> Recoding</a></li>
<li class="chapter" data-level="2.4" data-path="initial-data-import.html"><a href="initial-data-import.html#exclusions"><i class="fa fa-check"></i><b>2.4</b> Exclusions</a></li>
<li class="chapter" data-level="2.5" data-path="initial-data-import.html"><a href="initial-data-import.html#categoricals-to-factors"><i class="fa fa-check"></i><b>2.5</b> Categoricals to factors</a></li>
<li class="chapter" data-level="2.6" data-path="initial-data-import.html"><a href="initial-data-import.html#data-structure"><i class="fa fa-check"></i><b>2.6</b> Data structure</a></li>
<li class="chapter" data-level="2.7" data-path="initial-data-import.html"><a href="initial-data-import.html#extreme-value-review"><i class="fa fa-check"></i><b>2.7</b> Extreme value review</a></li>
<li class="chapter" data-level="2.8" data-path="initial-data-import.html"><a href="initial-data-import.html#remove-constant-predictors"><i class="fa fa-check"></i><b>2.8</b> Remove constant predictors</a></li>
<li class="chapter" data-level="2.9" data-path="initial-data-import.html"><a href="initial-data-import.html#tutorial-only-add-random-missingness"><i class="fa fa-check"></i><b>2.9</b> Tutorial-only: add random missingness</a></li>
<li class="chapter" data-level="2.10" data-path="initial-data-import.html"><a href="initial-data-import.html#summarize-predictors"><i class="fa fa-check"></i><b>2.10</b> Summarize predictors</a></li>
<li class="chapter" data-level="" data-path="initial-data-import.html"><a href="initial-data-import.html#save-unimputed-dataset"><i class="fa fa-check"></i>Save unimputed dataset</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="missing-values-and-imputation.html"><a href="missing-values-and-imputation.html"><i class="fa fa-check"></i><b>3</b> Missing values and imputation</a><ul>
<li class="chapter" data-level="3.1" data-path="missing-values-and-imputation.html"><a href="missing-values-and-imputation.html#load-data"><i class="fa fa-check"></i><b>3.1</b> Load data</a></li>
<li class="chapter" data-level="3.2" data-path="missing-values-and-imputation.html"><a href="missing-values-and-imputation.html#examine-predictor-missingness"><i class="fa fa-check"></i><b>3.2</b> Examine predictor missingness</a><ul>
<li class="chapter" data-level="3.2.1" data-path="missing-values-and-imputation.html"><a href="missing-values-and-imputation.html#missingness-table"><i class="fa fa-check"></i><b>3.2.1</b> Missingness table</a></li>
<li class="chapter" data-level="3.2.2" data-path="missing-values-and-imputation.html"><a href="missing-values-and-imputation.html#missingness-heatmap"><i class="fa fa-check"></i><b>3.2.2</b> Missingness heatmap</a></li>
<li class="chapter" data-level="3.2.3" data-path="missing-values-and-imputation.html"><a href="missing-values-and-imputation.html#missingness-count-plot"><i class="fa fa-check"></i><b>3.2.3</b> Missingness count plot</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="missing-values-and-imputation.html"><a href="missing-values-and-imputation.html#examine-outcome-missingness"><i class="fa fa-check"></i><b>3.3</b> Examine outcome missingness</a></li>
<li class="chapter" data-level="3.4" data-path="missing-values-and-imputation.html"><a href="missing-values-and-imputation.html#impute-missing-predictor-values"><i class="fa fa-check"></i><b>3.4</b> Impute missing predictor values</a><ul>
<li class="chapter" data-level="3.4.1" data-path="missing-values-and-imputation.html"><a href="missing-values-and-imputation.html#missingness-indicators"><i class="fa fa-check"></i><b>3.4.1</b> Missingness indicators</a></li>
<li class="chapter" data-level="3.4.2" data-path="missing-values-and-imputation.html"><a href="missing-values-and-imputation.html#impute-to-0"><i class="fa fa-check"></i><b>3.4.2</b> Impute to 0</a></li>
<li class="chapter" data-level="3.4.3" data-path="missing-values-and-imputation.html"><a href="missing-values-and-imputation.html#glrm-prep"><i class="fa fa-check"></i><b>3.4.3</b> GLRM prep</a></li>
<li class="chapter" data-level="3.4.4" data-path="missing-values-and-imputation.html"><a href="missing-values-and-imputation.html#start-h2o"><i class="fa fa-check"></i><b>3.4.4</b> Start h2o</a></li>
<li class="chapter" data-level="3.4.5" data-path="missing-values-and-imputation.html"><a href="missing-values-and-imputation.html#load-data-into-h2o"><i class="fa fa-check"></i><b>3.4.5</b> Load data into h2o</a></li>
<li class="chapter" data-level="3.4.6" data-path="missing-values-and-imputation.html"><a href="missing-values-and-imputation.html#glrm-traintest-split"><i class="fa fa-check"></i><b>3.4.6</b> GLRM train/test split</a></li>
<li class="chapter" data-level="3.4.7" data-path="missing-values-and-imputation.html"><a href="missing-values-and-imputation.html#define-glrm-grid"><i class="fa fa-check"></i><b>3.4.7</b> Define GLRM grid</a></li>
<li class="chapter" data-level="3.4.8" data-path="missing-values-and-imputation.html"><a href="missing-values-and-imputation.html#glrm-grid-search"><i class="fa fa-check"></i><b>3.4.8</b> GLRM grid search</a></li>
<li class="chapter" data-level="3.4.9" data-path="missing-values-and-imputation.html"><a href="missing-values-and-imputation.html#apply-best-glrm"><i class="fa fa-check"></i><b>3.4.9</b> Apply best GLRM</a></li>
<li class="chapter" data-level="3.4.10" data-path="missing-values-and-imputation.html"><a href="missing-values-and-imputation.html#review-glrm"><i class="fa fa-check"></i><b>3.4.10</b> Review GLRM</a></li>
<li class="chapter" data-level="3.4.11" data-path="missing-values-and-imputation.html"><a href="missing-values-and-imputation.html#evaluate-imputation"><i class="fa fa-check"></i><b>3.4.11</b> Evaluate imputation</a></li>
<li class="chapter" data-level="3.4.12" data-path="missing-values-and-imputation.html"><a href="missing-values-and-imputation.html#replace-missing-values."><i class="fa fa-check"></i><b>3.4.12</b> Replace missing values.</a></li>
<li class="chapter" data-level="3.4.13" data-path="missing-values-and-imputation.html"><a href="missing-values-and-imputation.html#shutdown-h2o"><i class="fa fa-check"></i><b>3.4.13</b> Shutdown h2o</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="missing-values-and-imputation.html"><a href="missing-values-and-imputation.html#update-predictor-summary"><i class="fa fa-check"></i><b>3.5</b> Update predictor summary</a></li>
<li class="chapter" data-level="3.6" data-path="missing-values-and-imputation.html"><a href="missing-values-and-imputation.html#histogram-condense"><i class="fa fa-check"></i><b>3.6</b> Histogram condense</a></li>
<li class="chapter" data-level="3.7" data-path="missing-values-and-imputation.html"><a href="missing-values-and-imputation.html#update-predictor-summary-1"><i class="fa fa-check"></i><b>3.7</b> Update predictor summary</a></li>
<li class="chapter" data-level="" data-path="missing-values-and-imputation.html"><a href="missing-values-and-imputation.html#save-imputed-dataset"><i class="fa fa-check"></i>Save imputed dataset</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="dataset-finalization.html"><a href="dataset-finalization.html"><i class="fa fa-check"></i><b>4</b> Dataset finalization</a><ul>
<li class="chapter" data-level="" data-path="dataset-finalization.html"><a href="dataset-finalization.html#load-data-1"><i class="fa fa-check"></i>Load data</a></li>
<li class="chapter" data-level="4.1" data-path="dataset-finalization.html"><a href="dataset-finalization.html#factors-to-indicators"><i class="fa fa-check"></i><b>4.1</b> Factors to indicators</a></li>
<li class="chapter" data-level="4.2" data-path="dataset-finalization.html"><a href="dataset-finalization.html#remove-collinear-predictors"><i class="fa fa-check"></i><b>4.2</b> Remove collinear predictors</a></li>
<li class="chapter" data-level="4.3" data-path="dataset-finalization.html"><a href="dataset-finalization.html#confirm-predictor-matrix-invertability"><i class="fa fa-check"></i><b>4.3</b> Confirm predictor matrix invertability</a></li>
<li class="chapter" data-level="" data-path="dataset-finalization.html"><a href="dataset-finalization.html#save-finalized-dataset"><i class="fa fa-check"></i>Save finalized dataset</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>5</b> Exploratory data analysis</a><ul>
<li class="chapter" data-level="" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#load-data-2"><i class="fa fa-check"></i>Load data</a></li>
<li class="chapter" data-level="" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#tbd"><i class="fa fa-check"></i>TBD</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="modeling.html"><a href="modeling.html"><i class="fa fa-check"></i><b>6</b> Modeling</a><ul>
<li class="chapter" data-level="" data-path="modeling.html"><a href="modeling.html#load-data-3"><i class="fa fa-check"></i>Load data</a></li>
<li class="chapter" data-level="6.1" data-path="modeling.html"><a href="modeling.html#random-forest"><i class="fa fa-check"></i><b>6.1</b> Random forest</a><ul>
<li class="chapter" data-level="6.1.1" data-path="modeling.html"><a href="modeling.html#rf-convergence-plot"><i class="fa fa-check"></i><b>6.1.1</b> RF convergence plot</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="modeling.html"><a href="modeling.html#ensemble"><i class="fa fa-check"></i><b>6.2</b> Ensemble</a><ul>
<li class="chapter" data-level="6.2.1" data-path="modeling.html"><a href="modeling.html#prep-sl-library"><i class="fa fa-check"></i><b>6.2.1</b> Prep SL library</a></li>
<li class="chapter" data-level="6.2.2" data-path="modeling.html"><a href="modeling.html#estimate-superlearner"><i class="fa fa-check"></i><b>6.2.2</b> Estimate SuperLearner</a></li>
<li class="chapter" data-level="6.2.3" data-path="modeling.html"><a href="modeling.html#review-sl-results"><i class="fa fa-check"></i><b>6.2.3</b> Review SL results</a></li>
<li class="chapter" data-level="6.2.4" data-path="modeling.html"><a href="modeling.html#sl-pr-auc"><i class="fa fa-check"></i><b>6.2.4</b> SL PR-AUC</a></li>
<li class="chapter" data-level="6.2.5" data-path="modeling.html"><a href="modeling.html#sl-plots"><i class="fa fa-check"></i><b>6.2.5</b> SL plots</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="modeling.html"><a href="modeling.html#nested-ensemble"><i class="fa fa-check"></i><b>6.3</b> Nested ensemble</a><ul>
<li class="chapter" data-level="6.3.1" data-path="modeling.html"><a href="modeling.html#ensemble-weights"><i class="fa fa-check"></i><b>6.3.1</b> Ensemble weights</a></li>
<li class="chapter" data-level="6.3.2" data-path="modeling.html"><a href="modeling.html#auc-analysis"><i class="fa fa-check"></i><b>6.3.2</b> AUC analysis</a></li>
<li class="chapter" data-level="6.3.3" data-path="modeling.html"><a href="modeling.html#precision-recall-analysis"><i class="fa fa-check"></i><b>6.3.3</b> Precision-Recall analysis</a></li>
<li class="chapter" data-level="6.3.4" data-path="modeling.html"><a href="modeling.html#brier-score"><i class="fa fa-check"></i><b>6.3.4</b> Brier score</a></li>
<li class="chapter" data-level="6.3.5" data-path="modeling.html"><a href="modeling.html#index-of-prediction-accuracy"><i class="fa fa-check"></i><b>6.3.5</b> Index of prediction accuracy</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="calibration.html"><a href="calibration.html"><i class="fa fa-check"></i><b>7</b> Calibration</a><ul>
<li class="chapter" data-level="" data-path="calibration.html"><a href="calibration.html#tbd-1"><i class="fa fa-check"></i>TBD</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="interpretation.html"><a href="interpretation.html"><i class="fa fa-check"></i><b>8</b> Interpretation</a><ul>
<li class="chapter" data-level="" data-path="interpretation.html"><a href="interpretation.html#load-data-4"><i class="fa fa-check"></i>Load data</a></li>
<li class="chapter" data-level="8.1" data-path="interpretation.html"><a href="interpretation.html#variable-importance"><i class="fa fa-check"></i><b>8.1</b> Variable importance</a><ul>
<li class="chapter" data-level="8.1.1" data-path="interpretation.html"><a href="interpretation.html#random-forest-1"><i class="fa fa-check"></i><b>8.1.1</b> Random forest</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="interpretation.html"><a href="interpretation.html#accumulated-local-effect-plots"><i class="fa fa-check"></i><b>8.2</b> Accumulated local effect plots</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data science in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="missing-values-and-imputation" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Missing values and imputation</h1>
<div id="load-data" class="section level2">
<h2><span class="header-section-number">3.1</span> Load data</h2>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="missing-values-and-imputation.html#cb32-1"></a><span class="co"># Created in 1-clean-merge.Rmd</span></span>
<span id="cb32-2"><a href="missing-values-and-imputation.html#cb32-2"></a></span>
<span id="cb32-3"><a href="missing-values-and-imputation.html#cb32-3"></a><span class="co"># Objects included: data, vars</span></span>
<span id="cb32-4"><a href="missing-values-and-imputation.html#cb32-4"></a><span class="co"># renv also includes a load() method, so we specify base:: here.</span></span>
<span id="cb32-5"><a href="missing-values-and-imputation.html#cb32-5"></a>base<span class="op">::</span><span class="kw">load</span>(<span class="st">&quot;data/clean-merge-unimputed.RData&quot;</span>)</span></code></pre></div>
</div>
<div id="examine-predictor-missingness" class="section level2">
<h2><span class="header-section-number">3.2</span> Examine predictor missingness</h2>
<div id="missingness-table" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Missingness table</h3>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="missing-values-and-imputation.html#cb33-1"></a><span class="co"># Look at missingness among predictors.</span></span>
<span id="cb33-2"><a href="missing-values-and-imputation.html#cb33-2"></a>missing =<span class="st"> </span><span class="kw">is.na</span>(data[, vars<span class="op">$</span>predictors])</span>
<span id="cb33-3"><a href="missing-values-and-imputation.html#cb33-3"></a></span>
<span id="cb33-4"><a href="missing-values-and-imputation.html#cb33-4"></a><span class="co"># This will be a zero-row tibble if there is no missingness in the data.</span></span>
<span id="cb33-5"><a href="missing-values-and-imputation.html#cb33-5"></a>missing_df =</span>
<span id="cb33-6"><a href="missing-values-and-imputation.html#cb33-6"></a><span class="st">  </span><span class="kw">data.frame</span>(<span class="dt">var =</span> <span class="kw">colnames</span>(missing),</span>
<span id="cb33-7"><a href="missing-values-and-imputation.html#cb33-7"></a>             <span class="dt">missing_mean =</span> <span class="kw">colMeans</span>(missing),</span>
<span id="cb33-8"><a href="missing-values-and-imputation.html#cb33-8"></a>             <span class="dt">missing_count =</span> <span class="kw">colSums</span>(missing)) <span class="op">%&gt;%</span></span>
<span id="cb33-9"><a href="missing-values-and-imputation.html#cb33-9"></a><span class="st">  </span><span class="kw">filter</span>(missing_count <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(<span class="kw">desc</span>(missing_mean))</span>
<span id="cb33-10"><a href="missing-values-and-imputation.html#cb33-10"></a></span>
<span id="cb33-11"><a href="missing-values-and-imputation.html#cb33-11"></a>missing_df</span></code></pre></div>
<pre><code>##             var missing_mean missing_count
## oldpeak oldpeak   0.02310231             7
## ca           ca   0.01980198             6
## thal       thal   0.01980198             6
## age         age   0.01650165             5
## restecg restecg   0.01650165             5
## cp           cp   0.01320132             4
## fbs         fbs   0.01320132             4
## slope     slope   0.01320132             4
## chol       chol   0.00990099             3
## thalach thalach   0.00990099             3
## sex         sex   0.00660066             2
## exang     exang   0.00330033             1</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="missing-values-and-imputation.html#cb35-1"></a><span class="cf">if</span> (<span class="kw">nrow</span>(missing_df) <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) {</span>
<span id="cb35-2"><a href="missing-values-and-imputation.html#cb35-2"></a>  <span class="kw">cat</span>(<span class="st">&quot;No missinginess found in the predictors.&quot;</span>)</span>
<span id="cb35-3"><a href="missing-values-and-imputation.html#cb35-3"></a>} <span class="cf">else</span> {</span>
<span id="cb35-4"><a href="missing-values-and-imputation.html#cb35-4"></a></span>
<span id="cb35-5"><a href="missing-values-and-imputation.html#cb35-5"></a>  missing_df<span class="op">$</span>missing_mean =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">round</span>(missing_df<span class="op">$</span>missing_mean <span class="op">*</span><span class="st"> </span><span class="dv">100</span>, <span class="dv">1</span>), <span class="st">&quot;%&quot;</span>)</span>
<span id="cb35-6"><a href="missing-values-and-imputation.html#cb35-6"></a>  missing_df<span class="op">$</span>missing_count =<span class="st"> </span><span class="kw">prettyNum</span>(missing_df<span class="op">$</span>missing_count, <span class="dt">big.mark =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb35-7"><a href="missing-values-and-imputation.html#cb35-7"></a>  </span>
<span id="cb35-8"><a href="missing-values-and-imputation.html#cb35-8"></a>  <span class="kw">colnames</span>(missing_df) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Variable&quot;</span>, <span class="st">&quot;Missing rate&quot;</span>, <span class="st">&quot;Missing values&quot;</span>)</span>
<span id="cb35-9"><a href="missing-values-and-imputation.html#cb35-9"></a>  </span>
<span id="cb35-10"><a href="missing-values-and-imputation.html#cb35-10"></a>  <span class="kw">print</span>({ kab_table =<span class="st"> </span><span class="kw">kable</span>(missing_df, <span class="dt">format =</span> <span class="st">&quot;latex&quot;</span>, <span class="dt">digits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>),</span>
<span id="cb35-11"><a href="missing-values-and-imputation.html#cb35-11"></a>                     <span class="dt">booktabs =</span> <span class="ot">TRUE</span>) })</span>
<span id="cb35-12"><a href="missing-values-and-imputation.html#cb35-12"></a>  <span class="kw">cat</span>(kab_table <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">latex_options =</span> <span class="st">&quot;striped&quot;</span>),</span>
<span id="cb35-13"><a href="missing-values-and-imputation.html#cb35-13"></a>      <span class="dt">file =</span> <span class="st">&quot;tables/missingness-table.tex&quot;</span>)</span>
<span id="cb35-14"><a href="missing-values-and-imputation.html#cb35-14"></a>}</span></code></pre></div>
<pre><code>## 
## \begin{tabular}{llll}
## \toprule
##   &amp; Variable &amp; Missing rate &amp; Missing values\\
## \midrule
## oldpeak &amp; oldpeak &amp; 2.3\% &amp; 7\\
## ca &amp; ca &amp; 2\% &amp; 6\\
## thal &amp; thal &amp; 2\% &amp; 6\\
## age &amp; age &amp; 1.7\% &amp; 5\\
## restecg &amp; restecg &amp; 1.7\% &amp; 5\\
## \addlinespace
## cp &amp; cp &amp; 1.3\% &amp; 4\\
## fbs &amp; fbs &amp; 1.3\% &amp; 4\\
## slope &amp; slope &amp; 1.3\% &amp; 4\\
## chol &amp; chol &amp; 1\% &amp; 3\\
## thalach &amp; thalach &amp; 1\% &amp; 3\\
## \addlinespace
## sex &amp; sex &amp; 0.7\% &amp; 2\\
## exang &amp; exang &amp; 0.3\% &amp; 1\\
## \bottomrule
## \end{tabular}</code></pre>
</div>
<div id="missingness-heatmap" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Missingness heatmap</h3>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="missing-values-and-imputation.html#cb37-1"></a><span class="cf">if</span> (<span class="kw">nrow</span>(missing_df) <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) {</span>
<span id="cb37-2"><a href="missing-values-and-imputation.html#cb37-2"></a>  <span class="kw">cat</span>(<span class="st">&quot;Skipping missingness heatmap, no missigness found in predictors.&quot;</span>)</span>
<span id="cb37-3"><a href="missing-values-and-imputation.html#cb37-3"></a>} <span class="cf">else</span> {</span>
<span id="cb37-4"><a href="missing-values-and-imputation.html#cb37-4"></a></span>
<span id="cb37-5"><a href="missing-values-and-imputation.html#cb37-5"></a>  <span class="co"># Correlation table of missingness</span></span>
<span id="cb37-6"><a href="missing-values-and-imputation.html#cb37-6"></a>  <span class="co"># Only examine variables with missingness &gt; 0%.</span></span>
<span id="cb37-7"><a href="missing-values-and-imputation.html#cb37-7"></a>  missing2 =<span class="st"> </span><span class="kw">is.na</span>(data[, <span class="kw">as.character</span>(missing_df<span class="op">$</span>Variable)])</span>
<span id="cb37-8"><a href="missing-values-and-imputation.html#cb37-8"></a>  </span>
<span id="cb37-9"><a href="missing-values-and-imputation.html#cb37-9"></a>  <span class="kw">colMeans</span>(missing2)</span>
<span id="cb37-10"><a href="missing-values-and-imputation.html#cb37-10"></a>  </span>
<span id="cb37-11"><a href="missing-values-and-imputation.html#cb37-11"></a>  <span class="kw">cor</span>(missing2)</span>
<span id="cb37-12"><a href="missing-values-and-imputation.html#cb37-12"></a>  </span>
<span id="cb37-13"><a href="missing-values-and-imputation.html#cb37-13"></a>  <span class="co"># Correlation matrix of missingness.</span></span>
<span id="cb37-14"><a href="missing-values-and-imputation.html#cb37-14"></a>  (<span class="dt">missing_cor =</span> <span class="kw">cor</span>(missing2))</span>
<span id="cb37-15"><a href="missing-values-and-imputation.html#cb37-15"></a>  </span>
<span id="cb37-16"><a href="missing-values-and-imputation.html#cb37-16"></a>  <span class="co"># Replace the unit diagonal with NAs so that it doesn&#39;t show as yellow.</span></span>
<span id="cb37-17"><a href="missing-values-and-imputation.html#cb37-17"></a>  <span class="kw">diag</span>(missing_cor) =<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb37-18"><a href="missing-values-and-imputation.html#cb37-18"></a>  </span>
<span id="cb37-19"><a href="missing-values-and-imputation.html#cb37-19"></a>  <span class="co"># Heatmap of correlation table.</span></span>
<span id="cb37-20"><a href="missing-values-and-imputation.html#cb37-20"></a>  <span class="co">#png(&quot;visuals/missingness-superheat.png&quot;, height = 600, width = 900)</span></span>
<span id="cb37-21"><a href="missing-values-and-imputation.html#cb37-21"></a>  superheat<span class="op">::</span><span class="kw">superheat</span>(missing_cor,</span>
<span id="cb37-22"><a href="missing-values-and-imputation.html#cb37-22"></a>            <span class="co"># Change the angle of the label text</span></span>
<span id="cb37-23"><a href="missing-values-and-imputation.html#cb37-23"></a>            <span class="dt">bottom.label.text.angle =</span> <span class="dv">90</span>,</span>
<span id="cb37-24"><a href="missing-values-and-imputation.html#cb37-24"></a>            <span class="dt">pretty.order.rows =</span> <span class="ot">TRUE</span>,</span>
<span id="cb37-25"><a href="missing-values-and-imputation.html#cb37-25"></a>            <span class="dt">pretty.order.cols =</span> <span class="ot">TRUE</span>,</span>
<span id="cb37-26"><a href="missing-values-and-imputation.html#cb37-26"></a>            <span class="dt">row.dendrogram =</span> <span class="ot">TRUE</span>,</span>
<span id="cb37-27"><a href="missing-values-and-imputation.html#cb37-27"></a>            <span class="dt">scale =</span> <span class="ot">FALSE</span>)</span>
<span id="cb37-28"><a href="missing-values-and-imputation.html#cb37-28"></a>  <span class="co">#dev.off()</span></span>
<span id="cb37-29"><a href="missing-values-and-imputation.html#cb37-29"></a>}</span></code></pre></div>
<p><img src="data-science-in-r_files/figure-html/missingness_heatmap-1.png" width="672" /></p>
</div>
<div id="missingness-count-plot" class="section level3">
<h3><span class="header-section-number">3.2.3</span> Missingness count plot</h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="missing-values-and-imputation.html#cb38-1"></a><span class="cf">if</span> (<span class="kw">nrow</span>(missing_df) <span class="op">==</span><span class="st"> </span>0L) {</span>
<span id="cb38-2"><a href="missing-values-and-imputation.html#cb38-2"></a>  <span class="kw">cat</span>(<span class="st">&quot;Skipping missingness count plot, no missingness found in predictors.&quot;</span>)</span>
<span id="cb38-3"><a href="missing-values-and-imputation.html#cb38-3"></a>} <span class="cf">else</span> {</span>
<span id="cb38-4"><a href="missing-values-and-imputation.html#cb38-4"></a>  </span>
<span id="cb38-5"><a href="missing-values-and-imputation.html#cb38-5"></a>  <span class="co"># Table with count of missing covariates by observation.</span></span>
<span id="cb38-6"><a href="missing-values-and-imputation.html#cb38-6"></a>  missing_counts =<span class="st"> </span><span class="kw">rowSums</span>(missing2)</span>
<span id="cb38-7"><a href="missing-values-and-imputation.html#cb38-7"></a>  <span class="kw">table</span>(missing_counts)</span>
<span id="cb38-8"><a href="missing-values-and-imputation.html#cb38-8"></a>  <span class="co"># Typical observation is missing 6 covariates.</span></span>
<span id="cb38-9"><a href="missing-values-and-imputation.html#cb38-9"></a>  <span class="kw">summary</span>(missing_counts)</span>
<span id="cb38-10"><a href="missing-values-and-imputation.html#cb38-10"></a>  </span>
<span id="cb38-11"><a href="missing-values-and-imputation.html#cb38-11"></a>  <span class="co"># Code from:</span></span>
<span id="cb38-12"><a href="missing-values-and-imputation.html#cb38-12"></a>  <span class="co"># https://stackoverflow.com/questions/27850123/ggplot2-have-shorter-tick-marks-for-tick-marks-without-labels?noredirect=1&amp;lq=1</span></span>
<span id="cb38-13"><a href="missing-values-and-imputation.html#cb38-13"></a>  </span>
<span id="cb38-14"><a href="missing-values-and-imputation.html#cb38-14"></a>  <span class="co"># Major tick marks</span></span>
<span id="cb38-15"><a href="missing-values-and-imputation.html#cb38-15"></a>  major =<span class="st"> </span><span class="dv">100</span></span>
<span id="cb38-16"><a href="missing-values-and-imputation.html#cb38-16"></a>  </span>
<span id="cb38-17"><a href="missing-values-and-imputation.html#cb38-17"></a>  <span class="co"># Minor tick marks</span></span>
<span id="cb38-18"><a href="missing-values-and-imputation.html#cb38-18"></a>  minor =<span class="st"> </span><span class="dv">20</span></span>
<span id="cb38-19"><a href="missing-values-and-imputation.html#cb38-19"></a>  </span>
<span id="cb38-20"><a href="missing-values-and-imputation.html#cb38-20"></a>  <span class="co"># Range of x values</span></span>
<span id="cb38-21"><a href="missing-values-and-imputation.html#cb38-21"></a>  <span class="co"># Ensure that we always start at 0.</span></span>
<span id="cb38-22"><a href="missing-values-and-imputation.html#cb38-22"></a>  (<span class="dt">range =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="op">*</span><span class="st"> </span>minor <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(missing_counts <span class="op">==</span><span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">names</span>(<span class="kw">which.max</span>(<span class="kw">table</span>(missing_counts)))))))</span>
<span id="cb38-23"><a href="missing-values-and-imputation.html#cb38-23"></a>  </span>
<span id="cb38-24"><a href="missing-values-and-imputation.html#cb38-24"></a>  <span class="co"># Function to insert blank labels</span></span>
<span id="cb38-25"><a href="missing-values-and-imputation.html#cb38-25"></a>  <span class="co"># Borrowed from https://stackoverflow.com/questions/14490071/adding-minor-tick-marks-to-the-x-axis-in-ggplot2-with-no-labels/14490652#14490652</span></span>
<span id="cb38-26"><a href="missing-values-and-imputation.html#cb38-26"></a>  insert_minor &lt;-<span class="st"> </span><span class="cf">function</span>(major, n_minor) {</span>
<span id="cb38-27"><a href="missing-values-and-imputation.html#cb38-27"></a>        labs &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">sapply</span>(major, <span class="cf">function</span>(x, y) <span class="kw">c</span>(x, <span class="kw">rep</span>(<span class="st">&quot;&quot;</span>, y) ), <span class="dt">y =</span> <span class="kw">round</span>(n_minor)))</span>
<span id="cb38-28"><a href="missing-values-and-imputation.html#cb38-28"></a>        labs[<span class="dv">1</span><span class="op">:</span>(<span class="kw">length</span>(labs) <span class="op">-</span><span class="st"> </span>n_minor)]</span>
<span id="cb38-29"><a href="missing-values-and-imputation.html#cb38-29"></a>  }</span>
<span id="cb38-30"><a href="missing-values-and-imputation.html#cb38-30"></a>  </span>
<span id="cb38-31"><a href="missing-values-and-imputation.html#cb38-31"></a>  <span class="co"># Getting the &#39;breaks&#39; and &#39;labels&#39; for the ggplot</span></span>
<span id="cb38-32"><a href="missing-values-and-imputation.html#cb38-32"></a>  n_minor =<span class="st"> </span>major <span class="op">/</span><span class="st"> </span>minor <span class="op">-</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb38-33"><a href="missing-values-and-imputation.html#cb38-33"></a>  (<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="kw">min</span>(range), <span class="kw">max</span>(range), minor))</span>
<span id="cb38-34"><a href="missing-values-and-imputation.html#cb38-34"></a>  (<span class="dt">labels =</span> <span class="kw">insert_minor</span>(<span class="kw">seq</span>(<span class="kw">min</span>(range), <span class="kw">max</span>(range), major), n_minor))</span>
<span id="cb38-35"><a href="missing-values-and-imputation.html#cb38-35"></a>  <span class="cf">if</span> (<span class="kw">length</span>(breaks) <span class="op">&gt;</span><span class="st"> </span><span class="kw">length</span>(labels)) labels =<span class="st"> </span><span class="kw">c</span>(labels, <span class="kw">rep</span>(<span class="st">&quot;&quot;</span>, <span class="kw">length</span>(breaks) <span class="op">-</span><span class="st"> </span><span class="kw">length</span>(labels)))</span>
<span id="cb38-36"><a href="missing-values-and-imputation.html#cb38-36"></a></span>
<span id="cb38-37"><a href="missing-values-and-imputation.html#cb38-37"></a></span>
<span id="cb38-38"><a href="missing-values-and-imputation.html#cb38-38"></a>  <span class="kw">print</span>(<span class="kw">ggplot</span>(<span class="kw">data.frame</span>(missing_counts), <span class="kw">aes</span>(<span class="dt">x =</span> missing_counts)) <span class="op">+</span></span>
<span id="cb38-39"><a href="missing-values-and-imputation.html#cb38-39"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..count..)) <span class="op">+</span></span>
<span id="cb38-40"><a href="missing-values-and-imputation.html#cb38-40"></a><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></span>
<span id="cb38-41"><a href="missing-values-and-imputation.html#cb38-41"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> scales<span class="op">::</span><span class="kw">percent</span>(..prop..), <span class="dt">y =</span> ..count..),</span>
<span id="cb38-42"><a href="missing-values-and-imputation.html#cb38-42"></a>             <span class="dt">stat =</span> <span class="st">&quot;count&quot;</span>, <span class="dt">hjust =</span> <span class="fl">-0.2</span>, <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">nudge_x =</span> <span class="fl">0.05</span>,</span>
<span id="cb38-43"><a href="missing-values-and-imputation.html#cb38-43"></a>            <span class="dt">color =</span> <span class="st">&quot;gray30&quot;</span>,</span>
<span id="cb38-44"><a href="missing-values-and-imputation.html#cb38-44"></a>            <span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb38-45"><a href="missing-values-and-imputation.html#cb38-45"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="kw">max</span>(<span class="kw">table</span>(missing_counts)))) <span class="op">+</span></span>
<span id="cb38-46"><a href="missing-values-and-imputation.html#cb38-46"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> breaks,</span>
<span id="cb38-47"><a href="missing-values-and-imputation.html#cb38-47"></a>                     <span class="dt">labels =</span> <span class="kw">ifelse</span>(labels <span class="op">!=</span><span class="st"> &quot;&quot;</span>, <span class="kw">prettyNum</span>(labels, <span class="dt">big.mark =</span> <span class="st">&quot;,&quot;</span>, <span class="dt">preserve.width =</span> <span class="st">&quot;none&quot;</span>), <span class="st">&quot;&quot;</span>),</span>
<span id="cb38-48"><a href="missing-values-and-imputation.html#cb38-48"></a>                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">max</span>(range))) <span class="op">+</span></span>
<span id="cb38-49"><a href="missing-values-and-imputation.html#cb38-49"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Distribution of number of missing covariates&quot;</span>,</span>
<span id="cb38-50"><a href="missing-values-and-imputation.html#cb38-50"></a>       <span class="dt">x =</span> <span class="st">&quot;Number of covariates that are missing&quot;</span>,</span>
<span id="cb38-51"><a href="missing-values-and-imputation.html#cb38-51"></a>       <span class="dt">y =</span> <span class="st">&quot;Count of observations in dataset&quot;</span>) <span class="op">+</span></span>
<span id="cb38-52"><a href="missing-values-and-imputation.html#cb38-52"></a><span class="st">  </span><span class="co"># Remove grid axes, add gray background.</span></span>
<span id="cb38-53"><a href="missing-values-and-imputation.html#cb38-53"></a><span class="st">  </span><span class="co"># Label each value on x axis.</span></span>
<span id="cb38-54"><a href="missing-values-and-imputation.html#cb38-54"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb38-55"><a href="missing-values-and-imputation.html#cb38-55"></a>        <span class="dt">axis.ticks.x =</span> <span class="kw">element_line</span>(<span class="dt">color =</span> <span class="st">&quot;gray60&quot;</span>, <span class="dt">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb38-56"><a href="missing-values-and-imputation.html#cb38-56"></a>        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;gray50&quot;</span>),</span>
<span id="cb38-57"><a href="missing-values-and-imputation.html#cb38-57"></a>        <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;gray95&quot;</span>)) <span class="op">+</span></span>
<span id="cb38-58"><a href="missing-values-and-imputation.html#cb38-58"></a><span class="st">  </span><span class="kw">coord_flip</span>())</span>
<span id="cb38-59"><a href="missing-values-and-imputation.html#cb38-59"></a>  <span class="kw">ggsave</span>(<span class="st">&quot;visuals/missing-count-hist.png&quot;</span>, <span class="dt">width =</span> <span class="dv">8</span>, <span class="dt">height =</span> <span class="dv">4</span>)</span>
<span id="cb38-60"><a href="missing-values-and-imputation.html#cb38-60"></a>  </span>
<span id="cb38-61"><a href="missing-values-and-imputation.html#cb38-61"></a>  <span class="co"># X variables with missingness</span></span>
<span id="cb38-62"><a href="missing-values-and-imputation.html#cb38-62"></a>  <span class="kw">print</span>(<span class="kw">ncol</span>(missing2))</span>
<span id="cb38-63"><a href="missing-values-and-imputation.html#cb38-63"></a></span>
<span id="cb38-64"><a href="missing-values-and-imputation.html#cb38-64"></a>}</span></code></pre></div>
<p><img src="data-science-in-r_files/figure-html/missingness_count-1.png" width="672" /></p>
<pre><code>## [1] 12</code></pre>
</div>
</div>
<div id="examine-outcome-missingness" class="section level2">
<h2><span class="header-section-number">3.3</span> Examine outcome missingness</h2>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="missing-values-and-imputation.html#cb40-1"></a><span class="kw">table</span>(data[[vars<span class="op">$</span>outcomes[<span class="dv">1</span>]]], <span class="dt">useNA =</span> <span class="st">&quot;ifany&quot;</span>)</span></code></pre></div>
<pre><code>## 
##   0   1 
## 138 165</code></pre>
</div>
<div id="impute-missing-predictor-values" class="section level2">
<h2><span class="header-section-number">3.4</span> Impute missing predictor values</h2>
<div id="missingness-indicators" class="section level3">
<h3><span class="header-section-number">3.4.1</span> Missingness indicators</h3>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="missing-values-and-imputation.html#cb42-1"></a><span class="co"># Briefly review missingness.</span></span>
<span id="cb42-2"><a href="missing-values-and-imputation.html#cb42-2"></a><span class="kw">colMeans</span>(<span class="kw">is.na</span>(data[, vars<span class="op">$</span>predictors]))</span></code></pre></div>
<pre><code>##        age        sex         cp   trestbps       chol        fbs    restecg 
## 0.01650165 0.00660066 0.01320132 0.00000000 0.00990099 0.01320132 0.01650165 
##    thalach      exang    oldpeak      slope         ca       thal 
## 0.00990099 0.00330033 0.02310231 0.01320132 0.01980198 0.01980198</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="missing-values-and-imputation.html#cb44-1"></a><span class="co"># First create matrix of missingness indicators for all covariates.</span></span>
<span id="cb44-2"><a href="missing-values-and-imputation.html#cb44-2"></a>miss_inds =</span>
<span id="cb44-3"><a href="missing-values-and-imputation.html#cb44-3"></a><span class="st">  </span>ck37r<span class="op">::</span><span class="kw">missingness_indicators</span>(data,</span>
<span id="cb44-4"><a href="missing-values-and-imputation.html#cb44-4"></a>                                <span class="dt">skip_vars =</span> <span class="kw">c</span>(vars<span class="op">$</span>exclude, vars<span class="op">$</span>outcome),</span>
<span id="cb44-5"><a href="missing-values-and-imputation.html#cb44-5"></a>                                <span class="dt">verbose =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## Generating 12 missingness indicators.
## Checking for collinearity of indicators.
## Final number of indicators: 12</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="missing-values-and-imputation.html#cb46-1"></a><span class="kw">colMeans</span>(miss_inds)</span></code></pre></div>
<pre><code>##     miss_age     miss_sex      miss_cp    miss_chol     miss_fbs miss_restecg 
##   0.01650165   0.00660066   0.01320132   0.00990099   0.01320132   0.01650165 
## miss_thalach   miss_exang miss_oldpeak   miss_slope      miss_ca    miss_thal 
##   0.00990099   0.00330033   0.02310231   0.01320132   0.01980198   0.01980198</code></pre>
</div>
<div id="impute-to-0" class="section level3">
<h3><span class="header-section-number">3.4.2</span> Impute to 0</h3>
<p>Some variables we want to explicitly set to 0 if they are unobserved.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="missing-values-and-imputation.html#cb48-1"></a><span class="co"># Manually impute certain variables to 0 rather than use the sample median (or GLRM).</span></span>
<span id="cb48-2"><a href="missing-values-and-imputation.html#cb48-2"></a>impute_to_<span class="dv">0</span>_vars =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;exang&quot;</span>)</span>
<span id="cb48-3"><a href="missing-values-and-imputation.html#cb48-3"></a></span>
<span id="cb48-4"><a href="missing-values-and-imputation.html#cb48-4"></a><span class="co"># Review missingness one last time for these vars.</span></span>
<span id="cb48-5"><a href="missing-values-and-imputation.html#cb48-5"></a><span class="kw">colMeans</span>(<span class="kw">is.na</span>(data[, impute_to_<span class="dv">0</span>_vars, <span class="dt">drop =</span> <span class="ot">FALSE</span>]))</span></code></pre></div>
<pre><code>##      exang 
## 0.00330033</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="missing-values-and-imputation.html#cb50-1"></a><span class="co"># Also review the median before we conduct imputation.</span></span>
<span id="cb50-2"><a href="missing-values-and-imputation.html#cb50-2"></a><span class="kw">summary</span>(data[, impute_to_<span class="dv">0</span>_vars])</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
##  0.0000  0.0000  0.0000  0.3278  1.0000  1.0000       1</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="missing-values-and-imputation.html#cb52-1"></a><span class="co"># Impute these variables specifically to 0, rather than sample median (although</span></span>
<span id="cb52-2"><a href="missing-values-and-imputation.html#cb52-2"></a><span class="co"># in many cases the median was already 0).</span></span>
<span id="cb52-3"><a href="missing-values-and-imputation.html#cb52-3"></a>data[, impute_to_<span class="dv">0</span>_vars] =<span class="st"> </span><span class="kw">lapply</span>(data[, impute_to_<span class="dv">0</span>_vars, <span class="dt">drop =</span> <span class="ot">FALSE</span>], <span class="cf">function</span>(col) {</span>
<span id="cb52-4"><a href="missing-values-and-imputation.html#cb52-4"></a>  col[<span class="kw">is.na</span>(col)] =<span class="st"> </span>0L</span>
<span id="cb52-5"><a href="missing-values-and-imputation.html#cb52-5"></a>  col</span>
<span id="cb52-6"><a href="missing-values-and-imputation.html#cb52-6"></a>})</span>
<span id="cb52-7"><a href="missing-values-and-imputation.html#cb52-7"></a></span>
<span id="cb52-8"><a href="missing-values-and-imputation.html#cb52-8"></a><span class="co"># Confirm we have no more missingness in these vars.</span></span>
<span id="cb52-9"><a href="missing-values-and-imputation.html#cb52-9"></a><span class="kw">colMeans</span>(<span class="kw">is.na</span>(data[, impute_to_<span class="dv">0</span>_vars, <span class="dt">drop =</span> <span class="ot">FALSE</span>]))</span></code></pre></div>
<pre><code>## exang 
##     0</code></pre>
<p>We will use generalized low-rank models in h2o.ai software.</p>
</div>
<div id="glrm-prep" class="section level3">
<h3><span class="header-section-number">3.4.3</span> GLRM prep</h3>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="missing-values-and-imputation.html#cb54-1"></a><span class="co"># Subset using var_df$var so that it&#39;s in the same order as var_df.</span></span>
<span id="cb54-2"><a href="missing-values-and-imputation.html#cb54-2"></a>impute_df =<span class="st"> </span>data[, var_df<span class="op">$</span>var]</span>
<span id="cb54-3"><a href="missing-values-and-imputation.html#cb54-3"></a></span>
<span id="cb54-4"><a href="missing-values-and-imputation.html#cb54-4"></a><span class="co"># Convert binary variables to logical</span></span>
<span id="cb54-5"><a href="missing-values-and-imputation.html#cb54-5"></a>(<span class="dt">binary_vars =</span> var_df<span class="op">$</span>var[var_df<span class="op">$</span>type <span class="op">==</span><span class="st"> &quot;binary&quot;</span>])</span></code></pre></div>
<pre><code>## character(0)</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="missing-values-and-imputation.html#cb56-1"></a><span class="cf">for</span> (binary_name <span class="cf">in</span> binary_vars) {</span>
<span id="cb56-2"><a href="missing-values-and-imputation.html#cb56-2"></a>  impute_df[[binary_name]] =<span class="st"> </span><span class="kw">as.logical</span>(impute_df[[binary_name]])</span>
<span id="cb56-3"><a href="missing-values-and-imputation.html#cb56-3"></a>}</span>
<span id="cb56-4"><a href="missing-values-and-imputation.html#cb56-4"></a></span>
<span id="cb56-5"><a href="missing-values-and-imputation.html#cb56-5"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: these will be turned into factor variables within h2o.</span></span>
<span id="cb56-6"><a href="missing-values-and-imputation.html#cb56-6"></a><span class="kw">table</span>(<span class="kw">sapply</span>(impute_df, class))</span></code></pre></div>
<pre><code>## 
##  factor integer numeric 
##       5       7       1</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="missing-values-and-imputation.html#cb58-1"></a><span class="co"># Create a dataframe describing the loss function by variable; the first variable must have index = 0</span></span>
<span id="cb58-2"><a href="missing-values-and-imputation.html#cb58-2"></a>losses =<span class="st"> </span><span class="kw">data.frame</span>(<span class="st">&quot;index&quot;</span> =<span class="st"> </span><span class="kw">seq</span>(<span class="kw">ncol</span>(impute_df)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb58-3"><a href="missing-values-and-imputation.html#cb58-3"></a>                    <span class="st">&quot;feature&quot;</span> =<span class="st"> </span>var_df<span class="op">$</span>var,</span>
<span id="cb58-4"><a href="missing-values-and-imputation.html#cb58-4"></a>                    <span class="st">&quot;class&quot;</span> =<span class="st"> </span>var_df<span class="op">$</span>class,</span>
<span id="cb58-5"><a href="missing-values-and-imputation.html#cb58-5"></a>                    <span class="st">&quot;type&quot;</span> =<span class="st"> </span>var_df<span class="op">$</span>type,</span>
<span id="cb58-6"><a href="missing-values-and-imputation.html#cb58-6"></a>                    <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span>
<span id="cb58-7"><a href="missing-values-and-imputation.html#cb58-7"></a></span>
<span id="cb58-8"><a href="missing-values-and-imputation.html#cb58-8"></a></span>
<span id="cb58-9"><a href="missing-values-and-imputation.html#cb58-9"></a><span class="co"># Update class for binary variables.</span></span>
<span id="cb58-10"><a href="missing-values-and-imputation.html#cb58-10"></a><span class="cf">for</span> (binary_name <span class="cf">in</span> binary_vars) {</span>
<span id="cb58-11"><a href="missing-values-and-imputation.html#cb58-11"></a>  losses[var_df<span class="op">$</span>var <span class="op">==</span><span class="st"> </span>binary_name, <span class="st">&quot;class&quot;</span>] =<span class="st"> </span><span class="kw">class</span>(impute_df[[binary_name]])</span>
<span id="cb58-12"><a href="missing-values-and-imputation.html#cb58-12"></a>}</span>
<span id="cb58-13"><a href="missing-values-and-imputation.html#cb58-13"></a></span>
<span id="cb58-14"><a href="missing-values-and-imputation.html#cb58-14"></a>losses<span class="op">$</span>loss[losses<span class="op">$</span>class <span class="op">==</span><span class="st"> &quot;numeric&quot;</span>] =<span class="st"> &quot;Huber&quot;</span></span>
<span id="cb58-15"><a href="missing-values-and-imputation.html#cb58-15"></a></span>
<span id="cb58-16"><a href="missing-values-and-imputation.html#cb58-16"></a>losses<span class="op">$</span>loss[losses<span class="op">$</span>class <span class="op">==</span><span class="st"> &quot;integer&quot;</span>] =<span class="st"> &quot;Huber&quot;</span></span>
<span id="cb58-17"><a href="missing-values-and-imputation.html#cb58-17"></a><span class="co">#losses$loss[losses$class == &quot;integer&quot;] = &quot;Poisson&quot;</span></span>
<span id="cb58-18"><a href="missing-values-and-imputation.html#cb58-18"></a></span>
<span id="cb58-19"><a href="missing-values-and-imputation.html#cb58-19"></a>losses<span class="op">$</span>loss[losses<span class="op">$</span>class <span class="op">==</span><span class="st"> &quot;factor&quot;</span>] =<span class="st"> &quot;Categorical&quot;</span></span>
<span id="cb58-20"><a href="missing-values-and-imputation.html#cb58-20"></a></span>
<span id="cb58-21"><a href="missing-values-and-imputation.html#cb58-21"></a>losses<span class="op">$</span>loss[losses<span class="op">$</span>type <span class="op">==</span><span class="st"> &quot;binary&quot;</span>] =<span class="st"> &quot;Hinge&quot;</span></span>
<span id="cb58-22"><a href="missing-values-and-imputation.html#cb58-22"></a><span class="co"># Logistic seems to yield worse reconstruction RMSE overall.</span></span>
<span id="cb58-23"><a href="missing-values-and-imputation.html#cb58-23"></a><span class="co">#losses$loss[losses$type == &quot;binary&quot;] = &quot;Logistic&quot;</span></span>
<span id="cb58-24"><a href="missing-values-and-imputation.html#cb58-24"></a></span>
<span id="cb58-25"><a href="missing-values-and-imputation.html#cb58-25"></a></span>
<span id="cb58-26"><a href="missing-values-and-imputation.html#cb58-26"></a>losses</span></code></pre></div>
<pre><code>##    index  feature   class        type        loss
## 1      0       ca  factor categorical Categorical
## 2      1  oldpeak numeric  continuous       Huber
## 3      2  restecg integer     integer       Huber
## 4      3    slope  factor categorical Categorical
## 5      4      age integer     integer       Huber
## 6      5      sex  factor categorical Categorical
## 7      6       cp  factor categorical Categorical
## 8      7    exang integer     integer       Huber
## 9      8     thal  factor categorical Categorical
## 10     9  thalach integer     integer       Huber
## 11    10     chol integer     integer       Huber
## 12    11      fbs integer     integer       Huber
## 13    12 trestbps integer     integer       Huber</code></pre>
</div>
<div id="start-h2o" class="section level3">
<h3><span class="header-section-number">3.4.4</span> Start h2o</h3>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="missing-values-and-imputation.html#cb60-1"></a><span class="co"># We are avoiding library(h2o) due to namespace conflicts with dplyr &amp; related packages.</span></span>
<span id="cb60-2"><a href="missing-values-and-imputation.html#cb60-2"></a><span class="co"># Initialize h2o</span></span>
<span id="cb60-3"><a href="missing-values-and-imputation.html#cb60-3"></a>h2o<span class="op">::</span><span class="kw">h2o.no_progress</span>()  <span class="co"># Turn off progress bars</span></span>
<span id="cb60-4"><a href="missing-values-and-imputation.html#cb60-4"></a>analyst_name =<span class="st"> &quot;chris-kennedy&quot;</span></span>
<span id="cb60-5"><a href="missing-values-and-imputation.html#cb60-5"></a>h2o<span class="op">::</span><span class="kw">h2o.init</span>(<span class="dt">max_mem_size =</span> <span class="st">&quot;15g&quot;</span>,</span>
<span id="cb60-6"><a href="missing-values-and-imputation.html#cb60-6"></a>              <span class="dt">name =</span> <span class="kw">paste0</span>(<span class="st">&quot;h2o-&quot;</span>, analyst_name),</span>
<span id="cb60-7"><a href="missing-values-and-imputation.html#cb60-7"></a>              <span class="co"># Default port is 54321, but other analysts may be using that.</span></span>
<span id="cb60-8"><a href="missing-values-and-imputation.html#cb60-8"></a>              <span class="dt">port =</span> <span class="dv">54320</span>,</span>
<span id="cb60-9"><a href="missing-values-and-imputation.html#cb60-9"></a>              <span class="co"># This can reduce accidental sharing of h2o processes on a shared server.</span></span>
<span id="cb60-10"><a href="missing-values-and-imputation.html#cb60-10"></a>              <span class="dt">username =</span> analyst_name,</span>
<span id="cb60-11"><a href="missing-values-and-imputation.html#cb60-11"></a>              <span class="dt">password =</span> <span class="kw">paste0</span>(<span class="st">&quot;pw-&quot;</span>, analyst_name),</span>
<span id="cb60-12"><a href="missing-values-and-imputation.html#cb60-12"></a>              <span class="co"># Use half of available cores for h2o.</span></span>
<span id="cb60-13"><a href="missing-values-and-imputation.html#cb60-13"></a>              <span class="dt">nthreads =</span> <span class="kw">get_cores</span>())</span></code></pre></div>
<pre><code>## 
## H2O is not running yet, starting it now...
## 
## Note:  In case of errors look at the following log files:
##     C:\Users\chris\AppData\Local\Temp\RtmpyaFxH9\file2c8c63dc2230/h2o_chris_started_from_r.out
##     C:\Users\chris\AppData\Local\Temp\RtmpyaFxH9\file2c8c10d3703f/h2o_chris_started_from_r.err
## 
## 
## Starting H2O JVM and connecting:  Connection successful!
## 
## R is connected to the H2O cluster: 
##     H2O cluster uptime:         3 seconds 151 milliseconds 
##     H2O cluster timezone:       America/Los_Angeles 
##     H2O data parsing timezone:  UTC 
##     H2O cluster version:        3.30.0.1 
##     H2O cluster version age:    2 months and 7 days  
##     H2O cluster name:           h2o-chris-kennedy 
##     H2O cluster total nodes:    1 
##     H2O cluster total memory:   15.00 GB 
##     H2O cluster total cores:    12 
##     H2O cluster allowed cores:  3 
##     H2O cluster healthy:        TRUE 
##     H2O Connection ip:          localhost 
##     H2O Connection port:        54320 
##     H2O Connection proxy:       NA 
##     H2O Internal Security:      FALSE 
##     H2O API Extensions:         Amazon S3, Algos, AutoML, Core V3, TargetEncoder, Core V4 
##     R Version:                  R version 3.6.2 (2019-12-12)</code></pre>
</div>
<div id="load-data-into-h2o" class="section level3">
<h3><span class="header-section-number">3.4.5</span> Load data into h2o</h3>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="missing-values-and-imputation.html#cb62-1"></a><span class="co"># Convert data to h2o object</span></span>
<span id="cb62-2"><a href="missing-values-and-imputation.html#cb62-2"></a>h2o_df =<span class="st"> </span>h2o<span class="op">::</span><span class="kw">as.h2o</span>(impute_df)</span></code></pre></div>
<pre><code>## Warning in use.package(&quot;data.table&quot;): data.table cannot be used without R
## package bit64 version 0.9.7 or higher. Please upgrade to take advangage of
## data.table speedups.</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="missing-values-and-imputation.html#cb64-1"></a>(<span class="dt">h2o_types =</span> <span class="kw">unlist</span>(h2o<span class="op">::</span><span class="kw">h2o.getTypes</span>(h2o_df)))</span></code></pre></div>
<pre><code>##  [1] &quot;enum&quot; &quot;real&quot; &quot;int&quot;  &quot;enum&quot; &quot;int&quot;  &quot;enum&quot; &quot;enum&quot; &quot;int&quot;  &quot;enum&quot; &quot;int&quot; 
## [11] &quot;int&quot;  &quot;int&quot;  &quot;int&quot;</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="missing-values-and-imputation.html#cb66-1"></a><span class="co"># Double-check side-by-side.</span></span>
<span id="cb66-2"><a href="missing-values-and-imputation.html#cb66-2"></a><span class="kw">cbind</span>(losses, h2o_types)</span></code></pre></div>
<pre><code>##    index  feature   class        type        loss h2o_types
## 1      0       ca  factor categorical Categorical      enum
## 2      1  oldpeak numeric  continuous       Huber      real
## 3      2  restecg integer     integer       Huber       int
## 4      3    slope  factor categorical Categorical      enum
## 5      4      age integer     integer       Huber       int
## 6      5      sex  factor categorical Categorical      enum
## 7      6       cp  factor categorical Categorical      enum
## 8      7    exang integer     integer       Huber       int
## 9      8     thal  factor categorical Categorical      enum
## 10     9  thalach integer     integer       Huber       int
## 11    10     chol integer     integer       Huber       int
## 12    11      fbs integer     integer       Huber       int
## 13    12 trestbps integer     integer       Huber       int</code></pre>
</div>
<div id="glrm-traintest-split" class="section level3">
<h3><span class="header-section-number">3.4.6</span> GLRM train/test split</h3>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="missing-values-and-imputation.html#cb68-1"></a><span class="co"># Split data into train &amp; validation</span></span>
<span id="cb68-2"><a href="missing-values-and-imputation.html#cb68-2"></a>split =<span class="st"> </span>h2o<span class="op">::</span><span class="kw">h2o.splitFrame</span>(h2o_df, <span class="dt">ratios =</span> <span class="fl">0.75</span>, <span class="dt">seed =</span> <span class="dv">1</span>)</span>
<span id="cb68-3"><a href="missing-values-and-imputation.html#cb68-3"></a>train =<span class="st"> </span>split[[<span class="dv">1</span>]]</span>
<span id="cb68-4"><a href="missing-values-and-imputation.html#cb68-4"></a>valid =<span class="st"> </span>split[[<span class="dv">2</span>]]</span>
<span id="cb68-5"><a href="missing-values-and-imputation.html#cb68-5"></a></span>
<span id="cb68-6"><a href="missing-values-and-imputation.html#cb68-6"></a>val_df =<span class="st"> </span><span class="kw">as.data.frame</span>(valid)</span></code></pre></div>
</div>
<div id="define-glrm-grid" class="section level3">
<h3><span class="header-section-number">3.4.7</span> Define GLRM grid</h3>
<p>Follow hyperparameter optimization method shown at:
* <a href="https://github.com/h2oai/h2o-tutorials/blob/master/best-practices/glrm/GLRM-BestPractices.Rmd" class="uri">https://github.com/h2oai/h2o-tutorials/blob/master/best-practices/glrm/GLRM-BestPractices.Rmd</a>
* and <a href="https://bradleyboehmke.github.io/HOML/GLRM.html#tuning-to-optimize-for-unseen-data" class="uri">https://bradleyboehmke.github.io/HOML/GLRM.html#tuning-to-optimize-for-unseen-data</a></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="missing-values-and-imputation.html#cb69-1"></a><span class="co"># Create hyperparameter search grid</span></span>
<span id="cb69-2"><a href="missing-values-and-imputation.html#cb69-2"></a>params =<span class="st"> </span><span class="kw">expand.grid</span>(</span>
<span id="cb69-3"><a href="missing-values-and-imputation.html#cb69-3"></a>  <span class="co"># Try 3 values on the exponential scale up to the maximum number of predictors.</span></span>
<span id="cb69-4"><a href="missing-values-and-imputation.html#cb69-4"></a>  <span class="dt">k =</span> <span class="kw">round</span>(<span class="kw">exp</span>(<span class="kw">log</span>(<span class="kw">length</span>(vars<span class="op">$</span>predictors)) <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="kw">c</span>(<span class="op">-</span><span class="fl">0.8</span>, <span class="fl">-0.5</span>, <span class="fl">-0.1</span>)))),</span>
<span id="cb69-5"><a href="missing-values-and-imputation.html#cb69-5"></a>  <span class="dt">regularization_x =</span> <span class="kw">c</span>(<span class="st">&quot;None&quot;</span>, <span class="st">&quot;Quadratic&quot;</span>, <span class="st">&quot;L1&quot;</span>),</span>
<span id="cb69-6"><a href="missing-values-and-imputation.html#cb69-6"></a>  <span class="dt">regularization_y =</span> <span class="kw">c</span>(<span class="st">&quot;None&quot;</span>, <span class="st">&quot;Quadratic&quot;</span>, <span class="st">&quot;L1&quot;</span>),</span>
<span id="cb69-7"><a href="missing-values-and-imputation.html#cb69-7"></a>  <span class="dt">gamma_x =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>),</span>
<span id="cb69-8"><a href="missing-values-and-imputation.html#cb69-8"></a>  <span class="dt">gamma_y =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">4</span>),</span>
<span id="cb69-9"><a href="missing-values-and-imputation.html#cb69-9"></a>  <span class="dt">error_num =</span> <span class="ot">NA</span>,</span>
<span id="cb69-10"><a href="missing-values-and-imputation.html#cb69-10"></a>  <span class="dt">error_cat =</span> <span class="ot">NA</span>,</span>
<span id="cb69-11"><a href="missing-values-and-imputation.html#cb69-11"></a>  <span class="dt">objective =</span> <span class="ot">NA</span>,</span>
<span id="cb69-12"><a href="missing-values-and-imputation.html#cb69-12"></a>  <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span>
<span id="cb69-13"><a href="missing-values-and-imputation.html#cb69-13"></a></span>
<span id="cb69-14"><a href="missing-values-and-imputation.html#cb69-14"></a><span class="co"># 243 combinations!</span></span>
<span id="cb69-15"><a href="missing-values-and-imputation.html#cb69-15"></a><span class="kw">dim</span>(params)</span></code></pre></div>
<pre><code>## [1] 243   8</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="missing-values-and-imputation.html#cb71-1"></a><span class="co"># Remove combinations in which regularization_x = None and gamma_x != 0</span></span>
<span id="cb71-2"><a href="missing-values-and-imputation.html#cb71-2"></a>params =<span class="st"> </span><span class="kw">subset</span>(params, regularization_x <span class="op">!=</span><span class="st"> &quot;None&quot;</span> <span class="op">|</span><span class="st"> </span>gamma_x <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb71-3"><a href="missing-values-and-imputation.html#cb71-3"></a></span>
<span id="cb71-4"><a href="missing-values-and-imputation.html#cb71-4"></a><span class="co"># Remove combinations in which regularization_x != None and gamma_x == 0</span></span>
<span id="cb71-5"><a href="missing-values-and-imputation.html#cb71-5"></a>params =<span class="st"> </span><span class="kw">subset</span>(params, regularization_x <span class="op">==</span><span class="st"> &quot;None&quot;</span> <span class="op">|</span><span class="st"> </span>gamma_x <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb71-6"><a href="missing-values-and-imputation.html#cb71-6"></a></span>
<span id="cb71-7"><a href="missing-values-and-imputation.html#cb71-7"></a><span class="co"># Remove combinations in which regularization_y = None and gamma_y != 0</span></span>
<span id="cb71-8"><a href="missing-values-and-imputation.html#cb71-8"></a>params =<span class="st"> </span><span class="kw">subset</span>(params, regularization_y <span class="op">!=</span><span class="st"> &quot;None&quot;</span> <span class="op">|</span><span class="st"> </span>gamma_y <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb71-9"><a href="missing-values-and-imputation.html#cb71-9"></a></span>
<span id="cb71-10"><a href="missing-values-and-imputation.html#cb71-10"></a><span class="co"># Remove combinations in which regularization_y != None and gamma_y == 0</span></span>
<span id="cb71-11"><a href="missing-values-and-imputation.html#cb71-11"></a>params =<span class="st"> </span><span class="kw">subset</span>(params, regularization_y <span class="op">==</span><span class="st"> &quot;None&quot;</span> <span class="op">|</span><span class="st"> </span>gamma_y <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb71-12"><a href="missing-values-and-imputation.html#cb71-12"></a></span>
<span id="cb71-13"><a href="missing-values-and-imputation.html#cb71-13"></a><span class="co"># Down to 75 combinations.</span></span>
<span id="cb71-14"><a href="missing-values-and-imputation.html#cb71-14"></a><span class="kw">dim</span>(params)</span></code></pre></div>
<pre><code>## [1] 75  8</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="missing-values-and-imputation.html#cb73-1"></a>params</span></code></pre></div>
<pre><code>##      k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 1    3             None             None       0       0        NA        NA
## 2    5             None             None       0       0        NA        NA
## 3   10             None             None       0       0        NA        NA
## 31   3        Quadratic             None       1       0        NA        NA
## 32   5        Quadratic             None       1       0        NA        NA
## 33  10        Quadratic             None       1       0        NA        NA
## 34   3               L1             None       1       0        NA        NA
## 35   5               L1             None       1       0        NA        NA
## 36  10               L1             None       1       0        NA        NA
## 58   3        Quadratic             None       4       0        NA        NA
## 59   5        Quadratic             None       4       0        NA        NA
## 60  10        Quadratic             None       4       0        NA        NA
## 61   3               L1             None       4       0        NA        NA
## 62   5               L1             None       4       0        NA        NA
## 63  10               L1             None       4       0        NA        NA
## 91   3             None        Quadratic       0       1        NA        NA
## 92   5             None        Quadratic       0       1        NA        NA
## 93  10             None        Quadratic       0       1        NA        NA
## 100  3             None               L1       0       1        NA        NA
## 101  5             None               L1       0       1        NA        NA
## 102 10             None               L1       0       1        NA        NA
## 121  3        Quadratic        Quadratic       1       1        NA        NA
## 122  5        Quadratic        Quadratic       1       1        NA        NA
## 123 10        Quadratic        Quadratic       1       1        NA        NA
## 124  3               L1        Quadratic       1       1        NA        NA
## 125  5               L1        Quadratic       1       1        NA        NA
## 126 10               L1        Quadratic       1       1        NA        NA
## 130  3        Quadratic               L1       1       1        NA        NA
## 131  5        Quadratic               L1       1       1        NA        NA
## 132 10        Quadratic               L1       1       1        NA        NA
## 133  3               L1               L1       1       1        NA        NA
## 134  5               L1               L1       1       1        NA        NA
## 135 10               L1               L1       1       1        NA        NA
## 148  3        Quadratic        Quadratic       4       1        NA        NA
## 149  5        Quadratic        Quadratic       4       1        NA        NA
## 150 10        Quadratic        Quadratic       4       1        NA        NA
## 151  3               L1        Quadratic       4       1        NA        NA
## 152  5               L1        Quadratic       4       1        NA        NA
## 153 10               L1        Quadratic       4       1        NA        NA
## 157  3        Quadratic               L1       4       1        NA        NA
## 158  5        Quadratic               L1       4       1        NA        NA
## 159 10        Quadratic               L1       4       1        NA        NA
## 160  3               L1               L1       4       1        NA        NA
## 161  5               L1               L1       4       1        NA        NA
## 162 10               L1               L1       4       1        NA        NA
## 172  3             None        Quadratic       0       4        NA        NA
## 173  5             None        Quadratic       0       4        NA        NA
## 174 10             None        Quadratic       0       4        NA        NA
## 181  3             None               L1       0       4        NA        NA
## 182  5             None               L1       0       4        NA        NA
## 183 10             None               L1       0       4        NA        NA
## 202  3        Quadratic        Quadratic       1       4        NA        NA
## 203  5        Quadratic        Quadratic       1       4        NA        NA
## 204 10        Quadratic        Quadratic       1       4        NA        NA
## 205  3               L1        Quadratic       1       4        NA        NA
## 206  5               L1        Quadratic       1       4        NA        NA
## 207 10               L1        Quadratic       1       4        NA        NA
## 211  3        Quadratic               L1       1       4        NA        NA
## 212  5        Quadratic               L1       1       4        NA        NA
## 213 10        Quadratic               L1       1       4        NA        NA
## 214  3               L1               L1       1       4        NA        NA
## 215  5               L1               L1       1       4        NA        NA
## 216 10               L1               L1       1       4        NA        NA
## 229  3        Quadratic        Quadratic       4       4        NA        NA
## 230  5        Quadratic        Quadratic       4       4        NA        NA
## 231 10        Quadratic        Quadratic       4       4        NA        NA
## 232  3               L1        Quadratic       4       4        NA        NA
## 233  5               L1        Quadratic       4       4        NA        NA
## 234 10               L1        Quadratic       4       4        NA        NA
## 238  3        Quadratic               L1       4       4        NA        NA
## 239  5        Quadratic               L1       4       4        NA        NA
## 240 10        Quadratic               L1       4       4        NA        NA
## 241  3               L1               L1       4       4        NA        NA
## 242  5               L1               L1       4       4        NA        NA
## 243 10               L1               L1       4       4        NA        NA
##     objective
## 1          NA
## 2          NA
## 3          NA
## 31         NA
## 32         NA
## 33         NA
## 34         NA
## 35         NA
## 36         NA
## 58         NA
## 59         NA
## 60         NA
## 61         NA
## 62         NA
## 63         NA
## 91         NA
## 92         NA
## 93         NA
## 100        NA
## 101        NA
## 102        NA
## 121        NA
## 122        NA
## 123        NA
## 124        NA
## 125        NA
## 126        NA
## 130        NA
## 131        NA
## 132        NA
## 133        NA
## 134        NA
## 135        NA
## 148        NA
## 149        NA
## 150        NA
## 151        NA
## 152        NA
## 153        NA
## 157        NA
## 158        NA
## 159        NA
## 160        NA
## 161        NA
## 162        NA
## 172        NA
## 173        NA
## 174        NA
## 181        NA
## 182        NA
## 183        NA
## 202        NA
## 203        NA
## 204        NA
## 205        NA
## 206        NA
## 207        NA
## 211        NA
## 212        NA
## 213        NA
## 214        NA
## 215        NA
## 216        NA
## 229        NA
## 230        NA
## 231        NA
## 232        NA
## 233        NA
## 234        NA
## 238        NA
## 239        NA
## 240        NA
## 241        NA
## 242        NA
## 243        NA</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="missing-values-and-imputation.html#cb75-1"></a><span class="co"># Randomly order the params so that we can stop at any time.</span></span>
<span id="cb75-2"><a href="missing-values-and-imputation.html#cb75-2"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb75-3"><a href="missing-values-and-imputation.html#cb75-3"></a>params =<span class="st"> </span>params[<span class="kw">sample</span>(<span class="kw">nrow</span>(params)), ]</span>
<span id="cb75-4"><a href="missing-values-and-imputation.html#cb75-4"></a>params</span></code></pre></div>
<pre><code>##      k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 233  5               L1        Quadratic       4       4        NA        NA
## 153 10               L1        Quadratic       4       1        NA        NA
## 1    3             None             None       0       0        NA        NA
## 148  3        Quadratic        Quadratic       4       1        NA        NA
## 160  3               L1               L1       4       1        NA        NA
## 62   5               L1             None       4       0        NA        NA
## 212  5        Quadratic               L1       1       4        NA        NA
## 183 10             None               L1       0       4        NA        NA
## 102 10             None               L1       0       1        NA        NA
## 204 10        Quadratic        Quadratic       1       4        NA        NA
## 34   3               L1             None       1       0        NA        NA
## 36  10               L1             None       1       0        NA        NA
## 63  10               L1             None       4       0        NA        NA
## 232  3               L1        Quadratic       4       4        NA        NA
## 151  3               L1        Quadratic       4       1        NA        NA
## 158  5        Quadratic               L1       4       1        NA        NA
## 124  3               L1        Quadratic       1       1        NA        NA
## 172  3             None        Quadratic       0       4        NA        NA
## 214  3               L1               L1       1       4        NA        NA
## 207 10               L1        Quadratic       1       4        NA        NA
## 240 10        Quadratic               L1       4       4        NA        NA
## 159 10        Quadratic               L1       4       1        NA        NA
## 234 10               L1        Quadratic       4       4        NA        NA
## 161  5               L1               L1       4       1        NA        NA
## 216 10               L1               L1       1       4        NA        NA
## 135 10               L1               L1       1       1        NA        NA
## 101  5             None               L1       0       1        NA        NA
## 149  5        Quadratic        Quadratic       4       1        NA        NA
## 33  10        Quadratic             None       1       0        NA        NA
## 58   3        Quadratic             None       4       0        NA        NA
## 231 10        Quadratic        Quadratic       4       4        NA        NA
## 152  5               L1        Quadratic       4       1        NA        NA
## 181  3             None               L1       0       4        NA        NA
## 130  3        Quadratic               L1       1       1        NA        NA
## 239  5        Quadratic               L1       4       4        NA        NA
## 122  5        Quadratic        Quadratic       1       1        NA        NA
## 173  5             None        Quadratic       0       4        NA        NA
## 203  5        Quadratic        Quadratic       1       4        NA        NA
## 242  5               L1               L1       4       4        NA        NA
## 206  5               L1        Quadratic       1       4        NA        NA
## 123 10        Quadratic        Quadratic       1       1        NA        NA
## 134  5               L1               L1       1       1        NA        NA
## 238  3        Quadratic               L1       4       4        NA        NA
## 2    5             None             None       0       0        NA        NA
## 61   3               L1             None       4       0        NA        NA
## 93  10             None        Quadratic       0       1        NA        NA
## 121  3        Quadratic        Quadratic       1       1        NA        NA
## 182  5             None               L1       0       4        NA        NA
## 150 10        Quadratic        Quadratic       4       1        NA        NA
## 241  3               L1               L1       4       4        NA        NA
## 100  3             None               L1       0       1        NA        NA
## 202  3        Quadratic        Quadratic       1       4        NA        NA
## 35   5               L1             None       1       0        NA        NA
## 126 10               L1        Quadratic       1       1        NA        NA
## 60  10        Quadratic             None       4       0        NA        NA
## 131  5        Quadratic               L1       1       1        NA        NA
## 157  3        Quadratic               L1       4       1        NA        NA
## 230  5        Quadratic        Quadratic       4       4        NA        NA
## 59   5        Quadratic             None       4       0        NA        NA
## 125  5               L1        Quadratic       1       1        NA        NA
## 31   3        Quadratic             None       1       0        NA        NA
## 133  3               L1               L1       1       1        NA        NA
## 174 10             None        Quadratic       0       4        NA        NA
## 229  3        Quadratic        Quadratic       4       4        NA        NA
## 215  5               L1               L1       1       4        NA        NA
## 132 10        Quadratic               L1       1       1        NA        NA
## 243 10               L1               L1       4       4        NA        NA
## 211  3        Quadratic               L1       1       4        NA        NA
## 32   5        Quadratic             None       1       0        NA        NA
## 162 10               L1               L1       4       1        NA        NA
## 92   5             None        Quadratic       0       1        NA        NA
## 205  3               L1        Quadratic       1       4        NA        NA
## 91   3             None        Quadratic       0       1        NA        NA
## 213 10        Quadratic               L1       1       4        NA        NA
## 3   10             None             None       0       0        NA        NA
##     objective
## 233        NA
## 153        NA
## 1          NA
## 148        NA
## 160        NA
## 62         NA
## 212        NA
## 183        NA
## 102        NA
## 204        NA
## 34         NA
## 36         NA
## 63         NA
## 232        NA
## 151        NA
## 158        NA
## 124        NA
## 172        NA
## 214        NA
## 207        NA
## 240        NA
## 159        NA
## 234        NA
## 161        NA
## 216        NA
## 135        NA
## 101        NA
## 149        NA
## 33         NA
## 58         NA
## 231        NA
## 152        NA
## 181        NA
## 130        NA
## 239        NA
## 122        NA
## 173        NA
## 203        NA
## 242        NA
## 206        NA
## 123        NA
## 134        NA
## 238        NA
## 2          NA
## 61         NA
## 93         NA
## 121        NA
## 182        NA
## 150        NA
## 241        NA
## 100        NA
## 202        NA
## 35         NA
## 126        NA
## 60         NA
## 131        NA
## 157        NA
## 230        NA
## 59         NA
## 125        NA
## 31         NA
## 133        NA
## 174        NA
## 229        NA
## 215        NA
## 132        NA
## 243        NA
## 211        NA
## 32         NA
## 162        NA
## 92         NA
## 205        NA
## 91         NA
## 213        NA
## 3          NA</code></pre>
</div>
<div id="glrm-grid-search" class="section level3">
<h3><span class="header-section-number">3.4.8</span> GLRM grid search</h3>
<p>The results of this block are cached because they are slow to compute.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="missing-values-and-imputation.html#cb77-1"></a>glrm_metrics =<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb77-2"><a href="missing-values-and-imputation.html#cb77-2"></a><span class="co"># Summary text</span></span>
<span id="cb77-3"><a href="missing-values-and-imputation.html#cb77-3"></a>glrm_sum =<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb77-4"><a href="missing-values-and-imputation.html#cb77-4"></a></span>
<span id="cb77-5"><a href="missing-values-and-imputation.html#cb77-5"></a><span class="kw">nrow</span>(params)</span></code></pre></div>
<pre><code>## [1] 75</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="missing-values-and-imputation.html#cb79-1"></a><span class="co"># Perform grid search - takes about 150 seconds.</span></span>
<span id="cb79-2"><a href="missing-values-and-imputation.html#cb79-2"></a><span class="kw">system.time</span>({</span>
<span id="cb79-3"><a href="missing-values-and-imputation.html#cb79-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_len</span>(<span class="kw">nrow</span>(params))) {</span>
<span id="cb79-4"><a href="missing-values-and-imputation.html#cb79-4"></a>  <span class="kw">cat</span>(<span class="st">&quot;Iteration&quot;</span>, i, <span class="st">&quot;of&quot;</span>, <span class="kw">nrow</span>(params), <span class="st">&quot;&quot;</span>, <span class="kw">paste0</span>(<span class="kw">round</span>(i <span class="op">/</span><span class="st"> </span><span class="kw">nrow</span>(params) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>, <span class="dv">1</span>), <span class="st">&quot;%</span><span class="ch">\n</span><span class="st">&quot;</span>))</span>
<span id="cb79-5"><a href="missing-values-and-imputation.html#cb79-5"></a>  <span class="kw">print</span>(params[i, ])</span>
<span id="cb79-6"><a href="missing-values-and-imputation.html#cb79-6"></a>  </span>
<span id="cb79-7"><a href="missing-values-and-imputation.html#cb79-7"></a>  <span class="co"># Create model</span></span>
<span id="cb79-8"><a href="missing-values-and-imputation.html#cb79-8"></a>  glrm_model =<span class="st"> </span>h2o<span class="op">::</span><span class="kw">h2o.glrm</span>(</span>
<span id="cb79-9"><a href="missing-values-and-imputation.html#cb79-9"></a>    <span class="dt">training_frame =</span> train,</span>
<span id="cb79-10"><a href="missing-values-and-imputation.html#cb79-10"></a>    <span class="co"># h2o requires that the validation frame have the same # of rows as the training data for some reason.</span></span>
<span id="cb79-11"><a href="missing-values-and-imputation.html#cb79-11"></a>    <span class="co">#validation_frame = valid,</span></span>
<span id="cb79-12"><a href="missing-values-and-imputation.html#cb79-12"></a>    <span class="dt">k =</span> params<span class="op">$</span>k[i], </span>
<span id="cb79-13"><a href="missing-values-and-imputation.html#cb79-13"></a>    <span class="dt">loss =</span> <span class="st">&quot;Quadratic&quot;</span>,</span>
<span id="cb79-14"><a href="missing-values-and-imputation.html#cb79-14"></a>    <span class="dt">regularization_x =</span> params<span class="op">$</span>regularization_x[i], </span>
<span id="cb79-15"><a href="missing-values-and-imputation.html#cb79-15"></a>    <span class="dt">regularization_y =</span> params<span class="op">$</span>regularization_y[i],</span>
<span id="cb79-16"><a href="missing-values-and-imputation.html#cb79-16"></a>    <span class="dt">gamma_x =</span> params<span class="op">$</span>gamma_x[i],</span>
<span id="cb79-17"><a href="missing-values-and-imputation.html#cb79-17"></a>    <span class="dt">gamma_y =</span> params<span class="op">$</span>gamma_y[i],</span>
<span id="cb79-18"><a href="missing-values-and-imputation.html#cb79-18"></a>    <span class="dt">transform =</span> <span class="st">&quot;STANDARDIZE&quot;</span>, </span>
<span id="cb79-19"><a href="missing-values-and-imputation.html#cb79-19"></a>    <span class="co"># This is set artificially low so that it runs quickly during the tutorial.</span></span>
<span id="cb79-20"><a href="missing-values-and-imputation.html#cb79-20"></a>    <span class="dt">max_iterations =</span> <span class="dv">30</span>,</span>
<span id="cb79-21"><a href="missing-values-and-imputation.html#cb79-21"></a>    <span class="co"># This is a more typical setting:</span></span>
<span id="cb79-22"><a href="missing-values-and-imputation.html#cb79-22"></a>    <span class="co">#max_iterations = 2000,</span></span>
<span id="cb79-23"><a href="missing-values-and-imputation.html#cb79-23"></a>    <span class="dt">max_runtime_secs =</span> <span class="dv">1000</span>,</span>
<span id="cb79-24"><a href="missing-values-and-imputation.html#cb79-24"></a>    <span class="dt">seed =</span> <span class="dv">1</span>,</span>
<span id="cb79-25"><a href="missing-values-and-imputation.html#cb79-25"></a>    <span class="dt">loss_by_col_idx =</span> losses<span class="op">$</span>index,</span>
<span id="cb79-26"><a href="missing-values-and-imputation.html#cb79-26"></a>    <span class="dt">loss_by_col =</span> losses<span class="op">$</span>loss)</span>
<span id="cb79-27"><a href="missing-values-and-imputation.html#cb79-27"></a>  </span>
<span id="cb79-28"><a href="missing-values-and-imputation.html#cb79-28"></a>  summ_text =<span class="st"> </span><span class="kw">capture.output</span>({ h2o<span class="op">::</span><span class="kw">summary</span>(glrm_model) })</span>
<span id="cb79-29"><a href="missing-values-and-imputation.html#cb79-29"></a>  glrm_sum[[i]] =<span class="st"> </span>summ_text</span>
<span id="cb79-30"><a href="missing-values-and-imputation.html#cb79-30"></a>  h2o<span class="op">::</span><span class="kw">summary</span>(glrm_model)</span>
<span id="cb79-31"><a href="missing-values-and-imputation.html#cb79-31"></a>  <span class="kw">plot</span>(glrm_model)</span>
<span id="cb79-32"><a href="missing-values-and-imputation.html#cb79-32"></a>  </span>
<span id="cb79-33"><a href="missing-values-and-imputation.html#cb79-33"></a>  params<span class="op">$</span>objective[i] =<span class="st"> </span>glrm_model<span class="op">@</span>model<span class="op">$</span>objective</span>
<span id="cb79-34"><a href="missing-values-and-imputation.html#cb79-34"></a>  </span>
<span id="cb79-35"><a href="missing-values-and-imputation.html#cb79-35"></a>  <span class="co"># Predict on validation set and extract error</span></span>
<span id="cb79-36"><a href="missing-values-and-imputation.html#cb79-36"></a>  <span class="co"># Warning: this can throw java.lang.ArrayIndexOutOfBoundsException</span></span>
<span id="cb79-37"><a href="missing-values-and-imputation.html#cb79-37"></a>  <span class="kw">try</span>({</span>
<span id="cb79-38"><a href="missing-values-and-imputation.html#cb79-38"></a>    validate =<span class="st"> </span>h2o<span class="op">::</span><span class="kw">h2o.performance</span>(glrm_model, valid)</span>
<span id="cb79-39"><a href="missing-values-and-imputation.html#cb79-39"></a>    <span class="co">#print(validate@metrics)</span></span>
<span id="cb79-40"><a href="missing-values-and-imputation.html#cb79-40"></a>    glrm_metrics[[i]] =<span class="st"> </span>validate<span class="op">@</span>metrics</span>
<span id="cb79-41"><a href="missing-values-and-imputation.html#cb79-41"></a>    </span>
<span id="cb79-42"><a href="missing-values-and-imputation.html#cb79-42"></a>    params<span class="op">$</span>error_num[i] =<span class="st"> </span>validate<span class="op">@</span>metrics<span class="op">$</span>numerr</span>
<span id="cb79-43"><a href="missing-values-and-imputation.html#cb79-43"></a>    params<span class="op">$</span>error_cat[i] =<span class="st"> </span>validate<span class="op">@</span>metrics<span class="op">$</span>caterr</span>
<span id="cb79-44"><a href="missing-values-and-imputation.html#cb79-44"></a>    </span>
<span id="cb79-45"><a href="missing-values-and-imputation.html#cb79-45"></a>  })</span>
<span id="cb79-46"><a href="missing-values-and-imputation.html#cb79-46"></a>  </span>
<span id="cb79-47"><a href="missing-values-and-imputation.html#cb79-47"></a>  <span class="co"># Removing the model prevents the index error from occurring!</span></span>
<span id="cb79-48"><a href="missing-values-and-imputation.html#cb79-48"></a>  h2o<span class="op">::</span><span class="kw">h2o.rm</span>(glrm_model)</span>
<span id="cb79-49"><a href="missing-values-and-imputation.html#cb79-49"></a>  </span>
<span id="cb79-50"><a href="missing-values-and-imputation.html#cb79-50"></a>  <span class="co"># Save after each iteration in case it crashes.</span></span>
<span id="cb79-51"><a href="missing-values-and-imputation.html#cb79-51"></a>  <span class="co"># This could go inside the try()</span></span>
<span id="cb79-52"><a href="missing-values-and-imputation.html#cb79-52"></a>  <span class="co"># params should be the first object.</span></span>
<span id="cb79-53"><a href="missing-values-and-imputation.html#cb79-53"></a>    <span class="kw">save</span>(params, glrm_metrics, glrm_sum,</span>
<span id="cb79-54"><a href="missing-values-and-imputation.html#cb79-54"></a>       <span class="dt">file =</span> <span class="st">&quot;data/glrm-tuned-results.RData&quot;</span>)</span>
<span id="cb79-55"><a href="missing-values-and-imputation.html#cb79-55"></a>}</span>
<span id="cb79-56"><a href="missing-values-and-imputation.html#cb79-56"></a>})</span></code></pre></div>
<pre><code>## Iteration 1 of 75  1.3%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 233 5               L1        Quadratic       4       4        NA        NA
##     objective
## 233        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_1 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.04601            3078.15172
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1548.359
## Misclassification Error (Categorical):  330
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:31:15  0.178 sec          0   1.05000 4771.95362
## 2 2020-06-11 17:31:15  0.190 sec          1   1.10250 4264.58709
## 3 2020-06-11 17:31:15  0.197 sec          2   0.73500 4264.58709
## 4 2020-06-11 17:31:15  0.203 sec          3   0.49000 4264.58709
## 5 2020-06-11 17:31:15  0.209 sec          4   0.51450 4002.73529
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:31:15  0.328 sec         24   0.05678 3101.76007
## 26 2020-06-11 17:31:15  0.332 sec         25   0.05962 3089.45461
## 27 2020-06-11 17:31:15  0.336 sec         26   0.06260 3088.97874
## 28 2020-06-11 17:31:15  0.339 sec         27   0.06573 3087.10244
## 29 2020-06-11 17:31:15  0.343 sec         28   0.04382 3087.10244
## 30 2020-06-11 17:31:15  0.348 sec         29   0.04601 3078.15172</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-1.png" width="672" /></p>
<pre><code>## Iteration 2 of 75  2.7%
##      k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 153 10               L1        Quadratic       4       1        NA        NA
##     objective
## 153        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_3 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.07247            2517.74751
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1340.119
## Misclassification Error (Categorical):  173
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:31:16  0.032 sec          0   1.05000 4502.23608
## 2 2020-06-11 17:31:16  0.038 sec          1   0.70000 4502.23608
## 3 2020-06-11 17:31:16  0.042 sec          2   0.73500 3788.22992
## 4 2020-06-11 17:31:16  0.046 sec          3   0.49000 3788.22992
## 5 2020-06-11 17:31:16  0.050 sec          4   0.51450 3551.78004
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:31:16  0.136 sec         24   0.14085 2563.08937
## 26 2020-06-11 17:31:16  0.140 sec         25   0.09390 2563.08937
## 27 2020-06-11 17:31:16  0.144 sec         26   0.09860 2543.64513
## 28 2020-06-11 17:31:16  0.148 sec         27   0.10353 2531.74728
## 29 2020-06-11 17:31:16  0.152 sec         28   0.06902 2531.74728
## 30 2020-06-11 17:31:16  0.155 sec         29   0.07247 2517.74751</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-2.png" width="672" /></p>
<pre><code>## Iteration 3 of 75  4%
##   k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 1 3             None             None       0       0        NA        NA
##   objective
## 1        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_5 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.03451            1903.07151
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1298.219
## Misclassification Error (Categorical):  325
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:31:18  0.021 sec          0   1.05000 2446.80542
## 2 2020-06-11 17:31:18  0.025 sec          1   0.70000 2446.80542
## 3 2020-06-11 17:31:18  0.030 sec          2   0.46667 2446.80542
## 4 2020-06-11 17:31:18  0.035 sec          3   0.31111 2446.80542
## 5 2020-06-11 17:31:18  0.039 sec          4   0.15556 2446.80542
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:31:18  0.131 sec         24   0.04259 1911.14025
## 26 2020-06-11 17:31:18  0.133 sec         25   0.04472 1910.48527
## 27 2020-06-11 17:31:18  0.136 sec         26   0.04695 1908.46755
## 28 2020-06-11 17:31:18  0.138 sec         27   0.04930 1905.78622
## 29 2020-06-11 17:31:18  0.140 sec         28   0.03287 1905.78622
## 30 2020-06-11 17:31:18  0.143 sec         29   0.03451 1903.07151</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-3.png" width="672" /></p>
<pre><code>## Iteration 4 of 75  5.3%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 148 3        Quadratic        Quadratic       4       1        NA        NA
##     objective
## 148        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_7 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.02921            2405.49655
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1358.582
## Misclassification Error (Categorical):  355
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:31:20  0.023 sec          0   1.05000 2871.85433
## 2 2020-06-11 17:31:20  0.030 sec          1   0.70000 2871.85433
## 3 2020-06-11 17:31:20  0.037 sec          2   0.46667 2871.85433
## 4 2020-06-11 17:31:20  0.042 sec          3   0.31111 2871.85433
## 5 2020-06-11 17:31:20  0.047 sec          4   0.32667 2822.44503
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:31:20  0.144 sec         24   0.05678 2415.05649
## 26 2020-06-11 17:31:20  0.147 sec         25   0.03785 2415.05649
## 27 2020-06-11 17:31:20  0.149 sec         26   0.03975 2410.09312
## 28 2020-06-11 17:31:20  0.150 sec         27   0.04173 2408.33081
## 29 2020-06-11 17:31:20  0.152 sec         28   0.02782 2408.33081
## 30 2020-06-11 17:31:20  0.154 sec         29   0.02921 2405.49655</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-4.png" width="672" /></p>
<pre><code>## Iteration 5 of 75  6.7%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 160 3               L1               L1       4       1        NA        NA
##     objective
## 160        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_9 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.04601            2572.00653
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1452.309
## Misclassification Error (Categorical):  360
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:31:21  0.040 sec          0   1.05000 4147.94914
## 2 2020-06-11 17:31:21  0.042 sec          1   0.70000 4147.94914
## 3 2020-06-11 17:31:21  0.045 sec          2   0.46667 4147.94914
## 4 2020-06-11 17:31:21  0.047 sec          3   0.49000 3201.29998
## 5 2020-06-11 17:31:21  0.049 sec          4   0.51450 3066.89359
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:31:21  0.086 sec         24   0.05678 2599.59738
## 26 2020-06-11 17:31:21  0.087 sec         25   0.05962 2590.97615
## 27 2020-06-11 17:31:21  0.088 sec         26   0.06260 2582.01057
## 28 2020-06-11 17:31:21  0.090 sec         27   0.04173 2582.01057
## 29 2020-06-11 17:31:21  0.092 sec         28   0.04382 2575.75859
## 30 2020-06-11 17:31:21  0.093 sec         29   0.04601 2572.00653</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-5.png" width="672" /></p>
<pre><code>## Iteration 6 of 75  8%
##    k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 62 5               L1             None       4       0        NA        NA
##    objective
## 62        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_11 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.04601            2170.55916
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1366.474
## Misclassification Error (Categorical):  243
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:31:23  0.026 sec          0   1.05000 4299.99970
## 2 2020-06-11 17:31:23  0.028 sec          1   0.70000 4299.99970
## 3 2020-06-11 17:31:23  0.030 sec          2   0.73500 4051.36990
## 4 2020-06-11 17:31:23  0.032 sec          3   0.77175 3736.02992
## 5 2020-06-11 17:31:23  0.035 sec          4   0.51450 3736.02992
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:31:23  0.080 sec         24   0.05678 2214.74930
## 26 2020-06-11 17:31:23  0.081 sec         25   0.05962 2200.28783
## 27 2020-06-11 17:31:23  0.084 sec         26   0.06260 2190.57979
## 28 2020-06-11 17:31:23  0.086 sec         27   0.04173 2190.57979
## 29 2020-06-11 17:31:23  0.088 sec         28   0.04382 2177.78252
## 30 2020-06-11 17:31:23  0.091 sec         29   0.04601 2170.55916</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-6.png" width="672" /></p>
<pre><code>## Iteration 7 of 75  9.3%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 212 5        Quadratic               L1       1       4        NA        NA
##     objective
## 212        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_13 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.17977            1737.18758
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1439.787
## Misclassification Error (Categorical):  126
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:31:24  0.019 sec          0   1.05000 2940.72016
## 2 2020-06-11 17:31:24  0.023 sec          1   0.70000 2940.72016
## 3 2020-06-11 17:31:24  0.026 sec          2   0.46667 2940.72016
## 4 2020-06-11 17:31:24  0.029 sec          3   0.31111 2940.72016
## 5 2020-06-11 17:31:24  0.030 sec          4   0.32667 2817.45159
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:31:25  0.068 sec         24   0.22184 1768.41663
## 26 2020-06-11 17:31:25  0.070 sec         25   0.23294 1765.68228
## 27 2020-06-11 17:31:25  0.071 sec         26   0.24458 1765.04244
## 28 2020-06-11 17:31:25  0.073 sec         27   0.25681 1763.97881
## 29 2020-06-11 17:31:25  0.075 sec         28   0.17121 1763.97881
## 30 2020-06-11 17:31:25  0.076 sec         29   0.17977 1737.18758</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-7.png" width="672" /></p>
<pre><code>## Iteration 8 of 75  10.7%
##      k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 183 10             None               L1       0       4        NA        NA
##     objective
## 183        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_15 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.17977             970.47294
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  761.7432
## Misclassification Error (Categorical):  55
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:31:26  0.047 sec          0   1.05000 4057.18290
## 2 2020-06-11 17:31:26  0.053 sec          1   0.70000 4057.18290
## 3 2020-06-11 17:31:26  0.058 sec          2   0.46667 4057.18290
## 4 2020-06-11 17:31:26  0.062 sec          3   0.49000 3545.77830
## 5 2020-06-11 17:31:26  0.066 sec          4   0.51450 3118.80625
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:31:26  0.132 sec         24   0.22184 1028.03950
## 26 2020-06-11 17:31:26  0.135 sec         25   0.23294 1016.89414
## 27 2020-06-11 17:31:26  0.138 sec         26   0.24458 1011.43623
## 28 2020-06-11 17:31:26  0.141 sec         27   0.16306 1011.43623
## 29 2020-06-11 17:31:26  0.144 sec         28   0.17121  983.41864
## 30 2020-06-11 17:31:26  0.146 sec         29   0.17977  970.47294</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-8.png" width="672" /></p>
<pre><code>## Iteration 9 of 75  12%
##      k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 102 10             None               L1       0       1        NA        NA
##     objective
## 102        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_17 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.28314             647.60549
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  551.2013
## Misclassification Error (Categorical):  25
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:31:28  0.035 sec          0   1.05000 3568.49501
## 2 2020-06-11 17:31:28  0.039 sec          1   0.70000 3568.49501
## 3 2020-06-11 17:31:28  0.042 sec          2   0.46667 3568.49501
## 4 2020-06-11 17:31:28  0.045 sec          3   0.31111 3568.49501
## 5 2020-06-11 17:31:28  0.048 sec          4   0.32667 2320.28803
## 
## ---
##              timestamp   duration iterations step_size objective
## 25 2020-06-11 17:31:28  0.114 sec         24   0.34941 703.21917
## 26 2020-06-11 17:31:28  0.117 sec         25   0.23294 703.21917
## 27 2020-06-11 17:31:28  0.120 sec         26   0.24458 673.13521
## 28 2020-06-11 17:31:28  0.123 sec         27   0.25681 660.26034
## 29 2020-06-11 17:31:28  0.126 sec         28   0.26965 650.69811
## 30 2020-06-11 17:31:28  0.129 sec         29   0.28314 647.60549</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-9.png" width="672" /></p>
<pre><code>## Iteration 10 of 75  13.3%
##      k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 204 10        Quadratic        Quadratic       1       4        NA        NA
##     objective
## 204        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_19 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.07247            1608.29066
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  886.3189
## Misclassification Error (Categorical):  97
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:31:30  0.025 sec          0   1.05000 3495.23576
## 2 2020-06-11 17:31:30  0.029 sec          1   0.70000 3495.23576
## 3 2020-06-11 17:31:30  0.032 sec          2   0.46667 3495.23576
## 4 2020-06-11 17:31:30  0.035 sec          3   0.49000 2652.37360
## 5 2020-06-11 17:31:30  0.039 sec          4   0.51450 2480.93892
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:31:30  0.117 sec         24   0.14085 1634.53029
## 26 2020-06-11 17:31:30  0.121 sec         25   0.09390 1634.53029
## 27 2020-06-11 17:31:30  0.125 sec         26   0.09860 1618.58550
## 28 2020-06-11 17:31:30  0.129 sec         27   0.10353 1618.39309
## 29 2020-06-11 17:31:30  0.134 sec         28   0.06902 1618.39309
## 30 2020-06-11 17:31:30  0.138 sec         29   0.07247 1608.29066</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-10.png" width="672" /></p>
<pre><code>## Iteration 11 of 75  14.7%
##    k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 34 3               L1             None       1       0        NA        NA
##    objective
## 34        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_21 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.03451            2077.69944
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1326.069
## Misclassification Error (Categorical):  357
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:31:31  0.020 sec          0   1.05000 2393.57535
## 2 2020-06-11 17:31:31  0.022 sec          1   0.70000 2393.57535
## 3 2020-06-11 17:31:31  0.024 sec          2   0.46667 2393.57535
## 4 2020-06-11 17:31:31  0.026 sec          3   0.31111 2393.57535
## 5 2020-06-11 17:31:31  0.027 sec          4   0.15556 2393.57535
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:31:31  0.058 sec         24   0.04259 2085.11774
## 26 2020-06-11 17:31:31  0.060 sec         25   0.04472 2084.85913
## 27 2020-06-11 17:31:31  0.062 sec         26   0.02981 2084.85913
## 28 2020-06-11 17:31:31  0.063 sec         27   0.03130 2080.09261
## 29 2020-06-11 17:31:31  0.064 sec         28   0.03287 2077.80021
## 30 2020-06-11 17:31:31  0.065 sec         29   0.03451 2077.69944</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-11.png" width="672" /></p>
<pre><code>## Iteration 12 of 75  16%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 36 10               L1             None       1       0        NA        NA
##    objective
## 36        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_23 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.11414             993.93860
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  585.2555
## Misclassification Error (Categorical):  52
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:31:33  0.033 sec          0   1.05000 2835.49005
## 2 2020-06-11 17:31:33  0.037 sec          1   0.70000 2835.49005
## 3 2020-06-11 17:31:33  0.044 sec          2   0.46667 2835.49005
## 4 2020-06-11 17:31:33  0.049 sec          3   0.31111 2835.49005
## 5 2020-06-11 17:31:33  0.052 sec          4   0.32667 2247.03667
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:31:33  0.108 sec         24   0.22184 1043.90853
## 26 2020-06-11 17:31:33  0.111 sec         25   0.14790 1043.90853
## 27 2020-06-11 17:31:33  0.114 sec         26   0.15529 1019.55837
## 28 2020-06-11 17:31:33  0.117 sec         27   0.16306 1012.07422
## 29 2020-06-11 17:31:33  0.120 sec         28   0.10870 1012.07422
## 30 2020-06-11 17:31:33  0.123 sec         29   0.11414  993.93860</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-12.png" width="672" /></p>
<pre><code>## Iteration 13 of 75  17.3%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 63 10               L1             None       4       0        NA        NA
##    objective
## 63        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_25 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.07247            1959.41313
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1108.732
## Misclassification Error (Categorical):  140
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:31:34  0.026 sec          0   1.05000 4240.23364
## 2 2020-06-11 17:31:34  0.032 sec          1   0.70000 4240.23364
## 3 2020-06-11 17:31:34  0.037 sec          2   0.73500 3769.95950
## 4 2020-06-11 17:31:34  0.041 sec          3   0.49000 3769.95950
## 5 2020-06-11 17:31:34  0.046 sec          4   0.51450 3278.63616
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:31:35  0.154 sec         24   0.08943 2023.27074
## 26 2020-06-11 17:31:35  0.158 sec         25   0.09390 1999.13999
## 27 2020-06-11 17:31:35  0.163 sec         26   0.06260 1999.13999
## 28 2020-06-11 17:31:35  0.167 sec         27   0.06573 1975.68901
## 29 2020-06-11 17:31:35  0.172 sec         28   0.06902 1960.73931
## 30 2020-06-11 17:31:35  0.177 sec         29   0.07247 1959.41313</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-13.png" width="672" /></p>
<pre><code>## Iteration 14 of 75  18.7%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 232 3               L1        Quadratic       4       4        NA        NA
##     objective
## 232        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_27 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.01855            3059.37324
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1629.755
## Misclassification Error (Categorical):  359
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:31:36  0.010 sec          0   1.05000 4600.37645
## 2 2020-06-11 17:31:36  0.012 sec          1   0.70000 4600.37645
## 3 2020-06-11 17:31:36  0.013 sec          2   0.73500 3735.98649
## 4 2020-06-11 17:31:36  0.014 sec          3   0.49000 3735.98649
## 5 2020-06-11 17:31:36  0.015 sec          4   0.51450 3573.62975
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:31:36  0.041 sec         24   0.05678 3071.61341
## 26 2020-06-11 17:31:36  0.043 sec         25   0.03785 3071.61341
## 27 2020-06-11 17:31:36  0.045 sec         26   0.03975 3064.04157
## 28 2020-06-11 17:31:36  0.046 sec         27   0.02650 3064.04157
## 29 2020-06-11 17:31:36  0.047 sec         28   0.02782 3059.37324
## 30 2020-06-11 17:31:36  0.049 sec         29   0.01855 3059.37324</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-14.png" width="672" /></p>
<pre><code>## Iteration 15 of 75  20%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 151 3               L1        Quadratic       4       1        NA        NA
##     objective
## 151        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_29 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.02921            2719.04642
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1493.146
## Misclassification Error (Categorical):  360
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:31:38  0.010 sec          0   1.05000 4241.79446
## 2 2020-06-11 17:31:38  0.011 sec          1   0.70000 4241.79446
## 3 2020-06-11 17:31:38  0.012 sec          2   0.46667 4241.79446
## 4 2020-06-11 17:31:38  0.013 sec          3   0.49000 3172.19724
## 5 2020-06-11 17:31:38  0.014 sec          4   0.51450 3119.83804
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:31:38  0.037 sec         24   0.05678 2732.56924
## 26 2020-06-11 17:31:38  0.038 sec         25   0.05962 2728.80539
## 27 2020-06-11 17:31:38  0.039 sec         26   0.03975 2728.80539
## 28 2020-06-11 17:31:38  0.040 sec         27   0.04173 2723.86288
## 29 2020-06-11 17:31:38  0.041 sec         28   0.04382 2719.04642
## 30 2020-06-11 17:31:38  0.042 sec         29   0.02921 2719.04642</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-15.png" width="672" /></p>
<pre><code>## Iteration 16 of 75  21.3%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 158 5        Quadratic               L1       4       1        NA        NA
##     objective
## 158        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_31 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.04601            1744.85536
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1309.328
## Misclassification Error (Categorical):  180
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:31:39  0.020 sec          0   1.05000 2859.22655
## 2 2020-06-11 17:31:39  0.022 sec          1   0.70000 2859.22655
## 3 2020-06-11 17:31:39  0.025 sec          2   0.46667 2859.22655
## 4 2020-06-11 17:31:39  0.027 sec          3   0.31111 2859.22655
## 5 2020-06-11 17:31:39  0.029 sec          4   0.32667 2646.37972
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:31:39  0.066 sec         24   0.05678 1774.53466
## 26 2020-06-11 17:31:39  0.069 sec         25   0.05962 1763.00949
## 27 2020-06-11 17:31:39  0.070 sec         26   0.06260 1757.75766
## 28 2020-06-11 17:31:39  0.072 sec         27   0.06573 1757.09369
## 29 2020-06-11 17:31:39  0.074 sec         28   0.04382 1757.09369
## 30 2020-06-11 17:31:39  0.076 sec         29   0.04601 1744.85536</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-16.png" width="672" /></p>
<pre><code>## Iteration 17 of 75  22.7%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 124 3               L1        Quadratic       1       1        NA        NA
##     objective
## 124        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_33 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.08560            2314.60930
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1343.625
## Misclassification Error (Categorical):  353
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:31:41  0.011 sec          0   1.05000 2699.00728
## 2 2020-06-11 17:31:41  0.012 sec          1   0.70000 2699.00728
## 3 2020-06-11 17:31:41  0.014 sec          2   0.46667 2699.00728
## 4 2020-06-11 17:31:41  0.015 sec          3   0.31111 2699.00728
## 5 2020-06-11 17:31:41  0.016 sec          4   0.15556 2699.00728
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:31:41  0.040 sec         24   0.06707 2325.07536
## 26 2020-06-11 17:31:41  0.041 sec         25   0.07043 2321.23030
## 27 2020-06-11 17:31:41  0.042 sec         26   0.07395 2319.25747
## 28 2020-06-11 17:31:41  0.044 sec         27   0.07765 2317.65464
## 29 2020-06-11 17:31:41  0.045 sec         28   0.08153 2316.28733
## 30 2020-06-11 17:31:41  0.046 sec         29   0.08560 2314.60930</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-17.png" width="672" /></p>
<pre><code>## Iteration 18 of 75  24%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 172 3             None        Quadratic       0       4        NA        NA
##     objective
## 172        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_35 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.04601            2098.79212
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1359.933
## Misclassification Error (Categorical):  339
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:31:43  0.009 sec          0   1.05000 3134.76905
## 2 2020-06-11 17:31:43  0.010 sec          1   0.70000 3134.76905
## 3 2020-06-11 17:31:43  0.011 sec          2   0.73500 3053.93990
## 4 2020-06-11 17:31:43  0.013 sec          3   0.49000 3053.93990
## 5 2020-06-11 17:31:43  0.014 sec          4   0.51450 2723.05849
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:31:43  0.036 sec         24   0.05678 2115.19723
## 26 2020-06-11 17:31:43  0.037 sec         25   0.05962 2106.47968
## 27 2020-06-11 17:31:43  0.039 sec         26   0.03975 2106.47968
## 28 2020-06-11 17:31:43  0.040 sec         27   0.04173 2102.54604
## 29 2020-06-11 17:31:43  0.041 sec         28   0.04382 2099.05102
## 30 2020-06-11 17:31:43  0.042 sec         29   0.04601 2098.79212</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-18.png" width="672" /></p>
<pre><code>## Iteration 19 of 75  25.3%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 214 3               L1               L1       1       4        NA        NA
##     objective
## 214        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_37 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.13483            2559.79131
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1377.455
## Misclassification Error (Categorical):  345
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:31:44  0.014 sec          0   1.05000 2924.37776
## 2 2020-06-11 17:31:44  0.016 sec          1   0.70000 2924.37776
## 3 2020-06-11 17:31:44  0.017 sec          2   0.46667 2924.37776
## 4 2020-06-11 17:31:44  0.018 sec          3   0.31111 2924.37776
## 5 2020-06-11 17:31:44  0.020 sec          4   0.15556 2924.37776
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:31:44  0.047 sec         24   0.10564 2580.67789
## 26 2020-06-11 17:31:44  0.048 sec         25   0.11092 2577.74155
## 27 2020-06-11 17:31:44  0.049 sec         26   0.11647 2570.13709
## 28 2020-06-11 17:31:44  0.050 sec         27   0.12229 2567.53358
## 29 2020-06-11 17:31:44  0.052 sec         28   0.12841 2562.57976
## 30 2020-06-11 17:31:44  0.053 sec         29   0.13483 2559.79131</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-19.png" width="672" /></p>
<pre><code>## Iteration 20 of 75  26.7%
##      k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 207 10               L1        Quadratic       1       4        NA        NA
##     objective
## 207        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_39 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.07247            1928.00010
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  907.1727
## Misclassification Error (Categorical):  99
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:31:46  0.020 sec          0   1.05000 3662.47013
## 2 2020-06-11 17:31:46  0.024 sec          1   0.70000 3662.47013
## 3 2020-06-11 17:31:46  0.027 sec          2   0.46667 3662.47013
## 4 2020-06-11 17:31:46  0.029 sec          3   0.49000 2923.23653
## 5 2020-06-11 17:31:46  0.033 sec          4   0.51450 2793.94544
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:31:46  0.095 sec         24   0.14085 1954.54243
## 26 2020-06-11 17:31:46  0.098 sec         25   0.14790 1943.67896
## 27 2020-06-11 17:31:46  0.101 sec         26   0.09860 1943.67896
## 28 2020-06-11 17:31:46  0.104 sec         27   0.10353 1932.56595
## 29 2020-06-11 17:31:46  0.107 sec         28   0.10870 1928.00010
## 30 2020-06-11 17:31:46  0.110 sec         29   0.07247 1928.00010</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-20.png" width="672" /></p>
<pre><code>## Iteration 21 of 75  28%
##      k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 240 10        Quadratic               L1       4       4        NA        NA
##     objective
## 240        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_41 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.11414            1911.97922
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  898.8717
## Misclassification Error (Categorical):  125
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:31:48  0.023 sec          0   1.05000 3703.59151
## 2 2020-06-11 17:31:48  0.027 sec          1   0.70000 3703.59151
## 3 2020-06-11 17:31:48  0.031 sec          2   0.46667 3703.59151
## 4 2020-06-11 17:31:48  0.034 sec          3   0.49000 3071.89741
## 5 2020-06-11 17:31:48  0.037 sec          4   0.51450 2805.45177
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:31:48  0.102 sec         24   0.14085 1977.93400
## 26 2020-06-11 17:31:48  0.107 sec         25   0.14790 1950.59167
## 27 2020-06-11 17:31:48  0.111 sec         26   0.15529 1941.76701
## 28 2020-06-11 17:31:48  0.115 sec         27   0.10353 1941.76701
## 29 2020-06-11 17:31:48  0.118 sec         28   0.10870 1922.02060
## 30 2020-06-11 17:31:48  0.121 sec         29   0.11414 1911.97922</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-21.png" width="672" /></p>
<pre><code>## Iteration 22 of 75  29.3%
##      k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 159 10        Quadratic               L1       4       1        NA        NA
##     objective
## 159        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_43 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.07247            1368.12017
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  677.1681
## Misclassification Error (Categorical):  87
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:31:49  0.018 sec          0   1.05000 3007.94952
## 2 2020-06-11 17:31:49  0.021 sec          1   0.70000 3007.94952
## 3 2020-06-11 17:31:49  0.025 sec          2   0.46667 3007.94952
## 4 2020-06-11 17:31:49  0.027 sec          3   0.49000 2659.83009
## 5 2020-06-11 17:31:49  0.032 sec          4   0.51450 2348.06378
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:31:49  0.103 sec         24   0.14085 1395.58157
## 26 2020-06-11 17:31:49  0.107 sec         25   0.09390 1395.58157
## 27 2020-06-11 17:31:49  0.111 sec         26   0.09860 1373.02331
## 28 2020-06-11 17:31:49  0.115 sec         27   0.10353 1368.35303
## 29 2020-06-11 17:31:49  0.119 sec         28   0.10870 1368.12017
## 30 2020-06-11 17:31:49  0.122 sec         29   0.07247 1368.12017</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-22.png" width="672" /></p>
<pre><code>## Iteration 23 of 75  30.7%
##      k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 234 10               L1        Quadratic       4       4        NA        NA
##     objective
## 234        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_45 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.07247            3097.74184
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1577.28
## Misclassification Error (Categorical):  258
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:31:51  0.018 sec          0   1.05000 4888.30984
## 2 2020-06-11 17:31:51  0.021 sec          1   1.10250 4523.25134
## 3 2020-06-11 17:31:51  0.024 sec          2   0.73500 4523.25134
## 4 2020-06-11 17:31:51  0.027 sec          3   0.49000 4523.25134
## 5 2020-06-11 17:31:51  0.030 sec          4   0.51450 4062.66421
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:31:51  0.088 sec         24   0.14085 3125.30525
## 26 2020-06-11 17:31:51  0.091 sec         25   0.14790 3122.95615
## 27 2020-06-11 17:31:51  0.094 sec         26   0.09860 3122.95615
## 28 2020-06-11 17:31:51  0.097 sec         27   0.10353 3103.47638
## 29 2020-06-11 17:31:51  0.100 sec         28   0.10870 3097.74184
## 30 2020-06-11 17:31:51  0.103 sec         29   0.07247 3097.74184</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-23.png" width="672" /></p>
<pre><code>## Iteration 24 of 75  32%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 161 5               L1               L1       4       1        NA        NA
##     objective
## 161        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_47 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.04601            2416.52572
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1419.86
## Misclassification Error (Categorical):  261
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:31:53  0.017 sec          0   1.05000 4449.74084
## 2 2020-06-11 17:31:53  0.018 sec          1   0.70000 4449.74084
## 3 2020-06-11 17:31:53  0.020 sec          2   0.73500 3723.18153
## 4 2020-06-11 17:31:53  0.022 sec          3   0.49000 3723.18153
## 5 2020-06-11 17:31:53  0.024 sec          4   0.51450 3319.63788
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:31:53  0.062 sec         24   0.08943 2447.75348
## 26 2020-06-11 17:31:53  0.063 sec         25   0.09390 2442.79407
## 27 2020-06-11 17:31:53  0.065 sec         26   0.06260 2442.79407
## 28 2020-06-11 17:31:53  0.067 sec         27   0.06573 2429.09068
## 29 2020-06-11 17:31:53  0.068 sec         28   0.06902 2416.52572
## 30 2020-06-11 17:31:53  0.070 sec         29   0.04601 2416.52572</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-24.png" width="672" /></p>
<pre><code>## Iteration 25 of 75  33.3%
##      k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 216 10               L1               L1       1       4        NA        NA
##     objective
## 216        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_49 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.17977            1772.02475
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  718.659
## Misclassification Error (Categorical):  67
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:31:54  0.018 sec          0   1.05000 3769.59059
## 2 2020-06-11 17:31:54  0.021 sec          1   0.70000 3769.59059
## 3 2020-06-11 17:31:54  0.023 sec          2   0.46667 3769.59059
## 4 2020-06-11 17:31:54  0.026 sec          3   0.49000 3196.92762
## 5 2020-06-11 17:31:54  0.029 sec          4   0.51450 2852.78647
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:31:54  0.089 sec         24   0.34941 1807.26389
## 26 2020-06-11 17:31:54  0.091 sec         25   0.23294 1807.26389
## 27 2020-06-11 17:31:54  0.094 sec         26   0.24458 1781.30373
## 28 2020-06-11 17:31:54  0.097 sec         27   0.25681 1773.04977
## 29 2020-06-11 17:31:54  0.100 sec         28   0.26965 1772.02475
## 30 2020-06-11 17:31:54  0.103 sec         29   0.17977 1772.02475</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-25.png" width="672" /></p>
<pre><code>## Iteration 26 of 75  34.7%
##      k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 135 10               L1               L1       1       1        NA        NA
##     objective
## 135        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_51 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.11414            1252.36736
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  611.2258
## Misclassification Error (Categorical):  50
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:31:56  0.034 sec          0   1.05000 3107.65051
## 2 2020-06-11 17:31:56  0.038 sec          1   0.70000 3107.65051
## 3 2020-06-11 17:31:56  0.042 sec          2   0.46667 3107.65051
## 4 2020-06-11 17:31:56  0.046 sec          3   0.49000 3045.91653
## 5 2020-06-11 17:31:56  0.049 sec          4   0.51450 2703.91261
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:31:56  0.110 sec         24   0.22184 1289.71785
## 26 2020-06-11 17:31:56  0.113 sec         25   0.14790 1289.71785
## 27 2020-06-11 17:31:56  0.116 sec         26   0.15529 1274.07942
## 28 2020-06-11 17:31:56  0.118 sec         27   0.16306 1265.16554
## 29 2020-06-11 17:31:56  0.121 sec         28   0.10870 1265.16554
## 30 2020-06-11 17:31:56  0.124 sec         29   0.11414 1252.36736</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-26.png" width="672" /></p>
<pre><code>## Iteration 27 of 75  36%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 101 5             None               L1       0       1        NA        NA
##     objective
## 101        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_53 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.33445            1177.62532
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1434.829
## Misclassification Error (Categorical):  95
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:31:58  0.016 sec          0   1.05000 2385.75844
## 2 2020-06-11 17:31:58  0.019 sec          1   0.70000 2385.75844
## 3 2020-06-11 17:31:58  0.022 sec          2   0.46667 2385.75844
## 4 2020-06-11 17:31:58  0.024 sec          3   0.31111 2385.75844
## 5 2020-06-11 17:31:58  0.027 sec          4   0.15556 2385.75844
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:31:58  0.066 sec         24   0.41274 1286.26662
## 26 2020-06-11 17:31:58  0.068 sec         25   0.43337 1259.55898
## 27 2020-06-11 17:31:58  0.069 sec         26   0.45504 1237.60458
## 28 2020-06-11 17:31:58  0.071 sec         27   0.47779 1228.32777
## 29 2020-06-11 17:31:58  0.073 sec         28   0.31853 1228.32777
## 30 2020-06-11 17:31:58  0.074 sec         29   0.33445 1177.62532</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-27.png" width="672" /></p>
<pre><code>## Iteration 28 of 75  37.3%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 149 5        Quadratic        Quadratic       4       1        NA        NA
##     objective
## 149        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_55 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.04601            1931.61877
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1346.045
## Misclassification Error (Categorical):  173
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:31:59  0.025 sec          0   1.05000 3016.58214
## 2 2020-06-11 17:31:59  0.027 sec          1   0.70000 3016.58214
## 3 2020-06-11 17:31:59  0.030 sec          2   0.46667 3016.58214
## 4 2020-06-11 17:31:59  0.033 sec          3   0.49000 2851.17913
## 5 2020-06-11 17:31:59  0.035 sec          4   0.51450 2507.73659
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:31:59  0.093 sec         24   0.08943 1951.85283
## 26 2020-06-11 17:31:59  0.095 sec         25   0.09390 1945.27278
## 27 2020-06-11 17:31:59  0.096 sec         26   0.06260 1945.27278
## 28 2020-06-11 17:31:59  0.098 sec         27   0.06573 1936.11036
## 29 2020-06-11 17:31:59  0.100 sec         28   0.06902 1931.61877
## 30 2020-06-11 17:31:59  0.102 sec         29   0.04601 1931.61877</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-28.png" width="672" /></p>
<pre><code>## Iteration 29 of 75  38.7%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 33 10        Quadratic             None       1       0        NA        NA
##    objective
## 33        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_57 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.17977             681.11182
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  559.3386
## Misclassification Error (Categorical):  44
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:01  0.017 sec          0   1.05000 2777.66708
## 2 2020-06-11 17:32:01  0.020 sec          1   0.70000 2777.66708
## 3 2020-06-11 17:32:01  0.023 sec          2   0.46667 2777.66708
## 4 2020-06-11 17:32:01  0.026 sec          3   0.31111 2777.66708
## 5 2020-06-11 17:32:01  0.029 sec          4   0.32667 2009.62535
## 
## ---
##              timestamp   duration iterations step_size objective
## 25 2020-06-11 17:32:01  0.087 sec         24   0.22184 743.00722
## 26 2020-06-11 17:32:01  0.089 sec         25   0.23294 722.05962
## 27 2020-06-11 17:32:01  0.092 sec         26   0.24458 720.93798
## 28 2020-06-11 17:32:01  0.095 sec         27   0.16306 720.93798
## 29 2020-06-11 17:32:01  0.098 sec         28   0.17121 692.39390
## 30 2020-06-11 17:32:01  0.101 sec         29   0.17977 681.11182</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-29.png" width="672" /></p>
<pre><code>## Iteration 30 of 75  40%
##    k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 58 3        Quadratic             None       4       0        NA        NA
##    objective
## 58        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_59 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.03451            2137.97996
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1342.545
## Misclassification Error (Categorical):  355
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:03  0.009 sec          0   1.05000 2521.45078
## 2 2020-06-11 17:32:03  0.011 sec          1   0.70000 2521.45078
## 3 2020-06-11 17:32:03  0.012 sec          2   0.46667 2521.45078
## 4 2020-06-11 17:32:03  0.014 sec          3   0.31111 2521.45078
## 5 2020-06-11 17:32:03  0.015 sec          4   0.15556 2521.45078
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:03  0.042 sec         24   0.04259 2148.31707
## 26 2020-06-11 17:32:03  0.043 sec         25   0.04472 2147.07827
## 27 2020-06-11 17:32:03  0.044 sec         26   0.04695 2145.09626
## 28 2020-06-11 17:32:03  0.046 sec         27   0.03130 2145.09626
## 29 2020-06-11 17:32:03  0.047 sec         28   0.03287 2138.99783
## 30 2020-06-11 17:32:03  0.048 sec         29   0.03451 2137.97996</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-30.png" width="672" /></p>
<pre><code>## Iteration 31 of 75  41.3%
##      k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 231 10        Quadratic        Quadratic       4       4        NA        NA
##     objective
## 231        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_61 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.02921            2299.44292
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1194.597
## Misclassification Error (Categorical):  129
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:04  0.019 sec          0   1.05000 3706.85791
## 2 2020-06-11 17:32:04  0.024 sec          1   0.70000 3706.85791
## 3 2020-06-11 17:32:04  0.028 sec          2   0.73500 3491.52619
## 4 2020-06-11 17:32:04  0.031 sec          3   0.77175 3226.04579
## 5 2020-06-11 17:32:04  0.034 sec          4   0.81034 3219.54303
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:04  0.099 sec         24   0.08943 2319.50966
## 26 2020-06-11 17:32:04  0.102 sec         25   0.05962 2319.50966
## 27 2020-06-11 17:32:04  0.106 sec         26   0.06260 2306.58959
## 28 2020-06-11 17:32:04  0.110 sec         27   0.04173 2306.58959
## 29 2020-06-11 17:32:04  0.113 sec         28   0.04382 2299.44292
## 30 2020-06-11 17:32:04  0.116 sec         29   0.02921 2299.44292</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-31.png" width="672" /></p>
<pre><code>## Iteration 32 of 75  42.7%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 152 5               L1        Quadratic       4       1        NA        NA
##     objective
## 152        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_63 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.04601            2564.77247
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1471.568
## Misclassification Error (Categorical):  256
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:06  0.010 sec          0   1.05000 4487.48202
## 2 2020-06-11 17:32:06  0.012 sec          1   0.70000 4487.48202
## 3 2020-06-11 17:32:06  0.014 sec          2   0.73500 3612.17655
## 4 2020-06-11 17:32:06  0.015 sec          3   0.49000 3612.17655
## 5 2020-06-11 17:32:06  0.017 sec          4   0.51450 3424.12459
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:06  0.050 sec         24   0.08943 2593.95334
## 26 2020-06-11 17:32:06  0.052 sec         25   0.09390 2586.73186
## 27 2020-06-11 17:32:06  0.054 sec         26   0.06260 2586.73186
## 28 2020-06-11 17:32:06  0.055 sec         27   0.06573 2572.14357
## 29 2020-06-11 17:32:06  0.057 sec         28   0.06902 2564.77247
## 30 2020-06-11 17:32:06  0.059 sec         29   0.04601 2564.77247</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-32.png" width="672" /></p>
<pre><code>## Iteration 33 of 75  44%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 181 3             None               L1       0       4        NA        NA
##     objective
## 181        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_65 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.17977            2081.97962
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1562.542
## Misclassification Error (Categorical):  263
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:07  0.011 sec          0   1.05000 2981.05265
## 2 2020-06-11 17:32:07  0.012 sec          1   0.70000 2981.05265
## 3 2020-06-11 17:32:07  0.014 sec          2   0.46667 2981.05265
## 4 2020-06-11 17:32:07  0.015 sec          3   0.31111 2981.05265
## 5 2020-06-11 17:32:07  0.016 sec          4   0.32667 2961.15593
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:07  0.042 sec         24   0.22184 2147.31713
## 26 2020-06-11 17:32:07  0.043 sec         25   0.23294 2112.08129
## 27 2020-06-11 17:32:07  0.045 sec         26   0.24458 2101.64469
## 28 2020-06-11 17:32:07  0.046 sec         27   0.25681 2092.79617
## 29 2020-06-11 17:32:07  0.047 sec         28   0.26965 2081.97962
## 30 2020-06-11 17:32:07  0.048 sec         29   0.17977 2081.97962</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-33.png" width="672" /></p>
<pre><code>## Iteration 34 of 75  45.3%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 130 3        Quadratic               L1       1       1        NA        NA
##     objective
## 130        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_67 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.03451            2144.58357
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1309.475
## Misclassification Error (Categorical):  355
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:09  0.019 sec          0   1.05000 2507.76069
## 2 2020-06-11 17:32:09  0.023 sec          1   0.70000 2507.76069
## 3 2020-06-11 17:32:09  0.026 sec          2   0.46667 2507.76069
## 4 2020-06-11 17:32:09  0.029 sec          3   0.31111 2507.76069
## 5 2020-06-11 17:32:09  0.031 sec          4   0.15556 2507.76069
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:09  0.064 sec         24   0.04259 2151.73251
## 26 2020-06-11 17:32:09  0.066 sec         25   0.04472 2150.28010
## 27 2020-06-11 17:32:09  0.067 sec         26   0.02981 2150.28010
## 28 2020-06-11 17:32:09  0.068 sec         27   0.03130 2146.31653
## 29 2020-06-11 17:32:09  0.069 sec         28   0.03287 2144.61249
## 30 2020-06-11 17:32:09  0.070 sec         29   0.03451 2144.58357</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-34.png" width="672" /></p>
<pre><code>## Iteration 35 of 75  46.7%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 239 5        Quadratic               L1       4       4        NA        NA
##     objective
## 239        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_69 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.07247            2150.41754
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1418.276
## Misclassification Error (Categorical):  182
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:11  0.012 sec          0   1.05000 3424.98736
## 2 2020-06-11 17:32:11  0.014 sec          1   0.70000 3424.98736
## 3 2020-06-11 17:32:11  0.015 sec          2   0.46667 3424.98736
## 4 2020-06-11 17:32:11  0.017 sec          3   0.49000 3119.46329
## 5 2020-06-11 17:32:11  0.020 sec          4   0.51450 2777.96462
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:11  0.059 sec         24   0.08943 2191.26957
## 26 2020-06-11 17:32:11  0.061 sec         25   0.09390 2177.51025
## 27 2020-06-11 17:32:11  0.063 sec         26   0.09860 2173.64380
## 28 2020-06-11 17:32:11  0.064 sec         27   0.06573 2173.64380
## 29 2020-06-11 17:32:11  0.066 sec         28   0.06902 2157.48169
## 30 2020-06-11 17:32:11  0.068 sec         29   0.07247 2150.41754</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-35.png" width="672" /></p>
<pre><code>## Iteration 36 of 75  48%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 122 5        Quadratic        Quadratic       1       1        NA        NA
##     objective
## 122        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_71 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.11414            1519.78355
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1367.928
## Misclassification Error (Categorical):  131
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:12  0.012 sec          0   1.05000 2578.38703
## 2 2020-06-11 17:32:12  0.014 sec          1   0.70000 2578.38703
## 3 2020-06-11 17:32:12  0.016 sec          2   0.46667 2578.38703
## 4 2020-06-11 17:32:12  0.018 sec          3   0.31111 2578.38703
## 5 2020-06-11 17:32:12  0.020 sec          4   0.32667 2487.60230
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:12  0.056 sec         24   0.14085 1552.31347
## 26 2020-06-11 17:32:12  0.058 sec         25   0.14790 1537.57691
## 27 2020-06-11 17:32:12  0.060 sec         26   0.15529 1533.90654
## 28 2020-06-11 17:32:13  0.062 sec         27   0.10353 1533.90654
## 29 2020-06-11 17:32:13  0.064 sec         28   0.10870 1523.88772
## 30 2020-06-11 17:32:13  0.065 sec         29   0.11414 1519.78355</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-36.png" width="672" /></p>
<pre><code>## Iteration 37 of 75  49.3%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 173 5             None        Quadratic       0       4        NA        NA
##     objective
## 173        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_73 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.07247            1482.29270
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1315.92
## Misclassification Error (Categorical):  171
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:14  0.014 sec          0   1.05000 3068.42772
## 2 2020-06-11 17:32:14  0.016 sec          1   0.70000 3068.42772
## 3 2020-06-11 17:32:14  0.019 sec          2   0.46667 3068.42772
## 4 2020-06-11 17:32:14  0.021 sec          3   0.49000 2854.74914
## 5 2020-06-11 17:32:14  0.023 sec          4   0.51450 2560.31423
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:14  0.057 sec         24   0.08943 1517.47774
## 26 2020-06-11 17:32:14  0.059 sec         25   0.09390 1502.84588
## 27 2020-06-11 17:32:14  0.061 sec         26   0.09860 1502.19339
## 28 2020-06-11 17:32:14  0.062 sec         27   0.06573 1502.19339
## 29 2020-06-11 17:32:14  0.064 sec         28   0.06902 1491.27720
## 30 2020-06-11 17:32:14  0.065 sec         29   0.07247 1482.29270</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-37.png" width="672" /></p>
<pre><code>## Iteration 38 of 75  50.7%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 203 5        Quadratic        Quadratic       1       4        NA        NA
##     objective
## 203        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_75 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.04601            1930.70517
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1336.887
## Misclassification Error (Categorical):  180
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:16  0.012 sec          0   1.05000 3127.22747
## 2 2020-06-11 17:32:16  0.014 sec          1   0.70000 3127.22747
## 3 2020-06-11 17:32:16  0.015 sec          2   0.46667 3127.22747
## 4 2020-06-11 17:32:16  0.017 sec          3   0.49000 2834.07759
## 5 2020-06-11 17:32:16  0.018 sec          4   0.51450 2563.72728
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:16  0.055 sec         24   0.08943 1944.44926
## 26 2020-06-11 17:32:16  0.057 sec         25   0.09390 1942.43988
## 27 2020-06-11 17:32:16  0.059 sec         26   0.06260 1942.43988
## 28 2020-06-11 17:32:16  0.061 sec         27   0.06573 1933.84493
## 29 2020-06-11 17:32:16  0.062 sec         28   0.06902 1930.70517
## 30 2020-06-11 17:32:16  0.064 sec         29   0.04601 1930.70517</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-38.png" width="672" /></p>
<pre><code>## Iteration 39 of 75  52%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 242 5               L1               L1       4       4        NA        NA
##     objective
## 242        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_77 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.07247            2948.45252
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1598.26
## Misclassification Error (Categorical):  329
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:17  0.011 sec          0   1.05000 4795.71371
## 2 2020-06-11 17:32:17  0.013 sec          1   1.10250 4500.79254
## 3 2020-06-11 17:32:17  0.015 sec          2   0.73500 4500.79254
## 4 2020-06-11 17:32:17  0.016 sec          3   0.49000 4500.79254
## 5 2020-06-11 17:32:17  0.018 sec          4   0.32667 4500.79254
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:17  0.051 sec         24   0.08943 2989.19156
## 26 2020-06-11 17:32:17  0.053 sec         25   0.09390 2977.92552
## 27 2020-06-11 17:32:17  0.054 sec         26   0.09860 2964.77079
## 28 2020-06-11 17:32:17  0.056 sec         27   0.06573 2964.77079
## 29 2020-06-11 17:32:17  0.058 sec         28   0.06902 2951.99986
## 30 2020-06-11 17:32:17  0.059 sec         29   0.07247 2948.45252</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-39.png" width="672" /></p>
<pre><code>## Iteration 40 of 75  53.3%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 206 5               L1        Quadratic       1       4        NA        NA
##     objective
## 206        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_79 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.04601            2079.36189
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1322.782
## Misclassification Error (Categorical):  183
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:19  0.012 sec          0   1.05000 3341.70576
## 2 2020-06-11 17:32:19  0.015 sec          1   0.70000 3341.70576
## 3 2020-06-11 17:32:19  0.017 sec          2   0.46667 3341.70576
## 4 2020-06-11 17:32:19  0.018 sec          3   0.49000 3024.51256
## 5 2020-06-11 17:32:19  0.020 sec          4   0.51450 2971.00044
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:19  0.056 sec         24   0.05678 2100.15858
## 26 2020-06-11 17:32:19  0.058 sec         25   0.05962 2094.53229
## 27 2020-06-11 17:32:19  0.060 sec         26   0.06260 2090.51660
## 28 2020-06-11 17:32:19  0.061 sec         27   0.04173 2090.51660
## 29 2020-06-11 17:32:19  0.063 sec         28   0.04382 2084.80422
## 30 2020-06-11 17:32:19  0.065 sec         29   0.04601 2079.36189</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-40.png" width="672" /></p>
<pre><code>## Iteration 41 of 75  54.7%
##      k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 123 10        Quadratic        Quadratic       1       1        NA        NA
##     objective
## 123        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_81 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.17977            1084.67184
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  686.1051
## Misclassification Error (Categorical):  57
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:20  0.017 sec          0   1.05000 3095.07933
## 2 2020-06-11 17:32:20  0.020 sec          1   0.70000 3095.07933
## 3 2020-06-11 17:32:20  0.023 sec          2   0.46667 3095.07933
## 4 2020-06-11 17:32:20  0.025 sec          3   0.49000 2811.09144
## 5 2020-06-11 17:32:20  0.028 sec          4   0.51450 2443.56691
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:20  0.090 sec         24   0.22184 1101.55410
## 26 2020-06-11 17:32:20  0.093 sec         25   0.14790 1101.55410
## 27 2020-06-11 17:32:20  0.097 sec         26   0.15529 1089.21771
## 28 2020-06-11 17:32:20  0.100 sec         27   0.16306 1088.15959
## 29 2020-06-11 17:32:20  0.103 sec         28   0.17121 1087.68494
## 30 2020-06-11 17:32:20  0.106 sec         29   0.17977 1084.67184</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-41.png" width="672" /></p>
<pre><code>## Iteration 42 of 75  56%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 134 5               L1               L1       1       1        NA        NA
##     objective
## 134        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_83 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.33445            1744.83347
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1383.495
## Misclassification Error (Categorical):  133
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:22  0.011 sec          0   1.05000 2579.39882
## 2 2020-06-11 17:32:22  0.013 sec          1   0.70000 2579.39882
## 3 2020-06-11 17:32:22  0.014 sec          2   0.46667 2579.39882
## 4 2020-06-11 17:32:22  0.016 sec          3   0.31111 2579.39882
## 5 2020-06-11 17:32:22  0.017 sec          4   0.15556 2579.39882
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:22  0.050 sec         24   0.41274 1795.25220
## 26 2020-06-11 17:32:22  0.052 sec         25   0.43337 1769.02348
## 27 2020-06-11 17:32:22  0.054 sec         26   0.45504 1758.16588
## 28 2020-06-11 17:32:22  0.055 sec         27   0.47779 1753.70096
## 29 2020-06-11 17:32:22  0.057 sec         28   0.50168 1744.83347
## 30 2020-06-11 17:32:22  0.059 sec         29   0.33445 1744.83347</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-42.png" width="672" /></p>
<pre><code>## Iteration 43 of 75  57.3%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 238 3        Quadratic               L1       4       4        NA        NA
##     objective
## 238        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_85 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.02921            2652.58179
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1462.412
## Misclassification Error (Categorical):  354
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:24  0.008 sec          0   1.05000 3118.13658
## 2 2020-06-11 17:32:24  0.010 sec          1   0.70000 3118.13658
## 3 2020-06-11 17:32:24  0.011 sec          2   0.46667 3118.13658
## 4 2020-06-11 17:32:24  0.012 sec          3   0.31111 3118.13658
## 5 2020-06-11 17:32:24  0.013 sec          4   0.32667 3040.31848
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:24  0.039 sec         24   0.03605 2657.57725
## 26 2020-06-11 17:32:24  0.040 sec         25   0.03785 2655.80855
## 27 2020-06-11 17:32:24  0.041 sec         26   0.02524 2655.80855
## 28 2020-06-11 17:32:24  0.042 sec         27   0.02650 2653.69713
## 29 2020-06-11 17:32:24  0.044 sec         28   0.02782 2652.81054
## 30 2020-06-11 17:32:24  0.045 sec         29   0.02921 2652.58179</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-43.png" width="672" /></p>
<pre><code>## Iteration 44 of 75  58.7%
##   k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 2 5             None             None       0       0        NA        NA
##   objective
## 2        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_87 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.33445            1014.94643
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1402.818
## Misclassification Error (Categorical):  99
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:25  0.012 sec          0   1.05000 2185.59449
## 2 2020-06-11 17:32:25  0.014 sec          1   0.70000 2185.59449
## 3 2020-06-11 17:32:25  0.016 sec          2   0.46667 2185.59449
## 4 2020-06-11 17:32:25  0.018 sec          3   0.31111 2185.59449
## 5 2020-06-11 17:32:25  0.020 sec          4   0.15556 2185.59449
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:25  0.062 sec         24   0.41274 1152.19526
## 26 2020-06-11 17:32:25  0.065 sec         25   0.43337 1132.70939
## 27 2020-06-11 17:32:25  0.067 sec         26   0.45504 1088.30737
## 28 2020-06-11 17:32:25  0.068 sec         27   0.30336 1088.30737
## 29 2020-06-11 17:32:25  0.070 sec         28   0.31853 1047.81879
## 30 2020-06-11 17:32:25  0.072 sec         29   0.33445 1014.94643</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-44.png" width="672" /></p>
<pre><code>## Iteration 45 of 75  60%
##    k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 61 3               L1             None       4       0        NA        NA
##    objective
## 61        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_89 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.02921            2426.38448
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1437.937
## Misclassification Error (Categorical):  356
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:27  0.010 sec          0   1.05000 4013.30781
## 2 2020-06-11 17:32:27  0.013 sec          1   0.70000 4013.30781
## 3 2020-06-11 17:32:27  0.016 sec          2   0.46667 4013.30781
## 4 2020-06-11 17:32:27  0.018 sec          3   0.49000 3197.67079
## 5 2020-06-11 17:32:27  0.020 sec          4   0.51450 2968.36765
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:27  0.049 sec         24   0.05678 2449.40841
## 26 2020-06-11 17:32:27  0.050 sec         25   0.05962 2436.98627
## 27 2020-06-11 17:32:27  0.051 sec         26   0.03975 2436.98627
## 28 2020-06-11 17:32:27  0.052 sec         27   0.04173 2429.78051
## 29 2020-06-11 17:32:27  0.054 sec         28   0.04382 2426.38448
## 30 2020-06-11 17:32:27  0.055 sec         29   0.02921 2426.38448</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-45.png" width="672" /></p>
<pre><code>## Iteration 46 of 75  61.3%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 93 10             None        Quadratic       0       1        NA        NA
##    objective
## 93        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_91 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.28314             673.15490
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  672.7126
## Misclassification Error (Categorical):  32
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:29  0.014 sec          0   1.05000 3579.80142
## 2 2020-06-11 17:32:29  0.018 sec          1   0.70000 3579.80142
## 3 2020-06-11 17:32:29  0.021 sec          2   0.46667 3579.80142
## 4 2020-06-11 17:32:29  0.024 sec          3   0.49000 3363.03916
## 5 2020-06-11 17:32:29  0.026 sec          4   0.51450 3321.38482
## 
## ---
##              timestamp   duration iterations step_size objective
## 25 2020-06-11 17:32:29  0.086 sec         24   0.22184 705.40792
## 26 2020-06-11 17:32:29  0.089 sec         25   0.23294 688.41365
## 27 2020-06-11 17:32:29  0.092 sec         26   0.24458 682.69714
## 28 2020-06-11 17:32:29  0.095 sec         27   0.25681 676.12303
## 29 2020-06-11 17:32:29  0.098 sec         28   0.26965 673.83462
## 30 2020-06-11 17:32:29  0.101 sec         29   0.28314 673.15490</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-46.png" width="672" /></p>
<pre><code>## Iteration 47 of 75  62.7%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 121 3        Quadratic        Quadratic       1       1        NA        NA
##     objective
## 121        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_93 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.21235            2150.62414
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1465.875
## Misclassification Error (Categorical):  312
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:30  0.010 sec          0   1.05000 2667.68481
## 2 2020-06-11 17:32:30  0.012 sec          1   0.70000 2667.68481
## 3 2020-06-11 17:32:30  0.015 sec          2   0.46667 2667.68481
## 4 2020-06-11 17:32:30  0.018 sec          3   0.31111 2667.68481
## 5 2020-06-11 17:32:30  0.020 sec          4   0.15556 2667.68481
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:30  0.056 sec         24   0.41274 2199.89428
## 26 2020-06-11 17:32:30  0.057 sec         25   0.27516 2199.89428
## 27 2020-06-11 17:32:30  0.059 sec         26   0.28891 2162.57483
## 28 2020-06-11 17:32:30  0.060 sec         27   0.30336 2152.58807
## 29 2020-06-11 17:32:30  0.061 sec         28   0.31853 2150.62414
## 30 2020-06-11 17:32:30  0.062 sec         29   0.21235 2150.62414</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-47.png" width="672" /></p>
<pre><code>## Iteration 48 of 75  64%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 182 5             None               L1       0       4        NA        NA
##     objective
## 182        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_95 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.17977            1392.08683
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1408.063
## Misclassification Error (Categorical):  103
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:32  0.010 sec          0   1.05000 2916.36675
## 2 2020-06-11 17:32:32  0.011 sec          1   0.70000 2916.36675
## 3 2020-06-11 17:32:32  0.013 sec          2   0.46667 2916.36675
## 4 2020-06-11 17:32:32  0.015 sec          3   0.31111 2916.36675
## 5 2020-06-11 17:32:32  0.016 sec          4   0.32667 2791.12956
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:32  0.050 sec         24   0.22184 1443.36480
## 26 2020-06-11 17:32:32  0.052 sec         25   0.23294 1436.83073
## 27 2020-06-11 17:32:32  0.054 sec         26   0.15529 1436.83073
## 28 2020-06-11 17:32:32  0.055 sec         27   0.16306 1410.77093
## 29 2020-06-11 17:32:32  0.057 sec         28   0.17121 1395.47972
## 30 2020-06-11 17:32:32  0.058 sec         29   0.17977 1392.08683</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-48.png" width="672" /></p>
<pre><code>## Iteration 49 of 75  65.3%
##      k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 150 10        Quadratic        Quadratic       4       1        NA        NA
##     objective
## 150        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_97 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.07247            1609.31677
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  823.3452
## Misclassification Error (Categorical):  98
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:33  0.020 sec          0   1.05000 3100.81480
## 2 2020-06-11 17:32:33  0.024 sec          1   0.70000 3100.81480
## 3 2020-06-11 17:32:33  0.029 sec          2   0.46667 3100.81480
## 4 2020-06-11 17:32:33  0.034 sec          3   0.49000 2648.56823
## 5 2020-06-11 17:32:33  0.038 sec          4   0.51450 2342.02873
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:34  0.104 sec         24   0.08943 1641.91469
## 26 2020-06-11 17:32:34  0.107 sec         25   0.09390 1626.98175
## 27 2020-06-11 17:32:34  0.110 sec         26   0.09860 1623.70644
## 28 2020-06-11 17:32:34  0.113 sec         27   0.06573 1623.70644
## 29 2020-06-11 17:32:34  0.117 sec         28   0.06902 1611.96978
## 30 2020-06-11 17:32:34  0.120 sec         29   0.07247 1609.31677</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-49.png" width="672" /></p>
<pre><code>## Iteration 50 of 75  66.7%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 241 3               L1               L1       4       4        NA        NA
##     objective
## 241        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_99 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.07247            2928.43078
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1647.195
## Misclassification Error (Categorical):  350
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:35  0.009 sec          0   1.05000 4487.86031
## 2 2020-06-11 17:32:35  0.011 sec          1   0.70000 4487.86031
## 3 2020-06-11 17:32:35  0.012 sec          2   0.73500 4051.87301
## 4 2020-06-11 17:32:35  0.013 sec          3   0.77175 3823.08667
## 5 2020-06-11 17:32:35  0.015 sec          4   0.51450 3823.08667
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:35  0.040 sec         24   0.08943 2968.04422
## 26 2020-06-11 17:32:35  0.041 sec         25   0.09390 2953.66584
## 27 2020-06-11 17:32:35  0.042 sec         26   0.09860 2944.82682
## 28 2020-06-11 17:32:35  0.043 sec         27   0.06573 2944.82682
## 29 2020-06-11 17:32:35  0.045 sec         28   0.06902 2934.64861
## 30 2020-06-11 17:32:35  0.046 sec         29   0.07247 2928.43078</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-50.png" width="672" /></p>
<pre><code>## Iteration 51 of 75  68%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 100 3             None               L1       0       1        NA        NA
##     objective
## 100        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_101 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.05435            2035.61522
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1322.072
## Misclassification Error (Categorical):  306
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:37  0.011 sec          0   1.05000 2592.66352
## 2 2020-06-11 17:32:37  0.013 sec          1   0.70000 2592.66352
## 3 2020-06-11 17:32:37  0.014 sec          2   0.46667 2592.66352
## 4 2020-06-11 17:32:37  0.015 sec          3   0.31111 2592.66352
## 5 2020-06-11 17:32:37  0.017 sec          4   0.15556 2592.66352
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:37  0.044 sec         24   0.10564 2058.92754
## 26 2020-06-11 17:32:37  0.046 sec         25   0.07043 2058.92754
## 27 2020-06-11 17:32:37  0.047 sec         26   0.07395 2050.21618
## 28 2020-06-11 17:32:37  0.049 sec         27   0.07765 2043.15704
## 29 2020-06-11 17:32:37  0.050 sec         28   0.05176 2043.15704
## 30 2020-06-11 17:32:37  0.052 sec         29   0.05435 2035.61522</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-51.png" width="672" /></p>
<pre><code>## Iteration 52 of 75  69.3%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 202 3        Quadratic        Quadratic       1       4        NA        NA
##     objective
## 202        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_103 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.04601            2382.41311
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1385.181
## Misclassification Error (Categorical):  347
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:39  0.010 sec          0   1.05000 3087.78622
## 2 2020-06-11 17:32:39  0.011 sec          1   0.70000 3087.78622
## 3 2020-06-11 17:32:39  0.013 sec          2   0.46667 3087.78622
## 4 2020-06-11 17:32:39  0.015 sec          3   0.49000 2925.93923
## 5 2020-06-11 17:32:39  0.016 sec          4   0.51450 2709.54424
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:39  0.050 sec         24   0.08943 2395.52895
## 26 2020-06-11 17:32:39  0.051 sec         25   0.05962 2395.52895
## 27 2020-06-11 17:32:39  0.053 sec         26   0.06260 2388.10168
## 28 2020-06-11 17:32:39  0.054 sec         27   0.06573 2386.68914
## 29 2020-06-11 17:32:39  0.056 sec         28   0.04382 2386.68914
## 30 2020-06-11 17:32:39  0.057 sec         29   0.04601 2382.41311</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-52.png" width="672" /></p>
<pre><code>## Iteration 53 of 75  70.7%
##    k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 35 5               L1             None       1       0        NA        NA
##    objective
## 35        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_105 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.13483            1469.24301
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1253.524
## Misclassification Error (Categorical):  161
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:40  0.014 sec          0   1.05000 2379.20645
## 2 2020-06-11 17:32:40  0.016 sec          1   0.70000 2379.20645
## 3 2020-06-11 17:32:40  0.018 sec          2   0.46667 2379.20645
## 4 2020-06-11 17:32:40  0.020 sec          3   0.31111 2379.20645
## 5 2020-06-11 17:32:40  0.023 sec          4   0.15556 2379.20645
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:40  0.057 sec         24   0.16638 1509.91582
## 26 2020-06-11 17:32:40  0.059 sec         25   0.17470 1508.94434
## 27 2020-06-11 17:32:40  0.060 sec         26   0.11647 1508.94434
## 28 2020-06-11 17:32:40  0.062 sec         27   0.12229 1481.22579
## 29 2020-06-11 17:32:40  0.064 sec         28   0.12841 1471.57184
## 30 2020-06-11 17:32:40  0.065 sec         29   0.13483 1469.24301</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-53.png" width="672" /></p>
<pre><code>## Iteration 54 of 75  72%
##      k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 126 10               L1        Quadratic       1       1        NA        NA
##     objective
## 126        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_107 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.17977            1439.28043
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  661.9937
## Misclassification Error (Categorical):  64
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:42  0.017 sec          0   1.05000 3176.64990
## 2 2020-06-11 17:32:42  0.020 sec          1   0.70000 3176.64990
## 3 2020-06-11 17:32:42  0.023 sec          2   0.46667 3176.64990
## 4 2020-06-11 17:32:42  0.027 sec          3   0.49000 2912.91125
## 5 2020-06-11 17:32:42  0.030 sec          4   0.51450 2534.38843
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:42  0.094 sec         24   0.22184 1458.24414
## 26 2020-06-11 17:32:42  0.098 sec         25   0.23294 1457.86256
## 27 2020-06-11 17:32:42  0.101 sec         26   0.15529 1457.86256
## 28 2020-06-11 17:32:42  0.104 sec         27   0.16306 1442.23305
## 29 2020-06-11 17:32:42  0.108 sec         28   0.17121 1439.95281
## 30 2020-06-11 17:32:42  0.111 sec         29   0.17977 1439.28043</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-54.png" width="672" /></p>
<pre><code>## Iteration 55 of 75  73.3%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 60 10        Quadratic             None       4       0        NA        NA
##    objective
## 60        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_109 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.07247             981.66125
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  647.399
## Misclassification Error (Categorical):  80
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:43  0.017 sec          0   1.05000 2722.88594
## 2 2020-06-11 17:32:44  0.022 sec          1   0.70000 2722.88594
## 3 2020-06-11 17:32:44  0.025 sec          2   0.46667 2722.88594
## 4 2020-06-11 17:32:44  0.029 sec          3   0.49000 2518.01305
## 5 2020-06-11 17:32:44  0.033 sec          4   0.51450 2155.04395
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:44  0.097 sec         24   0.08943 1039.03511
## 26 2020-06-11 17:32:44  0.099 sec         25   0.09390 1017.93264
## 27 2020-06-11 17:32:44  0.102 sec         26   0.09860 1007.03567
## 28 2020-06-11 17:32:44  0.105 sec         27   0.06573 1007.03567
## 29 2020-06-11 17:32:44  0.108 sec         28   0.06902  991.62423
## 30 2020-06-11 17:32:44  0.111 sec         29   0.07247  981.66125</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-55.png" width="672" /></p>
<pre><code>## Iteration 56 of 75  74.7%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 131 5        Quadratic               L1       1       1        NA        NA
##     objective
## 131        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_111 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.21235            1465.78112
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1342.971
## Misclassification Error (Categorical):  128
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:45  0.015 sec          0   1.05000 2423.22412
## 2 2020-06-11 17:32:45  0.017 sec          1   0.70000 2423.22412
## 3 2020-06-11 17:32:45  0.019 sec          2   0.46667 2423.22412
## 4 2020-06-11 17:32:45  0.021 sec          3   0.31111 2423.22412
## 5 2020-06-11 17:32:45  0.022 sec          4   0.15556 2423.22412
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:45  0.056 sec         24   0.16638 1515.27594
## 26 2020-06-11 17:32:45  0.058 sec         25   0.17470 1487.51515
## 27 2020-06-11 17:32:45  0.060 sec         26   0.18344 1474.09548
## 28 2020-06-11 17:32:45  0.062 sec         27   0.19261 1469.96701
## 29 2020-06-11 17:32:45  0.064 sec         28   0.20224 1468.08569
## 30 2020-06-11 17:32:45  0.067 sec         29   0.21235 1465.78112</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-56.png" width="672" /></p>
<pre><code>## Iteration 57 of 75  76%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 157 3        Quadratic               L1       4       1        NA        NA
##     objective
## 157        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_113 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.03451            2295.96917
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1366.168
## Misclassification Error (Categorical):  355
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:47  0.007 sec          0   1.05000 2680.74596
## 2 2020-06-11 17:32:47  0.009 sec          1   0.70000 2680.74596
## 3 2020-06-11 17:32:47  0.010 sec          2   0.46667 2680.74596
## 4 2020-06-11 17:32:47  0.011 sec          3   0.31111 2680.74596
## 5 2020-06-11 17:32:47  0.012 sec          4   0.15556 2680.74596
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:47  0.038 sec         24   0.04259 2303.99383
## 26 2020-06-11 17:32:47  0.039 sec         25   0.02839 2303.99383
## 27 2020-06-11 17:32:47  0.040 sec         26   0.02981 2299.48278
## 28 2020-06-11 17:32:47  0.041 sec         27   0.03130 2297.90230
## 29 2020-06-11 17:32:47  0.043 sec         28   0.03287 2296.99514
## 30 2020-06-11 17:32:47  0.044 sec         29   0.03451 2295.96917</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-57.png" width="672" /></p>
<pre><code>## Iteration 58 of 75  77.3%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 230 5        Quadratic        Quadratic       4       4        NA        NA
##     objective
## 230        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_115 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.02921            2535.23901
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1402.348
## Misclassification Error (Categorical):  212
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:48  0.017 sec          0   1.05000 3674.26175
## 2 2020-06-11 17:32:48  0.019 sec          1   0.70000 3674.26175
## 3 2020-06-11 17:32:48  0.021 sec          2   0.46667 3674.26175
## 4 2020-06-11 17:32:48  0.023 sec          3   0.49000 3101.95275
## 5 2020-06-11 17:32:48  0.025 sec          4   0.51450 3028.27486
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:49  0.063 sec         24   0.05678 2546.78079
## 26 2020-06-11 17:32:49  0.065 sec         25   0.03785 2546.78079
## 27 2020-06-11 17:32:49  0.067 sec         26   0.03975 2540.01539
## 28 2020-06-11 17:32:49  0.069 sec         27   0.02650 2540.01539
## 29 2020-06-11 17:32:49  0.071 sec         28   0.02782 2536.02364
## 30 2020-06-11 17:32:49  0.072 sec         29   0.02921 2535.23901</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-58.png" width="672" /></p>
<pre><code>## Iteration 59 of 75  78.7%
##    k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 59 5        Quadratic             None       4       0        NA        NA
##    objective
## 59        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_117 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.07247            1479.64579
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1320.759
## Misclassification Error (Categorical):  163
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:50  0.023 sec          0   1.05000 2645.00054
## 2 2020-06-11 17:32:50  0.027 sec          1   0.70000 2645.00054
## 3 2020-06-11 17:32:50  0.032 sec          2   0.46667 2645.00054
## 4 2020-06-11 17:32:50  0.036 sec          3   0.31111 2645.00054
## 5 2020-06-11 17:32:50  0.038 sec          4   0.32667 2512.70148
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:50  0.076 sec         24   0.08943 1540.83775
## 26 2020-06-11 17:32:50  0.078 sec         25   0.09390 1512.42096
## 27 2020-06-11 17:32:50  0.080 sec         26   0.09860 1504.16126
## 28 2020-06-11 17:32:50  0.082 sec         27   0.06573 1504.16126
## 29 2020-06-11 17:32:50  0.083 sec         28   0.06902 1486.64945
## 30 2020-06-11 17:32:50  0.085 sec         29   0.07247 1479.64579</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-59.png" width="672" /></p>
<pre><code>## Iteration 60 of 75  80%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 125 5               L1        Quadratic       1       1        NA        NA
##     objective
## 125        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_119 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.17977            1691.11410
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1381.535
## Misclassification Error (Categorical):  119
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:52  0.013 sec          0   1.05000 2737.51174
## 2 2020-06-11 17:32:52  0.015 sec          1   0.70000 2737.51174
## 3 2020-06-11 17:32:52  0.017 sec          2   0.46667 2737.51174
## 4 2020-06-11 17:32:52  0.019 sec          3   0.31111 2737.51174
## 5 2020-06-11 17:32:52  0.021 sec          4   0.32667 2620.55106
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:52  0.054 sec         24   0.22184 1710.78109
## 26 2020-06-11 17:32:52  0.056 sec         25   0.14790 1710.78109
## 27 2020-06-11 17:32:52  0.058 sec         26   0.15529 1696.06760
## 28 2020-06-11 17:32:52  0.059 sec         27   0.16306 1695.02818
## 29 2020-06-11 17:32:52  0.061 sec         28   0.17121 1693.57804
## 30 2020-06-11 17:32:52  0.063 sec         29   0.17977 1691.11410</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-60.png" width="672" /></p>
<pre><code>## Iteration 61 of 75  81.3%
##    k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 31 3        Quadratic             None       1       0        NA        NA
##    objective
## 31        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_121 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.02191            1980.70675
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1303.308
## Misclassification Error (Categorical):  354
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:53  0.010 sec          0   1.05000 2361.95790
## 2 2020-06-11 17:32:53  0.011 sec          1   0.70000 2361.95790
## 3 2020-06-11 17:32:53  0.013 sec          2   0.46667 2361.95790
## 4 2020-06-11 17:32:53  0.014 sec          3   0.31111 2361.95790
## 5 2020-06-11 17:32:53  0.016 sec          4   0.15556 2361.95790
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:53  0.038 sec         24   0.02704 1989.44120
## 26 2020-06-11 17:32:53  0.039 sec         25   0.02839 1985.78826
## 27 2020-06-11 17:32:53  0.040 sec         26   0.02981 1983.67927
## 28 2020-06-11 17:32:53  0.042 sec         27   0.01987 1983.67927
## 29 2020-06-11 17:32:53  0.043 sec         28   0.02087 1981.74356
## 30 2020-06-11 17:32:53  0.044 sec         29   0.02191 1980.70675</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-61.png" width="672" /></p>
<pre><code>## Iteration 62 of 75  82.7%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 133 3               L1               L1       1       1        NA        NA
##     objective
## 133        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_123 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.03451            2240.16322
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1335.423
## Misclassification Error (Categorical):  355
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:55  0.011 sec          0   1.05000 2538.85947
## 2 2020-06-11 17:32:55  0.013 sec          1   0.70000 2538.85947
## 3 2020-06-11 17:32:55  0.015 sec          2   0.46667 2538.85947
## 4 2020-06-11 17:32:55  0.018 sec          3   0.31111 2538.85947
## 5 2020-06-11 17:32:55  0.020 sec          4   0.15556 2538.85947
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:55  0.061 sec         24   0.04259 2246.02788
## 26 2020-06-11 17:32:55  0.064 sec         25   0.02839 2246.02788
## 27 2020-06-11 17:32:55  0.066 sec         26   0.02981 2242.97007
## 28 2020-06-11 17:32:55  0.068 sec         27   0.03130 2241.27268
## 29 2020-06-11 17:32:55  0.070 sec         28   0.03287 2240.67605
## 30 2020-06-11 17:32:55  0.073 sec         29   0.03451 2240.16322</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-62.png" width="672" /></p>
<pre><code>## Iteration 63 of 75  84%
##      k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 174 10             None        Quadratic       0       4        NA        NA
##     objective
## 174        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_125 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.07247            1030.77243
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  763.3506
## Misclassification Error (Categorical):  88
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:57  0.025 sec          0   1.05000 3764.32117
## 2 2020-06-11 17:32:57  0.031 sec          1   0.70000 3764.32117
## 3 2020-06-11 17:32:57  0.035 sec          2   0.46667 3764.32117
## 4 2020-06-11 17:32:57  0.038 sec          3   0.49000 2697.61615
## 5 2020-06-11 17:32:57  0.042 sec          4   0.51450 2532.64445
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:57  0.113 sec         24   0.14085 1061.26164
## 26 2020-06-11 17:32:57  0.116 sec         25   0.09390 1061.26164
## 27 2020-06-11 17:32:57  0.119 sec         26   0.09860 1045.75681
## 28 2020-06-11 17:32:57  0.123 sec         27   0.10353 1035.15837
## 29 2020-06-11 17:32:57  0.126 sec         28   0.10870 1030.77243
## 30 2020-06-11 17:32:57  0.129 sec         29   0.07247 1030.77243</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-63.png" width="672" /></p>
<pre><code>## Iteration 64 of 75  85.3%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 229 3        Quadratic        Quadratic       4       4        NA        NA
##     objective
## 229        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_127 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.04601            2792.10133
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1468.129
## Misclassification Error (Categorical):  357
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:32:58  0.013 sec          0   1.05000 3576.71003
## 2 2020-06-11 17:32:58  0.015 sec          1   0.70000 3576.71003
## 3 2020-06-11 17:32:58  0.017 sec          2   0.46667 3576.71003
## 4 2020-06-11 17:32:58  0.019 sec          3   0.49000 3390.36989
## 5 2020-06-11 17:32:58  0.021 sec          4   0.51450 3319.57170
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:32:59  0.053 sec         24   0.08943 2803.76222
## 26 2020-06-11 17:32:59  0.054 sec         25   0.05962 2803.76222
## 27 2020-06-11 17:32:59  0.055 sec         26   0.06260 2797.03216
## 28 2020-06-11 17:32:59  0.056 sec         27   0.06573 2793.97543
## 29 2020-06-11 17:32:59  0.058 sec         28   0.04382 2793.97543
## 30 2020-06-11 17:32:59  0.059 sec         29   0.04601 2792.10133</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-64.png" width="672" /></p>
<pre><code>## Iteration 65 of 75  86.7%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 215 5               L1               L1       1       4        NA        NA
##     objective
## 215        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_129 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.11414            1979.80661
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1363.845
## Misclassification Error (Categorical):  155
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:33:00  0.016 sec          0   1.05000 3103.76931
## 2 2020-06-11 17:33:00  0.018 sec          1   0.70000 3103.76931
## 3 2020-06-11 17:33:00  0.021 sec          2   0.46667 3103.76931
## 4 2020-06-11 17:33:00  0.023 sec          3   0.31111 3103.76931
## 5 2020-06-11 17:33:00  0.024 sec          4   0.32667 2932.29197
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:33:00  0.067 sec         24   0.14085 1997.76617
## 26 2020-06-11 17:33:00  0.069 sec         25   0.14790 1991.32144
## 27 2020-06-11 17:33:00  0.071 sec         26   0.09860 1991.32144
## 28 2020-06-11 17:33:00  0.073 sec         27   0.10353 1983.69656
## 29 2020-06-11 17:33:00  0.074 sec         28   0.10870 1981.69351
## 30 2020-06-11 17:33:00  0.076 sec         29   0.11414 1979.80661</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-65.png" width="672" /></p>
<pre><code>## Iteration 66 of 75  88%
##      k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 132 10        Quadratic               L1       1       1        NA        NA
##     objective
## 132        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_131 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.17977             952.81238
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  641.0921
## Misclassification Error (Categorical):  43
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:33:02  0.014 sec          0   1.05000 3035.56219
## 2 2020-06-11 17:33:02  0.017 sec          1   0.70000 3035.56219
## 3 2020-06-11 17:33:02  0.019 sec          2   0.46667 3035.56219
## 4 2020-06-11 17:33:02  0.022 sec          3   0.49000 2992.41193
## 5 2020-06-11 17:33:02  0.025 sec          4   0.51450 2622.23349
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:33:02  0.085 sec         24   0.22184 1003.63025
## 26 2020-06-11 17:33:02  0.088 sec         25   0.23294  978.22534
## 27 2020-06-11 17:33:02  0.091 sec         26   0.24458  971.83686
## 28 2020-06-11 17:33:02  0.095 sec         27   0.25681  968.97555
## 29 2020-06-11 17:33:02  0.098 sec         28   0.17121  968.97555
## 30 2020-06-11 17:33:02  0.101 sec         29   0.17977  952.81238</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-66.png" width="672" /></p>
<pre><code>## Iteration 67 of 75  89.3%
##      k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 243 10               L1               L1       4       4        NA        NA
##     objective
## 243        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_133 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.07247            2863.37569
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1546.808
## Misclassification Error (Categorical):  200
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:33:04  0.028 sec          0   1.05000 4951.02309
## 2 2020-06-11 17:33:04  0.033 sec          1   1.10250 4625.24092
## 3 2020-06-11 17:33:04  0.037 sec          2   0.73500 4625.24092
## 4 2020-06-11 17:33:04  0.040 sec          3   0.49000 4625.24092
## 5 2020-06-11 17:33:04  0.042 sec          4   0.32667 4625.24092
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:33:04  0.110 sec         24   0.14085 2921.01133
## 26 2020-06-11 17:33:04  0.113 sec         25   0.14790 2900.58588
## 27 2020-06-11 17:33:04  0.115 sec         26   0.09860 2900.58588
## 28 2020-06-11 17:33:04  0.118 sec         27   0.10353 2876.39636
## 29 2020-06-11 17:33:04  0.121 sec         28   0.10870 2863.37569
## 30 2020-06-11 17:33:04  0.124 sec         29   0.07247 2863.37569</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-67.png" width="672" /></p>
<pre><code>## Iteration 68 of 75  90.7%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 211 3        Quadratic               L1       1       4        NA        NA
##     objective
## 211        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_135 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.21235            2429.05352
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1424.825
## Misclassification Error (Categorical):  294
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:33:05  0.009 sec          0   1.05000 2893.12548
## 2 2020-06-11 17:33:05  0.012 sec          1   0.70000 2893.12548
## 3 2020-06-11 17:33:05  0.014 sec          2   0.46667 2893.12548
## 4 2020-06-11 17:33:05  0.016 sec          3   0.31111 2893.12548
## 5 2020-06-11 17:33:05  0.018 sec          4   0.15556 2893.12548
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:33:05  0.045 sec         24   0.16638 2489.73957
## 26 2020-06-11 17:33:05  0.046 sec         25   0.17470 2462.83342
## 27 2020-06-11 17:33:05  0.047 sec         26   0.18344 2442.67385
## 28 2020-06-11 17:33:05  0.048 sec         27   0.19261 2433.32061
## 29 2020-06-11 17:33:05  0.049 sec         28   0.20224 2433.02617
## 30 2020-06-11 17:33:05  0.051 sec         29   0.21235 2429.05352</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-68.png" width="672" /></p>
<pre><code>## Iteration 69 of 75  92%
##    k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 32 5        Quadratic             None       1       0        NA        NA
##    objective
## 32        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_137 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.13483            1247.99574
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1316.128
## Misclassification Error (Categorical):  131
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:33:07  0.014 sec          0   1.05000 2225.51619
## 2 2020-06-11 17:33:07  0.016 sec          1   0.70000 2225.51619
## 3 2020-06-11 17:33:07  0.019 sec          2   0.46667 2225.51619
## 4 2020-06-11 17:33:07  0.021 sec          3   0.31111 2225.51619
## 5 2020-06-11 17:33:07  0.023 sec          4   0.15556 2225.51619
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:33:07  0.064 sec         24   0.16638 1335.45909
## 26 2020-06-11 17:33:07  0.066 sec         25   0.17470 1299.52334
## 27 2020-06-11 17:33:07  0.068 sec         26   0.18344 1277.23156
## 28 2020-06-11 17:33:07  0.070 sec         27   0.12229 1277.23156
## 29 2020-06-11 17:33:07  0.072 sec         28   0.12841 1259.50994
## 30 2020-06-11 17:33:07  0.075 sec         29   0.13483 1247.99574</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-69.png" width="672" /></p>
<pre><code>## Iteration 70 of 75  93.3%
##      k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 162 10               L1               L1       4       1        NA        NA
##     objective
## 162        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_139 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.07247            2253.16831
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1224.258
## Misclassification Error (Categorical):  126
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:33:09  0.020 sec          0   1.05000 4468.41114
## 2 2020-06-11 17:33:09  0.024 sec          1   0.70000 4468.41114
## 3 2020-06-11 17:33:09  0.028 sec          2   0.73500 3772.78952
## 4 2020-06-11 17:33:09  0.031 sec          3   0.49000 3772.78952
## 5 2020-06-11 17:33:09  0.035 sec          4   0.51450 3554.59294
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:33:09  0.108 sec         24   0.08943 2321.43191
## 26 2020-06-11 17:33:09  0.111 sec         25   0.09390 2297.93675
## 27 2020-06-11 17:33:09  0.114 sec         26   0.09860 2281.79156
## 28 2020-06-11 17:33:09  0.117 sec         27   0.06573 2281.79156
## 29 2020-06-11 17:33:09  0.120 sec         28   0.06902 2262.04263
## 30 2020-06-11 17:33:09  0.123 sec         29   0.07247 2253.16831</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-70.png" width="672" /></p>
<pre><code>## Iteration 71 of 75  94.7%
##    k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 92 5             None        Quadratic       0       1        NA        NA
##    objective
## 92        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_141 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.17977            1167.80462
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1378.299
## Misclassification Error (Categorical):  109
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:33:10  0.018 sec          0   1.05000 2555.38571
## 2 2020-06-11 17:33:10  0.021 sec          1   0.70000 2555.38571
## 3 2020-06-11 17:33:10  0.024 sec          2   0.46667 2555.38571
## 4 2020-06-11 17:33:10  0.026 sec          3   0.31111 2555.38571
## 5 2020-06-11 17:33:10  0.028 sec          4   0.32667 2452.08664
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:33:10  0.067 sec         24   0.22184 1200.90854
## 26 2020-06-11 17:33:10  0.069 sec         25   0.23294 1193.48888
## 27 2020-06-11 17:33:10  0.070 sec         26   0.15529 1193.48888
## 28 2020-06-11 17:33:10  0.072 sec         27   0.16306 1174.63573
## 29 2020-06-11 17:33:10  0.074 sec         28   0.17121 1170.36713
## 30 2020-06-11 17:33:10  0.076 sec         29   0.17977 1167.80462</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-71.png" width="672" /></p>
<pre><code>## Iteration 72 of 75  96%
##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 205 3               L1        Quadratic       1       4        NA        NA
##     objective
## 205        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_143 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.04601            2459.13423
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1393.852
## Misclassification Error (Categorical):  340
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:33:12  0.010 sec          0   1.05000 3169.78321
## 2 2020-06-11 17:33:12  0.012 sec          1   0.70000 3169.78321
## 3 2020-06-11 17:33:12  0.013 sec          2   0.46667 3169.78321
## 4 2020-06-11 17:33:12  0.015 sec          3   0.49000 3011.45708
## 5 2020-06-11 17:33:12  0.016 sec          4   0.51450 2838.12541
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:33:12  0.043 sec         24   0.08943 2471.16445
## 26 2020-06-11 17:33:12  0.044 sec         25   0.05962 2471.16445
## 27 2020-06-11 17:33:12  0.046 sec         26   0.06260 2468.13156
## 28 2020-06-11 17:33:12  0.047 sec         27   0.06573 2465.87609
## 29 2020-06-11 17:33:12  0.048 sec         28   0.04382 2465.87609
## 30 2020-06-11 17:33:12  0.050 sec         29   0.04601 2459.13423</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-72.png" width="672" /></p>
<pre><code>## Iteration 73 of 75  97.3%
##    k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 91 3             None        Quadratic       0       1        NA        NA
##    objective
## 91        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_145 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.17977            1869.24089
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  1555.012
## Misclassification Error (Categorical):  257
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:33:14  0.007 sec          0   1.05000 2775.93938
## 2 2020-06-11 17:33:14  0.008 sec          1   0.70000 2775.93938
## 3 2020-06-11 17:33:14  0.009 sec          2   0.46667 2775.93938
## 4 2020-06-11 17:33:14  0.010 sec          3   0.31111 2775.93938
## 5 2020-06-11 17:33:14  0.011 sec          4   0.32667 2725.89448
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:33:14  0.036 sec         24   0.22184 1975.95876
## 26 2020-06-11 17:33:14  0.037 sec         25   0.23294 1930.33840
## 27 2020-06-11 17:33:14  0.038 sec         26   0.24458 1911.34524
## 28 2020-06-11 17:33:14  0.039 sec         27   0.16306 1911.34524
## 29 2020-06-11 17:33:14  0.041 sec         28   0.17121 1880.53655
## 30 2020-06-11 17:33:14  0.042 sec         29   0.17977 1869.24089</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-73.png" width="672" /></p>
<pre><code>## Iteration 74 of 75  98.7%
##      k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 213 10        Quadratic               L1       1       4        NA        NA
##     objective
## 213        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_147 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.17977            1437.09113
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  683.4182
## Misclassification Error (Categorical):  78
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:33:15  0.015 sec          0   1.05000 3652.87841
## 2 2020-06-11 17:33:15  0.018 sec          1   0.70000 3652.87841
## 3 2020-06-11 17:33:15  0.022 sec          2   0.46667 3652.87841
## 4 2020-06-11 17:33:15  0.025 sec          3   0.49000 3124.49085
## 5 2020-06-11 17:33:15  0.028 sec          4   0.51450 2658.24626
## 
## ---
##              timestamp   duration iterations step_size  objective
## 25 2020-06-11 17:33:15  0.089 sec         24   0.34941 1485.77762
## 26 2020-06-11 17:33:15  0.093 sec         25   0.23294 1485.77762
## 27 2020-06-11 17:33:15  0.096 sec         26   0.24458 1465.29243
## 28 2020-06-11 17:33:15  0.099 sec         27   0.25681 1451.06874
## 29 2020-06-11 17:33:15  0.102 sec         28   0.17121 1451.06874
## 30 2020-06-11 17:33:15  0.105 sec         29   0.17977 1437.09113</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-74.png" width="672" /></p>
<pre><code>## Iteration 75 of 75  100%
##    k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 3 10             None             None       0       0        NA        NA
##   objective
## 3        NA
## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  GLRM_model_R_1591921854897_149 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                   30         0.28314             369.72868
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  517.8523
## Misclassification Error (Categorical):  15
## Number of Numeric Entries:  1833
## Number of Categorical Entries:  1143
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 17:33:17  0.015 sec          0   1.05000 3348.56023
## 2 2020-06-11 17:33:17  0.018 sec          1   0.70000 3348.56023
## 3 2020-06-11 17:33:17  0.021 sec          2   0.46667 3348.56023
## 4 2020-06-11 17:33:17  0.024 sec          3   0.31111 3348.56023
## 5 2020-06-11 17:33:17  0.027 sec          4   0.32667 2176.17652
## 
## ---
##              timestamp   duration iterations step_size objective
## 25 2020-06-11 17:33:17  0.087 sec         24   0.34941 427.15184
## 26 2020-06-11 17:33:17  0.089 sec         25   0.36688 424.43268
## 27 2020-06-11 17:33:17  0.093 sec         26   0.24458 424.43268
## 28 2020-06-11 17:33:17  0.096 sec         27   0.25681 385.85102
## 29 2020-06-11 17:33:17  0.099 sec         28   0.26965 378.98067
## 30 2020-06-11 17:33:17  0.102 sec         29   0.28314 369.72868</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-75.png" width="672" /></p>
<pre><code>##    user  system elapsed 
##   31.64    1.03  124.03</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="missing-values-and-imputation.html#cb156-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: confirm that this is correct.</span></span>
<span id="cb156-2"><a href="missing-values-and-imputation.html#cb156-2"></a>params<span class="op">$</span>error =<span class="st"> </span>params<span class="op">$</span>error_num <span class="op">+</span><span class="st"> </span>params<span class="op">$</span>error_cat</span>
<span id="cb156-3"><a href="missing-values-and-imputation.html#cb156-3"></a></span>
<span id="cb156-4"><a href="missing-values-and-imputation.html#cb156-4"></a><span class="kw">save</span>(params, glrm_metrics, glrm_sum,</span>
<span id="cb156-5"><a href="missing-values-and-imputation.html#cb156-5"></a>     <span class="dt">file =</span> <span class="st">&quot;data/glrm-tuned-results.RData&quot;</span>)</span>
<span id="cb156-6"><a href="missing-values-and-imputation.html#cb156-6"></a></span>
<span id="cb156-7"><a href="missing-values-and-imputation.html#cb156-7"></a><span class="kw">qplot</span>(params<span class="op">$</span>error) <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>() <span class="op">+</span></span>
<span id="cb156-8"><a href="missing-values-and-imputation.html#cb156-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Test set error&quot;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="data-science-in-r_files/figure-html/glrm_grid_search-76.png" width="672" /></p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="missing-values-and-imputation.html#cb158-1"></a>params =<span class="st"> </span>params <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(error) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.data.frame</span>()</span>
<span id="cb158-2"><a href="missing-values-and-imputation.html#cb158-2"></a></span>
<span id="cb158-3"><a href="missing-values-and-imputation.html#cb158-3"></a><span class="co"># Look at the top 10 models with the lowest error rate</span></span>
<span id="cb158-4"><a href="missing-values-and-imputation.html#cb158-4"></a><span class="kw">head</span>(params, <span class="dv">25</span>)</span></code></pre></div>
<pre><code>##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 1  10        Quadratic             None       4       0  242.0873        29
## 2  10             None        Quadratic       0       1  251.0145        23
## 3  10        Quadratic               L1       1       1  250.2923        24
## 4  10        Quadratic               L1       4       1  246.7835        29
## 5  10        Quadratic        Quadratic       1       1  253.6244        24
## 6  10             None        Quadratic       0       4  256.3729        26
## 7  10             None               L1       0       1  269.5762        21
## 8  10        Quadratic             None       1       0  271.5547        23
## 9  10               L1        Quadratic       1       1  269.3316        26
## 10 10             None             None       0       0  282.2528        20
## 11 10        Quadratic               L1       1       4  274.0599        31
## 12 10               L1             None       1       0  286.3755        25
## 13 10               L1               L1       1       4  291.9272        26
## 14 10               L1               L1       1       1  293.1568        25
## 15 10        Quadratic        Quadratic       4       1  290.1459        32
## 16 10             None               L1       0       4  300.5562        24
## 17 10        Quadratic        Quadratic       1       4  309.7851        31
## 18 10               L1        Quadratic       1       4  313.1170        36
## 19 10        Quadratic               L1       4       4  317.0228        41
## 20 10        Quadratic        Quadratic       4       4  384.9836        41
## 21 10               L1             None       4       0  375.8775        54
## 22 10               L1               L1       4       1  394.8270        50
## 23  5             None        Quadratic       0       4  410.9857        60
## 24  5        Quadratic             None       1       0  418.0738        53
## 25  5        Quadratic             None       4       0  402.7778        69
##    objective    error
## 1   981.6612 271.0873
## 2   673.1549 274.0145
## 3   952.8124 274.2923
## 4  1368.1202 275.7835
## 5  1084.6718 277.6244
## 6  1030.7724 282.3729
## 7   647.6055 290.5762
## 8   681.1118 294.5547
## 9  1439.2804 295.3316
## 10  369.7287 302.2528
## 11 1437.0911 305.0599
## 12  993.9386 311.3755
## 13 1772.0248 317.9272
## 14 1252.3674 318.1568
## 15 1609.3168 322.1459
## 16  970.4729 324.5562
## 17 1608.2907 340.7851
## 18 1928.0001 349.1170
## 19 1911.9792 358.0228
## 20 2299.4429 425.9836
## 21 1959.4131 429.8775
## 22 2253.1683 444.8270
## 23 1482.2927 470.9857
## 24 1247.9957 471.0738
## 25 1479.6458 471.7778</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="missing-values-and-imputation.html#cb160-1"></a><span class="co"># Look at the worst models</span></span>
<span id="cb160-2"><a href="missing-values-and-imputation.html#cb160-2"></a><span class="kw">tail</span>(params, <span class="dv">25</span>)</span></code></pre></div>
<pre><code>##     k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 51  3               L1        Quadratic       1       1  425.6527       113
## 52  3        Quadratic               L1       4       1  422.6933       116
## 53  3        Quadratic             None       4       0  422.3144       117
## 54  3               L1             None       1       0  425.7815       115
## 55  3               L1               L1       1       1  425.2071       116
## 56  3        Quadratic        Quadratic       1       4  429.4291       112
## 57  5             None               L1       0       1  505.9907        36
## 58  3             None        Quadratic       0       4  437.1649       105
## 59  3        Quadratic               L1       1       4  460.5853        90
## 60  3             None               L1       0       1  449.9004       101
## 61  3        Quadratic        Quadratic       4       4  437.8739       116
## 62  3               L1               L1       4       1  438.5275       116
## 63  3               L1        Quadratic       1       4  447.8649       107
## 64  3        Quadratic        Quadratic       1       1  456.9178        99
## 65  3        Quadratic               L1       4       4  442.2654       114
## 66  3               L1             None       4       0  442.6686       116
## 67  5               L1        Quadratic       4       1  462.4949        97
## 68 10               L1        Quadratic       4       4  468.7604        92
## 69  5               L1               L1       4       4  457.1146       107
## 70  5               L1        Quadratic       4       4  464.5910       106
## 71  3               L1        Quadratic       4       1  453.9638       117
## 72  3             None        Quadratic       0       1  491.6003        87
## 73  3             None               L1       0       4  489.7113        90
## 74  3               L1               L1       4       4  472.2836       116
## 75  3               L1        Quadratic       4       4  472.6318       119
##    objective    error
## 51  2314.609 538.6527
## 52  2295.969 538.6933
## 53  2137.980 539.3144
## 54  2077.699 540.7815
## 55  2240.163 541.2071
## 56  2382.413 541.4291
## 57  1177.625 541.9907
## 58  2098.792 542.1649
## 59  2429.054 550.5853
## 60  2035.615 550.9004
## 61  2792.101 553.8739
## 62  2572.007 554.5275
## 63  2459.134 554.8649
## 64  2150.624 555.9178
## 65  2652.582 556.2654
## 66  2426.384 558.6686
## 67  2564.772 559.4949
## 68  3097.742 560.7604
## 69  2948.453 564.1146
## 70  3078.152 570.5910
## 71  2719.046 570.9638
## 72  1869.241 578.6003
## 73  2081.980 579.7113
## 74  2928.431 588.2836
## 75  3059.373 591.6318</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="missing-values-and-imputation.html#cb162-1"></a>rio<span class="op">::</span><span class="kw">export</span>(params, <span class="dt">file =</span> <span class="st">&quot;tables/glrm-grid-search.xlsx&quot;</span>)</span></code></pre></div>
</div>
<div id="apply-best-glrm" class="section level3">
<h3><span class="header-section-number">3.4.9</span> Apply best GLRM</h3>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="missing-values-and-imputation.html#cb163-1"></a>params =<span class="st"> </span>rio<span class="op">::</span><span class="kw">import</span>(<span class="st">&quot;tables/glrm-grid-search.xlsx&quot;</span>)</span>
<span id="cb163-2"><a href="missing-values-and-imputation.html#cb163-2"></a></span>
<span id="cb163-3"><a href="missing-values-and-imputation.html#cb163-3"></a>(<span class="dt">best_params =</span> params <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(error) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##    k regularization_x regularization_y gamma_x gamma_y error_num error_cat
## 1 10        Quadratic             None       4       0  242.0873        29
##   objective    error
## 1  981.6612 271.0873</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="missing-values-and-imputation.html#cb165-1"></a><span class="kw">system.time</span>({</span>
<span id="cb165-2"><a href="missing-values-and-imputation.html#cb165-2"></a>  <span class="co"># Now run on full dataset.</span></span>
<span id="cb165-3"><a href="missing-values-and-imputation.html#cb165-3"></a>glrm_result =</span>
<span id="cb165-4"><a href="missing-values-and-imputation.html#cb165-4"></a><span class="st">  </span>h2o<span class="op">::</span><span class="kw">h2o.glrm</span>(<span class="dt">training_frame =</span> h2o_df, <span class="dt">cols =</span> <span class="kw">colnames</span>(h2o_df),</span>
<span id="cb165-5"><a href="missing-values-and-imputation.html#cb165-5"></a>           <span class="dt">loss =</span> <span class="st">&quot;Quadratic&quot;</span>,</span>
<span id="cb165-6"><a href="missing-values-and-imputation.html#cb165-6"></a>           <span class="dt">model_id =</span> <span class="st">&quot;impute_glrm&quot;</span>,</span>
<span id="cb165-7"><a href="missing-values-and-imputation.html#cb165-7"></a>           <span class="dt">seed =</span> <span class="dv">1</span>,</span>
<span id="cb165-8"><a href="missing-values-and-imputation.html#cb165-8"></a>           <span class="dt">k =</span> best_params<span class="op">$</span>k,</span>
<span id="cb165-9"><a href="missing-values-and-imputation.html#cb165-9"></a>           <span class="dt">max_iterations =</span> <span class="dv">2000</span>,</span>
<span id="cb165-10"><a href="missing-values-and-imputation.html#cb165-10"></a>           <span class="co"># This is necessary to ensure that the model can optimize, otherwise</span></span>
<span id="cb165-11"><a href="missing-values-and-imputation.html#cb165-11"></a>           <span class="co"># there may be no improvement in the objective.</span></span>
<span id="cb165-12"><a href="missing-values-and-imputation.html#cb165-12"></a>           <span class="dt">transform =</span> <span class="st">&quot;STANDARDIZE&quot;</span>, </span>
<span id="cb165-13"><a href="missing-values-and-imputation.html#cb165-13"></a>           <span class="dt">regularization_x =</span> best_params<span class="op">$</span>regularization_x,</span>
<span id="cb165-14"><a href="missing-values-and-imputation.html#cb165-14"></a>           <span class="dt">regularization_y =</span> best_params<span class="op">$</span>regularization_y,</span>
<span id="cb165-15"><a href="missing-values-and-imputation.html#cb165-15"></a>           <span class="dt">gamma_x =</span> best_params<span class="op">$</span>gamma_x,</span>
<span id="cb165-16"><a href="missing-values-and-imputation.html#cb165-16"></a>           <span class="dt">gamma_y =</span> best_params<span class="op">$</span>gamma_y,</span>
<span id="cb165-17"><a href="missing-values-and-imputation.html#cb165-17"></a>           <span class="dt">loss_by_col_idx =</span> losses<span class="op">$</span>index,</span>
<span id="cb165-18"><a href="missing-values-and-imputation.html#cb165-18"></a>           <span class="dt">loss_by_col =</span> losses<span class="op">$</span>loss)</span>
<span id="cb165-19"><a href="missing-values-and-imputation.html#cb165-19"></a>})</span></code></pre></div>
<pre><code>##    user  system elapsed 
##    0.10    0.00    2.41</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="missing-values-and-imputation.html#cb167-1"></a>h2o<span class="op">::</span><span class="kw">summary</span>(glrm_result)</span></code></pre></div>
<pre><code>## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model Key:  impute_glrm 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                  237         0.00009            1045.33367
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  864.1832
## Misclassification Error (Categorical):  81
## Number of Numeric Entries:  2397
## Number of Categorical Entries:  1493
## 
## 
## 
## Scoring History: 
##             timestamp   duration iterations step_size  objective
## 1 2020-06-11 18:09:18  0.232 sec          0   1.05000 3144.82797
## 2 2020-06-11 18:09:18  0.250 sec          1   0.70000 3144.82797
## 3 2020-06-11 18:09:18  0.261 sec          2   0.46667 3144.82797
## 4 2020-06-11 18:09:18  0.271 sec          3   0.31111 3144.82797
## 5 2020-06-11 18:09:18  0.280 sec          4   0.32667 2931.70821
## 
## ---
##               timestamp   duration iterations step_size  objective
## 232 2020-06-11 18:09:19  1.189 sec        231   0.00017 1045.37528
## 233 2020-06-11 18:09:19  1.192 sec        232   0.00011 1045.37528
## 234 2020-06-11 18:09:19  1.196 sec        233   0.00012 1045.34632
## 235 2020-06-11 18:09:19  1.199 sec        234   0.00013 1045.33851
## 236 2020-06-11 18:09:19  1.202 sec        235   0.00013 1045.33367
## 237 2020-06-11 18:09:19  1.205 sec        236   0.00009 1045.33367</code></pre>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="missing-values-and-imputation.html#cb169-1"></a>glrm_result</span></code></pre></div>
<pre><code>## Model Details:
## ==============
## 
## H2ODimReductionModel: glrm
## Model ID:  impute_glrm 
## Model Summary: 
##   number_of_iterations final_step_size final_objective_value
## 1                  237         0.00009            1045.33367
## 
## 
## H2ODimReductionMetrics: glrm
## ** Reported on training data. **
## 
## Sum of Squared Error (Numeric):  864.1832
## Misclassification Error (Categorical):  81
## Number of Numeric Entries:  2397
## Number of Categorical Entries:  1493</code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="missing-values-and-imputation.html#cb171-1"></a><span class="kw">plot</span>(glrm_result)</span></code></pre></div>
<p><img src="data-science-in-r_files/figure-html/apply_glrm-1.png" width="672" /></p>
</div>
<div id="review-glrm" class="section level3">
<h3><span class="header-section-number">3.4.10</span> Review GLRM</h3>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="missing-values-and-imputation.html#cb172-1"></a><span class="co"># Don&#39;t use h2o&#39;s provided model$importance statistics, they are flawed.</span></span>
<span id="cb172-2"><a href="missing-values-and-imputation.html#cb172-2"></a><span class="co"># We need to calculate these manually for now (Apr. 2020).</span></span>
<span id="cb172-3"><a href="missing-values-and-imputation.html#cb172-3"></a></span>
<span id="cb172-4"><a href="missing-values-and-imputation.html#cb172-4"></a><span class="co"># Extract compressed dataset.</span></span>
<span id="cb172-5"><a href="missing-values-and-imputation.html#cb172-5"></a>new_data =<span class="st"> </span><span class="kw">as.data.frame</span>(h2o<span class="op">::</span><span class="kw">h2o.getFrame</span>(glrm_result<span class="op">@</span>model<span class="op">$</span>representation_name))</span>
<span id="cb172-6"><a href="missing-values-and-imputation.html#cb172-6"></a></span>
<span id="cb172-7"><a href="missing-values-and-imputation.html#cb172-7"></a><span class="co"># Calculate variances for each archetype.</span></span>
<span id="cb172-8"><a href="missing-values-and-imputation.html#cb172-8"></a>(<span class="dt">variances =</span> <span class="kw">sapply</span>(new_data, stats<span class="op">::</span>var))</span></code></pre></div>
<pre><code>##      Arch1      Arch2      Arch3      Arch4      Arch5      Arch6      Arch7 
## 0.02260095 0.02191188 0.02752955 0.02226097 0.02311360 0.02408451 0.02040544 
##      Arch8      Arch9     Arch10 
## 0.01575170 0.03315694 0.02512172</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="missing-values-and-imputation.html#cb174-1"></a><span class="co"># Sort variances in descending order</span></span>
<span id="cb174-2"><a href="missing-values-and-imputation.html#cb174-2"></a>(<span class="dt">variances =</span> variances[<span class="kw">order</span>(variances, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)])</span></code></pre></div>
<pre><code>##      Arch9      Arch3     Arch10      Arch6      Arch5      Arch1      Arch4 
## 0.03315694 0.02752955 0.02512172 0.02408451 0.02311360 0.02260095 0.02226097 
##      Arch2      Arch7      Arch8 
## 0.02191188 0.02040544 0.01575170</code></pre>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="missing-values-and-imputation.html#cb176-1"></a>glrm_vars =<span class="st"> </span><span class="kw">data.frame</span>(variances, <span class="dt">pct_total =</span> variances <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(variances))</span>
<span id="cb176-2"><a href="missing-values-and-imputation.html#cb176-2"></a>glrm_vars<span class="op">$</span>cumulative_pct =<span class="st"> </span><span class="kw">cumsum</span>(glrm_vars<span class="op">$</span>pct_total)</span>
<span id="cb176-3"><a href="missing-values-and-imputation.html#cb176-3"></a>glrm_vars<span class="op">$</span>order =<span class="st"> </span><span class="kw">seq</span>(<span class="kw">nrow</span>(glrm_vars))</span>
<span id="cb176-4"><a href="missing-values-and-imputation.html#cb176-4"></a></span>
<span id="cb176-5"><a href="missing-values-and-imputation.html#cb176-5"></a>glrm_vars</span></code></pre></div>
<pre><code>##         variances  pct_total cumulative_pct order
## Arch9  0.03315694 0.14053286      0.1405329     1
## Arch3  0.02752955 0.11668165      0.2572145     2
## Arch10 0.02512172 0.10647628      0.3636908     3
## Arch6  0.02408451 0.10208015      0.4657710     4
## Arch5  0.02311360 0.09796503      0.5637360     5
## Arch1  0.02260095 0.09579221      0.6595282     6
## Arch4  0.02226097 0.09435124      0.7538794     7
## Arch2  0.02191188 0.09287162      0.8467510     8
## Arch7  0.02040544 0.08648673      0.9332378     9
## Arch8  0.01575170 0.06676223      1.0000000    10</code></pre>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="missing-values-and-imputation.html#cb178-1"></a><span class="kw">data.frame</span>(</span>
<span id="cb178-2"><a href="missing-values-and-imputation.html#cb178-2"></a>    <span class="dt">component  =</span> glrm_vars<span class="op">$</span>order,</span>
<span id="cb178-3"><a href="missing-values-and-imputation.html#cb178-3"></a>    <span class="dt">PVE =</span> glrm_vars<span class="op">$</span>pct_total,</span>
<span id="cb178-4"><a href="missing-values-and-imputation.html#cb178-4"></a>    <span class="dt">CVE =</span> glrm_vars<span class="op">$</span>cumulative_pct</span>
<span id="cb178-5"><a href="missing-values-and-imputation.html#cb178-5"></a>) <span class="op">%&gt;%</span></span>
<span id="cb178-6"><a href="missing-values-and-imputation.html#cb178-6"></a><span class="st">    </span>tidyr<span class="op">::</span><span class="kw">gather</span>(metric, variance_explained, <span class="op">-</span>component) <span class="op">%&gt;%</span></span>
<span id="cb178-7"><a href="missing-values-and-imputation.html#cb178-7"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(component, variance_explained)) <span class="op">+</span></span>
<span id="cb178-8"><a href="missing-values-and-imputation.html#cb178-8"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb178-9"><a href="missing-values-and-imputation.html#cb178-9"></a><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>metric, <span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<p><img src="data-science-in-r_files/figure-html/review_glrm-1.png" width="672" /></p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="missing-values-and-imputation.html#cb179-1"></a><span class="kw">ggsave</span>(<span class="st">&quot;visuals/imputation-glrm-component-plot-custom.png&quot;</span>)</span></code></pre></div>
<pre><code>## Saving 7 x 5 in image</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="missing-values-and-imputation.html#cb181-1"></a><span class="co"># Examine how many components (archetypes) to use.</span></span>
<span id="cb181-2"><a href="missing-values-and-imputation.html#cb181-2"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb181-3"><a href="missing-values-and-imputation.html#cb181-3"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb181-4"><a href="missing-values-and-imputation.html#cb181-4"></a></span>
<span id="cb181-5"><a href="missing-values-and-imputation.html#cb181-5"></a><span class="co"># Reconstructed data from GLRM.</span></span>
<span id="cb181-6"><a href="missing-values-and-imputation.html#cb181-6"></a>recon_df =<span class="st"> </span>h2o<span class="op">::</span><span class="kw">h2o.reconstruct</span>(glrm_result, h2o_df,</span>
<span id="cb181-7"><a href="missing-values-and-imputation.html#cb181-7"></a>                                <span class="dt">reverse_transform =</span> <span class="ot">TRUE</span>)</span>
<span id="cb181-8"><a href="missing-values-and-imputation.html#cb181-8"></a><span class="co"># Fix column names.</span></span>
<span id="cb181-9"><a href="missing-values-and-imputation.html#cb181-9"></a><span class="kw">names</span>(recon_df) =<span class="st"> </span><span class="kw">names</span>(impute_df)</span>
<span id="cb181-10"><a href="missing-values-and-imputation.html#cb181-10"></a></span>
<span id="cb181-11"><a href="missing-values-and-imputation.html#cb181-11"></a><span class="co"># Convert from h2o object back to an R df.</span></span>
<span id="cb181-12"><a href="missing-values-and-imputation.html#cb181-12"></a>recon_df =<span class="st"> </span><span class="kw">as.data.frame</span>(recon_df)</span>
<span id="cb181-13"><a href="missing-values-and-imputation.html#cb181-13"></a></span>
<span id="cb181-14"><a href="missing-values-and-imputation.html#cb181-14"></a><span class="co">#####################</span></span>
<span id="cb181-15"><a href="missing-values-and-imputation.html#cb181-15"></a><span class="co"># Quick quality review on age variable.</span></span>
<span id="cb181-16"><a href="missing-values-and-imputation.html#cb181-16"></a></span>
<span id="cb181-17"><a href="missing-values-and-imputation.html#cb181-17"></a><span class="co"># Compare imputed values to known values.</span></span>
<span id="cb181-18"><a href="missing-values-and-imputation.html#cb181-18"></a>known_age =<span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(impute_df<span class="op">$</span>age)</span>
<span id="cb181-19"><a href="missing-values-and-imputation.html#cb181-19"></a><span class="co"># Examine RMSE = 4.3</span></span>
<span id="cb181-20"><a href="missing-values-and-imputation.html#cb181-20"></a><span class="kw">sqrt</span>(<span class="kw">mean</span>((impute_df<span class="op">$</span>age[known_age] <span class="op">-</span><span class="st"> </span>recon_df<span class="op">$</span>age[known_age])<span class="op">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 5.018388</code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="missing-values-and-imputation.html#cb183-1"></a><span class="co"># Compare to median imputation, RMSE = 9.1</span></span>
<span id="cb183-2"><a href="missing-values-and-imputation.html#cb183-2"></a><span class="kw">sqrt</span>(<span class="kw">mean</span>((impute_df<span class="op">$</span>age[known_age] <span class="op">-</span><span class="st"> </span><span class="kw">median</span>(impute_df<span class="op">$</span>age[known_age]))<span class="op">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 9.122765</code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="missing-values-and-imputation.html#cb185-1"></a><span class="co"># Compare to mean imputation, RMSE = 9.1</span></span>
<span id="cb185-2"><a href="missing-values-and-imputation.html#cb185-2"></a><span class="kw">sqrt</span>(<span class="kw">mean</span>((impute_df<span class="op">$</span>age[known_age] <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(impute_df<span class="op">$</span>age[known_age]))<span class="op">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 9.095246</code></pre>
</div>
<div id="evaluate-imputation" class="section level3">
<h3><span class="header-section-number">3.4.11</span> Evaluate imputation</h3>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="missing-values-and-imputation.html#cb187-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: serialize GLRM h2o object for future reference.</span></span>
<span id="cb187-2"><a href="missing-values-and-imputation.html#cb187-2"></a></span>
<span id="cb187-3"><a href="missing-values-and-imputation.html#cb187-3"></a><span class="co"># Calculate median/mode imputation for comparison to GLRM.</span></span>
<span id="cb187-4"><a href="missing-values-and-imputation.html#cb187-4"></a>impute_info =</span>
<span id="cb187-5"><a href="missing-values-and-imputation.html#cb187-5"></a><span class="st">  </span>ck37r<span class="op">::</span><span class="kw">impute_missing_values</span>(data,</span>
<span id="cb187-6"><a href="missing-values-and-imputation.html#cb187-6"></a>                               <span class="co"># </span><span class="al">TODO</span><span class="co">: need to skip date variables, e.g. POSIXct.</span></span>
<span id="cb187-7"><a href="missing-values-and-imputation.html#cb187-7"></a>                               <span class="co"># This is yieling an h2o error currently.</span></span>
<span id="cb187-8"><a href="missing-values-and-imputation.html#cb187-8"></a>                               <span class="dt">skip_vars =</span> <span class="kw">c</span>(vars<span class="op">$</span>exclude, vars<span class="op">$</span>outcome),</span>
<span id="cb187-9"><a href="missing-values-and-imputation.html#cb187-9"></a>                               <span class="co"># Don&#39;t add indicators as we&#39;ve already created those.</span></span>
<span id="cb187-10"><a href="missing-values-and-imputation.html#cb187-10"></a>                               <span class="dt">add_indicators =</span> <span class="ot">FALSE</span>,</span>
<span id="cb187-11"><a href="missing-values-and-imputation.html#cb187-11"></a>                               <span class="dt">type =</span> <span class="st">&quot;standard&quot;</span>,</span>
<span id="cb187-12"><a href="missing-values-and-imputation.html#cb187-12"></a>                               <span class="dt">verbose =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## Found 11 variables with NAs.
## Running standard imputation.
## Imputing age (1 integer) with 5 NAs. Impute value: 55 
## Imputing sex (2 factor) with 2 NAs. Impute value: 1 
## Imputing cp (3 factor) with 4 NAs. Impute value: 0 
## Imputing chol (5 integer) with 3 NAs. Impute value: 240 
## Imputing fbs (6 integer) with 4 NAs. Impute value: 0 
## Imputing restecg (7 integer) with 5 NAs. Impute value: 1 
## Imputing thalach (8 integer) with 3 NAs. Impute value: 152 
## Imputing oldpeak (10 numeric) with 7 NAs. Impute value: 0.8 
## Imputing slope (11 factor) with 4 NAs. Impute value: 2 
## Imputing ca (12 factor) with 6 NAs. Impute value: 0 
## Imputing thal (13 factor) with 6 NAs. Impute value: 2</code></pre>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="missing-values-and-imputation.html#cb189-1"></a><span class="co"># Skip race because it&#39;s categorical.</span></span>
<span id="cb189-2"><a href="missing-values-and-imputation.html#cb189-2"></a><span class="co"># Also skip the &quot;impute to 0&quot; variables.</span></span>
<span id="cb189-3"><a href="missing-values-and-imputation.html#cb189-3"></a>(<span class="dt">vars_with_missingness =</span></span>
<span id="cb189-4"><a href="missing-values-and-imputation.html#cb189-4"></a>  var_df<span class="op">$</span>var[var_df<span class="op">$</span>missingness <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span>var_df<span class="op">$</span>var <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;race&quot;</span>) <span class="op">&amp;</span></span>
<span id="cb189-5"><a href="missing-values-and-imputation.html#cb189-5"></a><span class="st">             </span><span class="op">!</span>var_df<span class="op">$</span>var <span class="op">%in%</span><span class="st"> </span>impute_to_<span class="dv">0</span>_vars])</span></code></pre></div>
<pre><code>##  [1] &quot;ca&quot;      &quot;oldpeak&quot; &quot;restecg&quot; &quot;slope&quot;   &quot;age&quot;     &quot;sex&quot;     &quot;cp&quot;     
##  [8] &quot;thal&quot;    &quot;thalach&quot; &quot;chol&quot;    &quot;fbs&quot;</code></pre>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="missing-values-and-imputation.html#cb191-1"></a><span class="co"># Bound GLRM variables back to the original bounds.</span></span>
<span id="cb191-2"><a href="missing-values-and-imputation.html#cb191-2"></a><span class="cf">for</span> (var <span class="cf">in</span> vars_with_missingness) {</span>
<span id="cb191-3"><a href="missing-values-and-imputation.html#cb191-3"></a>  row =<span class="st"> </span>var_df[var_df<span class="op">$</span>var <span class="op">==</span><span class="st"> </span>var, , drop =<span class="st"> </span><span class="ot">FALSE</span>]</span>
<span id="cb191-4"><a href="missing-values-and-imputation.html#cb191-4"></a>  </span>
<span id="cb191-5"><a href="missing-values-and-imputation.html#cb191-5"></a>  <span class="co"># Skip factor vars.</span></span>
<span id="cb191-6"><a href="missing-values-and-imputation.html#cb191-6"></a>  <span class="cf">if</span> (row<span class="op">$</span>class <span class="op">!=</span><span class="st"> &quot;factor&quot;</span>) {</span>
<span id="cb191-7"><a href="missing-values-and-imputation.html#cb191-7"></a>    recon_df[[var]] =<span class="st"> </span><span class="kw">pmin</span>(<span class="kw">pmax</span>(recon_df[[var]], row<span class="op">$</span>min), row<span class="op">$</span>max)</span>
<span id="cb191-8"><a href="missing-values-and-imputation.html#cb191-8"></a>  }</span>
<span id="cb191-9"><a href="missing-values-and-imputation.html#cb191-9"></a>}</span>
<span id="cb191-10"><a href="missing-values-and-imputation.html#cb191-10"></a></span>
<span id="cb191-11"><a href="missing-values-and-imputation.html#cb191-11"></a><span class="co"># Round integer and ordinal vars back to be integers.</span></span>
<span id="cb191-12"><a href="missing-values-and-imputation.html#cb191-12"></a><span class="cf">for</span> (var <span class="cf">in</span> <span class="kw">c</span>(vars<span class="op">$</span>integers, vars<span class="op">$</span>ordinal)) {</span>
<span id="cb191-13"><a href="missing-values-and-imputation.html#cb191-13"></a>  <span class="co"># </span><span class="al">TODO</span><span class="co">: confirm if we need both round() and as.integer() here.</span></span>
<span id="cb191-14"><a href="missing-values-and-imputation.html#cb191-14"></a>  recon_df[[var]] =<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">round</span>(recon_df[[var]]))</span>
<span id="cb191-15"><a href="missing-values-and-imputation.html#cb191-15"></a>}</span>
<span id="cb191-16"><a href="missing-values-and-imputation.html#cb191-16"></a></span>
<span id="cb191-17"><a href="missing-values-and-imputation.html#cb191-17"></a></span>
<span id="cb191-18"><a href="missing-values-and-imputation.html#cb191-18"></a><span class="co"># Loop over each variable and compare GLRM imputation to median/mode imputation</span></span>
<span id="cb191-19"><a href="missing-values-and-imputation.html#cb191-19"></a><span class="co"># Use RMSE as a comparison metric.</span></span>
<span id="cb191-20"><a href="missing-values-and-imputation.html#cb191-20"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: use a training/test split to make this kosher.</span></span>
<span id="cb191-21"><a href="missing-values-and-imputation.html#cb191-21"></a>impute_compare =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">var =</span> vars_with_missingness,</span>
<span id="cb191-22"><a href="missing-values-and-imputation.html#cb191-22"></a>                            <span class="dt">loss =</span> losses[var_df<span class="op">$</span>var <span class="op">%in%</span><span class="st"> </span>vars_with_missingness, <span class="st">&quot;loss&quot;</span>],</span>
<span id="cb191-23"><a href="missing-values-and-imputation.html#cb191-23"></a>                            <span class="dt">missingness =</span> var_df[var_df<span class="op">$</span>var <span class="op">%in%</span><span class="st"> </span>vars_with_missingness, <span class="st">&quot;missingness&quot;</span>],</span>
<span id="cb191-24"><a href="missing-values-and-imputation.html#cb191-24"></a>                            <span class="dt">error_glrm =</span> <span class="ot">NA</span>,</span>
<span id="cb191-25"><a href="missing-values-and-imputation.html#cb191-25"></a>                            <span class="dt">error_median =</span> <span class="ot">NA</span>,</span>
<span id="cb191-26"><a href="missing-values-and-imputation.html#cb191-26"></a>                            <span class="dt">pct_reduction =</span> <span class="ot">NA</span>,</span>
<span id="cb191-27"><a href="missing-values-and-imputation.html#cb191-27"></a>                            <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span>
<span id="cb191-28"><a href="missing-values-and-imputation.html#cb191-28"></a></span>
<span id="cb191-29"><a href="missing-values-and-imputation.html#cb191-29"></a></span>
<span id="cb191-30"><a href="missing-values-and-imputation.html#cb191-30"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: get this to work with categorical variables.</span></span>
<span id="cb191-31"><a href="missing-values-and-imputation.html#cb191-31"></a><span class="co"># For now, remove categorical variables.</span></span>
<span id="cb191-32"><a href="missing-values-and-imputation.html#cb191-32"></a><span class="co">#(impute_compare = subset(impute_compare, loss != &quot;Categorical&quot;))</span></span>
<span id="cb191-33"><a href="missing-values-and-imputation.html#cb191-33"></a></span>
<span id="cb191-34"><a href="missing-values-and-imputation.html#cb191-34"></a></span>
<span id="cb191-35"><a href="missing-values-and-imputation.html#cb191-35"></a><span class="cf">for</span> (var <span class="cf">in</span> impute_compare<span class="op">$</span>var) {</span>
<span id="cb191-36"><a href="missing-values-and-imputation.html#cb191-36"></a>  <span class="co"># Obesity became a factor?</span></span>
<span id="cb191-37"><a href="missing-values-and-imputation.html#cb191-37"></a>  <span class="kw">cat</span>(<span class="st">&quot;Analzying&quot;</span>, var, <span class="kw">class</span>(data[[var]]), <span class="kw">class</span>(recon_df[[var]]), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb191-38"><a href="missing-values-and-imputation.html#cb191-38"></a>  </span>
<span id="cb191-39"><a href="missing-values-and-imputation.html#cb191-39"></a>  <span class="co"># Analyze the rows in which the variable is not missing.</span></span>
<span id="cb191-40"><a href="missing-values-and-imputation.html#cb191-40"></a>  observed_rows =<span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(data[[var]])</span>
<span id="cb191-41"><a href="missing-values-and-imputation.html#cb191-41"></a>  </span>
<span id="cb191-42"><a href="missing-values-and-imputation.html#cb191-42"></a>  <span class="co"># Calculate RMSE for GLRM.</span></span>
<span id="cb191-43"><a href="missing-values-and-imputation.html#cb191-43"></a>  error_glrm =<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">mean</span>((impute_df[observed_rows, var] <span class="op">-</span></span>
<span id="cb191-44"><a href="missing-values-and-imputation.html#cb191-44"></a><span class="st">                          </span>recon_df[observed_rows, var])<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb191-45"><a href="missing-values-and-imputation.html#cb191-45"></a>  </span>
<span id="cb191-46"><a href="missing-values-and-imputation.html#cb191-46"></a>  <span class="co"># Compare to median imputation.</span></span>
<span id="cb191-47"><a href="missing-values-and-imputation.html#cb191-47"></a>  error_median =<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">mean</span>((impute_df[observed_rows, var] <span class="op">-</span></span>
<span id="cb191-48"><a href="missing-values-and-imputation.html#cb191-48"></a><span class="st">                            </span>impute_info<span class="op">$</span>impute_values[[var]])<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb191-49"><a href="missing-values-and-imputation.html#cb191-49"></a>  </span>
<span id="cb191-50"><a href="missing-values-and-imputation.html#cb191-50"></a>  <span class="co"># Save results</span></span>
<span id="cb191-51"><a href="missing-values-and-imputation.html#cb191-51"></a>  impute_compare[impute_compare<span class="op">$</span>var <span class="op">==</span><span class="st"> </span>var,</span>
<span id="cb191-52"><a href="missing-values-and-imputation.html#cb191-52"></a>                 <span class="kw">c</span>(<span class="st">&quot;error_glrm&quot;</span>, <span class="st">&quot;error_median&quot;</span>)] =<span class="st"> </span><span class="kw">c</span>(error_glrm, error_median)</span>
<span id="cb191-53"><a href="missing-values-and-imputation.html#cb191-53"></a>}</span></code></pre></div>
<pre><code>## Analzying ca factor factor</code></pre>
<pre><code>## Warning in Ops.factor(impute_df[observed_rows, var], recon_df[observed_rows, :
## &#39;-&#39; not meaningful for factors</code></pre>
<pre><code>## Warning in Ops.factor(impute_df[observed_rows, var],
## impute_info$impute_values[[var]]): &#39;-&#39; not meaningful for factors</code></pre>
<pre><code>## Analzying oldpeak numeric numeric 
## Analzying restecg integer numeric 
## Analzying slope factor factor</code></pre>
<pre><code>## Warning in Ops.factor(impute_df[observed_rows, var], recon_df[observed_rows, :
## &#39;-&#39; not meaningful for factors

## Warning in Ops.factor(impute_df[observed_rows, var], recon_df[observed_rows, :
## &#39;-&#39; not meaningful for factors</code></pre>
<pre><code>## Analzying age integer numeric 
## Analzying sex factor factor</code></pre>
<pre><code>## Warning in Ops.factor(impute_df[observed_rows, var], recon_df[observed_rows, :
## &#39;-&#39; not meaningful for factors

## Warning in Ops.factor(impute_df[observed_rows, var], recon_df[observed_rows, :
## &#39;-&#39; not meaningful for factors</code></pre>
<pre><code>## Analzying cp factor factor</code></pre>
<pre><code>## Warning in Ops.factor(impute_df[observed_rows, var], recon_df[observed_rows, :
## &#39;-&#39; not meaningful for factors

## Warning in Ops.factor(impute_df[observed_rows, var], recon_df[observed_rows, :
## &#39;-&#39; not meaningful for factors</code></pre>
<pre><code>## Analzying thal factor factor</code></pre>
<pre><code>## Warning in Ops.factor(impute_df[observed_rows, var], recon_df[observed_rows, :
## &#39;-&#39; not meaningful for factors

## Warning in Ops.factor(impute_df[observed_rows, var], recon_df[observed_rows, :
## &#39;-&#39; not meaningful for factors</code></pre>
<pre><code>## Analzying thalach integer numeric 
## Analzying chol integer numeric 
## Analzying fbs integer numeric</code></pre>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="missing-values-and-imputation.html#cb204-1"></a>impute_compare<span class="op">$</span>pct_reduction =<span class="st">  </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>impute_compare<span class="op">$</span>error_glrm <span class="op">/</span><span class="st"> </span>impute_compare<span class="op">$</span>error_median</span>
<span id="cb204-2"><a href="missing-values-and-imputation.html#cb204-2"></a></span>
<span id="cb204-3"><a href="missing-values-and-imputation.html#cb204-3"></a>(<span class="dt">impute_compare =</span> impute_compare <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(<span class="kw">desc</span>(missingness)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.data.frame</span>())</span></code></pre></div>
<pre><code>##        var        loss missingness  error_glrm error_median pct_reduction
## 1  oldpeak       Huber  0.02310231  0.78744295    1.1901624     0.3383735
## 2       ca Categorical  0.01980198          NA           NA            NA
## 3     thal Categorical  0.01980198          NA           NA            NA
## 4  restecg       Huber  0.01650165  0.16977460    0.7071068     0.7599025
## 5      age       Huber  0.01650165  5.01838842    9.1227645     0.4499049
## 6    slope Categorical  0.01320132          NA           NA            NA
## 7       cp Categorical  0.01320132          NA           NA            NA
## 8      fbs       Huber  0.01320132  0.09768869    0.3879455     0.7481896
## 9  thalach       Huber  0.00990099 16.00993723   22.8834729     0.3003712
## 10    chol       Huber  0.00990099 37.75530167   52.2104715     0.2768634
## 11     sex Categorical  0.00660066          NA           NA            NA</code></pre>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="missing-values-and-imputation.html#cb206-1"></a><span class="kw">cat</span>(<span class="st">&quot;Average percent reduction in RMSE:&quot;</span>,</span>
<span id="cb206-2"><a href="missing-values-and-imputation.html#cb206-2"></a>    <span class="kw">round</span>(<span class="dv">100</span> <span class="op">*</span><span class="st"> </span><span class="kw">mean</span>(impute_compare<span class="op">$</span>pct_reduction, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Average percent reduction in RMSE: 47.9</code></pre>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="missing-values-and-imputation.html#cb208-1"></a><span class="kw">save</span>(impute_compare, <span class="dt">file =</span> <span class="st">&quot;data/imputation-comparison-glrm.RData&quot;</span>)</span>
<span id="cb208-2"><a href="missing-values-and-imputation.html#cb208-2"></a></span>
<span id="cb208-3"><a href="missing-values-and-imputation.html#cb208-3"></a><span class="co"># Make a separate copy for use in the paper.</span></span>
<span id="cb208-4"><a href="missing-values-and-imputation.html#cb208-4"></a>imput_comp =<span class="st"> </span>impute_compare</span>
<span id="cb208-5"><a href="missing-values-and-imputation.html#cb208-5"></a></span>
<span id="cb208-6"><a href="missing-values-and-imputation.html#cb208-6"></a>imput_comp<span class="op">$</span>pct_reduction =<span class="st"> </span><span class="kw">round</span>(imput_comp<span class="op">$</span>pct_reduction <span class="op">*</span><span class="st"> </span><span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb208-7"><a href="missing-values-and-imputation.html#cb208-7"></a>imput_comp<span class="op">$</span>missingness =<span class="st"> </span><span class="kw">round</span>(imput_comp<span class="op">$</span>missingness <span class="op">*</span><span class="st"> </span><span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb208-8"><a href="missing-values-and-imputation.html#cb208-8"></a></span>
<span id="cb208-9"><a href="missing-values-and-imputation.html#cb208-9"></a><span class="co"># Remove loss column.</span></span>
<span id="cb208-10"><a href="missing-values-and-imputation.html#cb208-10"></a>imput_comp<span class="op">$</span>loss =<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb208-11"><a href="missing-values-and-imputation.html#cb208-11"></a></span>
<span id="cb208-12"><a href="missing-values-and-imputation.html#cb208-12"></a><span class="kw">names</span>(imput_comp) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Variable&quot;</span>, <span class="st">&quot;Missingness&quot;</span>, <span class="st">&quot;Error GLRM&quot;</span>, <span class="st">&quot;Error Median&quot;</span>, <span class="st">&quot;Percent reduction&quot;</span>)</span>
<span id="cb208-13"><a href="missing-values-and-imputation.html#cb208-13"></a></span>
<span id="cb208-14"><a href="missing-values-and-imputation.html#cb208-14"></a></span>
<span id="cb208-15"><a href="missing-values-and-imputation.html#cb208-15"></a>(<span class="dt">kab_table =</span> <span class="kw">kable</span>(imput_comp, <span class="dt">format =</span> <span class="st">&quot;latex&quot;</span>, <span class="dt">digits =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>),</span>
<span id="cb208-16"><a href="missing-values-and-imputation.html#cb208-16"></a>                   <span class="dt">caption =</span> <span class="st">&quot;Comparing missing value imputation using GLRM versus median/mode&quot;</span>,</span>
<span id="cb208-17"><a href="missing-values-and-imputation.html#cb208-17"></a>                   <span class="dt">label =</span> <span class="st">&quot;imputation-comparison&quot;</span>,</span>
<span id="cb208-18"><a href="missing-values-and-imputation.html#cb208-18"></a>                   <span class="dt">booktabs =</span> <span class="ot">TRUE</span>))</span></code></pre></div>

<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="missing-values-and-imputation.html#cb209-1"></a><span class="kw">cat</span>(kab_table <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">latex_options =</span> <span class="st">&quot;striped&quot;</span>),</span>
<span id="cb209-2"><a href="missing-values-and-imputation.html#cb209-2"></a>    <span class="dt">file =</span> <span class="st">&quot;tables/imputation-comparison-glrm.tex&quot;</span>)</span>
<span id="cb209-3"><a href="missing-values-and-imputation.html#cb209-3"></a></span>
<span id="cb209-4"><a href="missing-values-and-imputation.html#cb209-4"></a>rio<span class="op">::</span><span class="kw">export</span>(imput_comp, <span class="dt">file =</span> <span class="st">&quot;tables/imputation-comparison-glrm.xlsx&quot;</span>)</span></code></pre></div>
</div>
<div id="replace-missing-values." class="section level3">
<h3><span class="header-section-number">3.4.12</span> Replace missing values.</h3>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="missing-values-and-imputation.html#cb210-1"></a><span class="co"># Now replace the missing values with imputed values.</span></span>
<span id="cb210-2"><a href="missing-values-and-imputation.html#cb210-2"></a><span class="cf">for</span> (var <span class="cf">in</span> impute_compare<span class="op">$</span>var) {</span>
<span id="cb210-3"><a href="missing-values-and-imputation.html#cb210-3"></a>  </span>
<span id="cb210-4"><a href="missing-values-and-imputation.html#cb210-4"></a>  <span class="co"># Analyze the rows in which the variable is not missing.</span></span>
<span id="cb210-5"><a href="missing-values-and-imputation.html#cb210-5"></a>  missing_rows =<span class="st"> </span><span class="kw">is.na</span>(data[[var]])</span>
<span id="cb210-6"><a href="missing-values-and-imputation.html#cb210-6"></a>  </span>
<span id="cb210-7"><a href="missing-values-and-imputation.html#cb210-7"></a>  data[missing_rows, var] =<span class="st"> </span>recon_df[missing_rows, var]</span>
<span id="cb210-8"><a href="missing-values-and-imputation.html#cb210-8"></a>}</span>
<span id="cb210-9"><a href="missing-values-and-imputation.html#cb210-9"></a></span>
<span id="cb210-10"><a href="missing-values-and-imputation.html#cb210-10"></a><span class="co"># Should be all 0&#39;s.</span></span>
<span id="cb210-11"><a href="missing-values-and-imputation.html#cb210-11"></a><span class="kw">summary</span>(<span class="kw">colMeans</span>(<span class="kw">is.na</span>(data)))</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##       0       0       0       0       0       0</code></pre>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="missing-values-and-imputation.html#cb212-1"></a><span class="kw">colSums</span>(<span class="kw">is.na</span>(data[, vars<span class="op">$</span>predictors]))</span></code></pre></div>
<pre><code>##      age      sex       cp trestbps     chol      fbs  restecg  thalach 
##        0        0        0        0        0        0        0        0 
##    exang  oldpeak    slope       ca     thal 
##        0        0        0        0        0</code></pre>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="missing-values-and-imputation.html#cb214-1"></a>data =<span class="st"> </span><span class="kw">cbind</span>(data, miss_inds)</span>
<span id="cb214-2"><a href="missing-values-and-imputation.html#cb214-2"></a>impute_info<span class="op">$</span>data =<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb214-3"><a href="missing-values-and-imputation.html#cb214-3"></a></span>
<span id="cb214-4"><a href="missing-values-and-imputation.html#cb214-4"></a><span class="kw">colnames</span>(data)</span></code></pre></div>
<pre><code>##  [1] &quot;age&quot;          &quot;sex&quot;          &quot;cp&quot;           &quot;trestbps&quot;     &quot;chol&quot;        
##  [6] &quot;fbs&quot;          &quot;restecg&quot;      &quot;thalach&quot;      &quot;exang&quot;        &quot;oldpeak&quot;     
## [11] &quot;slope&quot;        &quot;ca&quot;           &quot;thal&quot;         &quot;target&quot;       &quot;miss_age&quot;    
## [16] &quot;miss_sex&quot;     &quot;miss_cp&quot;      &quot;miss_chol&quot;    &quot;miss_fbs&quot;     &quot;miss_restecg&quot;
## [21] &quot;miss_thalach&quot; &quot;miss_exang&quot;   &quot;miss_oldpeak&quot; &quot;miss_slope&quot;   &quot;miss_ca&quot;     
## [26] &quot;miss_thal&quot;</code></pre>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="missing-values-and-imputation.html#cb216-1"></a><span class="co"># Update the predictors with the new missingness indicators.</span></span>
<span id="cb216-2"><a href="missing-values-and-imputation.html#cb216-2"></a>(vars<span class="op">$</span><span class="dt">predictors =</span> <span class="kw">setdiff</span>(<span class="kw">names</span>(data), <span class="kw">c</span>(vars<span class="op">$</span>exclude, vars<span class="op">$</span>outcomes)))</span></code></pre></div>
<pre><code>##  [1] &quot;age&quot;          &quot;sex&quot;          &quot;cp&quot;           &quot;trestbps&quot;     &quot;chol&quot;        
##  [6] &quot;fbs&quot;          &quot;restecg&quot;      &quot;thalach&quot;      &quot;exang&quot;        &quot;oldpeak&quot;     
## [11] &quot;slope&quot;        &quot;ca&quot;           &quot;thal&quot;         &quot;miss_age&quot;     &quot;miss_sex&quot;    
## [16] &quot;miss_cp&quot;      &quot;miss_chol&quot;    &quot;miss_fbs&quot;     &quot;miss_restecg&quot; &quot;miss_thalach&quot;
## [21] &quot;miss_exang&quot;   &quot;miss_oldpeak&quot; &quot;miss_slope&quot;   &quot;miss_ca&quot;      &quot;miss_thal&quot;</code></pre>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="missing-values-and-imputation.html#cb218-1"></a><span class="co"># Double-check missingness.</span></span>
<span id="cb218-2"><a href="missing-values-and-imputation.html#cb218-2"></a><span class="kw">colSums</span>(<span class="kw">is.na</span>(data))</span></code></pre></div>
<pre><code>##          age          sex           cp     trestbps         chol          fbs 
##            0            0            0            0            0            0 
##      restecg      thalach        exang      oldpeak        slope           ca 
##            0            0            0            0            0            0 
##         thal       target     miss_age     miss_sex      miss_cp    miss_chol 
##            0            0            0            0            0            0 
##     miss_fbs miss_restecg miss_thalach   miss_exang miss_oldpeak   miss_slope 
##            0            0            0            0            0            0 
##      miss_ca    miss_thal 
##            0            0</code></pre>
</div>
<div id="shutdown-h2o" class="section level3">
<h3><span class="header-section-number">3.4.13</span> Shutdown h2o</h3>
<p>This saves RAM, which is helpful especially on shared servers.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="missing-values-and-imputation.html#cb220-1"></a>h2o<span class="op">::</span><span class="kw">h2o.shutdown</span>(<span class="dt">prompt =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
</div>
</div>
<div id="update-predictor-summary" class="section level2">
<h2><span class="header-section-number">3.5</span> Update predictor summary</h2>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="missing-values-and-imputation.html#cb221-1"></a>result =<span class="st"> </span><span class="kw">summarize_vars</span>(data, vars<span class="op">$</span>predictors, <span class="dt">groups =</span> vars<span class="op">$</span>groups)</span></code></pre></div>
<pre><code>## Var: fbs 
## 
##                  0 0.0771160802470997  0.170076509369194  0.363667408225791 
##                255                  1                  1                  1 
##                  1 
##                 45 
## Var: restecg 
## 
##                 0 0.276255291712452 0.620070370142201  0.66372197263869 
##               146                 1                 1                 1 
## 0.950072559816494                 1  1.19642276841703                 2 
##                 1               149                 1                 3</code></pre>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="missing-values-and-imputation.html#cb223-1"></a><span class="co"># Export as a spreadsheet</span></span>
<span id="cb223-2"><a href="missing-values-and-imputation.html#cb223-2"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: use prettier variable names for this export and the latex table.</span></span>
<span id="cb223-3"><a href="missing-values-and-imputation.html#cb223-3"></a>rio<span class="op">::</span><span class="kw">export</span>(result<span class="op">$</span>table, <span class="dt">file =</span> <span class="st">&quot;tables/predictor-summary-imputed.xlsx&quot;</span>)</span>
<span id="cb223-4"><a href="missing-values-and-imputation.html#cb223-4"></a></span>
<span id="cb223-5"><a href="missing-values-and-imputation.html#cb223-5"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: output as a kableExtra latex table.</span></span>
<span id="cb223-6"><a href="missing-values-and-imputation.html#cb223-6"></a></span>
<span id="cb223-7"><a href="missing-values-and-imputation.html#cb223-7"></a>var_df =<span class="st"> </span>result<span class="op">$</span>table</span>
<span id="cb223-8"><a href="missing-values-and-imputation.html#cb223-8"></a>data =<span class="st"> </span>result<span class="op">$</span>data</span></code></pre></div>
</div>
<div id="histogram-condense" class="section level2">
<h2><span class="header-section-number">3.6</span> Histogram condense</h2>
<p>Apply histogram condensing to high-cardinality features</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="missing-values-and-imputation.html#cb224-1"></a>uniq_val_threshold =<span class="st"> </span>80L</span>
<span id="cb224-2"><a href="missing-values-and-imputation.html#cb224-2"></a></span>
<span id="cb224-3"><a href="missing-values-and-imputation.html#cb224-3"></a><span class="co"># These are the continuous vars with moderate or high missingness.</span></span>
<span id="cb224-4"><a href="missing-values-and-imputation.html#cb224-4"></a>(<span class="dt">dense_vars =</span> var_df[var_df<span class="op">$</span>uniq_vals <span class="op">&gt;</span><span class="st"> </span>uniq_val_threshold, <span class="kw">c</span>(<span class="st">&quot;var&quot;</span>, <span class="st">&quot;uniq_vals&quot;</span>)])</span></code></pre></div>
<pre><code>##        var uniq_vals
## 10 thalach        93
## 11    chol       155</code></pre>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="missing-values-and-imputation.html#cb226-1"></a>hist_bins =<span class="st"> </span>uniq_val_threshold</span>
<span id="cb226-2"><a href="missing-values-and-imputation.html#cb226-2"></a></span>
<span id="cb226-3"><a href="missing-values-and-imputation.html#cb226-3"></a><span class="cf">for</span> (dense_var <span class="cf">in</span> dense_vars<span class="op">$</span>var) {</span>
<span id="cb226-4"><a href="missing-values-and-imputation.html#cb226-4"></a>  <span class="co"># Confirm it has a large number of unique values.</span></span>
<span id="cb226-5"><a href="missing-values-and-imputation.html#cb226-5"></a>  num_unique =<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(data[[dense_var]]))</span>
<span id="cb226-6"><a href="missing-values-and-imputation.html#cb226-6"></a>  <span class="cf">if</span> (num_unique <span class="op">&gt;</span><span class="st"> </span>uniq_val_threshold) {</span>
<span id="cb226-7"><a href="missing-values-and-imputation.html#cb226-7"></a>    <span class="kw">print</span>(<span class="kw">qplot</span>(data[[dense_var]]) <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>() <span class="op">+</span></span>
<span id="cb226-8"><a href="missing-values-and-imputation.html#cb226-8"></a><span class="st">      </span><span class="kw">labs</span>(<span class="dt">x =</span> dense_var, <span class="dt">y =</span> <span class="st">&quot;original values&quot;</span>))</span>
<span id="cb226-9"><a href="missing-values-and-imputation.html#cb226-9"></a>    </span>
<span id="cb226-10"><a href="missing-values-and-imputation.html#cb226-10"></a>    <span class="co"># Try histogram binning vs. equal-sized group binning.</span></span>
<span id="cb226-11"><a href="missing-values-and-imputation.html#cb226-11"></a>    hist_vec2 =<span class="st"> </span>histogram<span class="op">::</span><span class="kw">histogram</span>(data[[dense_var]],</span>
<span id="cb226-12"><a href="missing-values-and-imputation.html#cb226-12"></a>                                     <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">maxbin =</span> hist_bins))</span>
<span id="cb226-13"><a href="missing-values-and-imputation.html#cb226-13"></a>    </span>
<span id="cb226-14"><a href="missing-values-and-imputation.html#cb226-14"></a>    <span class="co"># Apply histogram binning to original data vector.</span></span>
<span id="cb226-15"><a href="missing-values-and-imputation.html#cb226-15"></a>    cuts =<span class="st"> </span><span class="kw">cut</span>(data[[dense_var]], <span class="dt">breaks =</span> hist_vec2<span class="op">$</span>breaks,</span>
<span id="cb226-16"><a href="missing-values-and-imputation.html#cb226-16"></a>               <span class="co"># If we don&#39;t specify this, all obs with lowest value will get an NA.</span></span>
<span id="cb226-17"><a href="missing-values-and-imputation.html#cb226-17"></a>               <span class="dt">include.lowest =</span> <span class="ot">TRUE</span>)</span>
<span id="cb226-18"><a href="missing-values-and-imputation.html#cb226-18"></a>    </span>
<span id="cb226-19"><a href="missing-values-and-imputation.html#cb226-19"></a>    </span>
<span id="cb226-20"><a href="missing-values-and-imputation.html#cb226-20"></a>    <span class="co"># Use the midpoint of each bin as the new value.</span></span>
<span id="cb226-21"><a href="missing-values-and-imputation.html#cb226-21"></a>    mid_vals =<span class="st"> </span>hist_vec2<span class="op">$</span>mids[<span class="kw">as.numeric</span>(cuts)]</span>
<span id="cb226-22"><a href="missing-values-and-imputation.html#cb226-22"></a>    </span>
<span id="cb226-23"><a href="missing-values-and-imputation.html#cb226-23"></a>    <span class="co"># Check for missing values in the dense vars.</span></span>
<span id="cb226-24"><a href="missing-values-and-imputation.html#cb226-24"></a>    <span class="cf">if</span> (<span class="kw">sum</span>(<span class="kw">is.na</span>(mid_vals)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) {</span>
<span id="cb226-25"><a href="missing-values-and-imputation.html#cb226-25"></a>      <span class="kw">stop</span>(<span class="st">&quot;missing values in mid_vals&quot;</span>)</span>
<span id="cb226-26"><a href="missing-values-and-imputation.html#cb226-26"></a>    }</span>
<span id="cb226-27"><a href="missing-values-and-imputation.html#cb226-27"></a>    </span>
<span id="cb226-28"><a href="missing-values-and-imputation.html#cb226-28"></a>    <span class="co"># Update variable to use the mid_vals</span></span>
<span id="cb226-29"><a href="missing-values-and-imputation.html#cb226-29"></a>    data[[dense_var]] =<span class="st"> </span>mid_vals</span>
<span id="cb226-30"><a href="missing-values-and-imputation.html#cb226-30"></a>    <span class="kw">print</span>(<span class="kw">qplot</span>(mid_vals) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> dense_var, <span class="dt">y =</span> <span class="st">&quot;mid_vals&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>())</span>
<span id="cb226-31"><a href="missing-values-and-imputation.html#cb226-31"></a>  }</span>
<span id="cb226-32"><a href="missing-values-and-imputation.html#cb226-32"></a>  </span>
<span id="cb226-33"><a href="missing-values-and-imputation.html#cb226-33"></a>}</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Choosing between regular and irregular histogram:
## 
## 1.Building regular histogram with maximum number of bins 53.
## - Choosing number of bins via maximum likelihood with BR penalty.
## - Number of bins chosen: 10.
## 
## 
## 2.Building irregular histogram.
## - Using finest grid based on observations.
## - Choosing number of bins via maximum likelihood with PENB penalty.
## - Computing weights for dynamic programming algorithm.
## - Now performing dynamic optimization.
## - Number of bins chosen: 4.
## 
## 
## 
## Regular histogram chosen.</code></pre>
<p><img src="data-science-in-r_files/figure-html/histogram_condense-1.png" width="672" /><img src="data-science-in-r_files/figure-html/histogram_condense-2.png" width="672" /></p>
<pre><code>## $breaks
##  [1]  71.0  84.1  97.2 110.3 123.4 136.5 149.6 162.7 175.8 188.9 202.0
## 
## $counts
##  [1]  1  6 11 26 35 53 78 63 26  4
## 
## $density
##  [1] 0.0002519336 0.0015116015 0.0027712695 0.0065502733 0.0088176757
##  [6] 0.0133524803 0.0196508200 0.0158718162 0.0065502733 0.0010077344
## 
## $mids
##  [1]  77.55  90.65 103.75 116.85 129.95 143.05 156.15 169.25 182.35 195.45
## 
## $xname
## [1] &quot;data[[dense_var]]&quot;
## 
## $equidist
## [1] TRUE
## 
## attr(,&quot;class&quot;)
## [1] &quot;histogram&quot;</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="data-science-in-r_files/figure-html/histogram_condense-3.png" width="672" /></p>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## Choosing between regular and irregular histogram:
## 
## 1.Building regular histogram with maximum number of bins 53.
## - Choosing number of bins via maximum likelihood with BR penalty.
## - Number of bins chosen: 9.
## 
## 
## 2.Building irregular histogram.
## - Using finest grid based on observations.
## - Choosing number of bins via maximum likelihood with PENB penalty.
## - Using greedy procedure to recursively build a finest partition with at most 100 bins.
## - Pre-selected finest partition with 100 bins.
## - Computing weights for dynamic programming algorithm.
## - Now performing dynamic optimization.
## - Number of bins chosen: 5.
## 
## 
## 
## Regular histogram chosen.</code></pre>
<p><img src="data-science-in-r_files/figure-html/histogram_condense-4.png" width="672" /><img src="data-science-in-r_files/figure-html/histogram_condense-5.png" width="672" /></p>
<pre><code>## $breaks
##  [1] 126.0000 174.6667 223.3333 272.0000 320.6667 369.3333 418.0000 466.6667
##  [9] 515.3333 564.0000
## 
## $counts
## [1]  14  92 118  58  16   4   0   0   1
## 
## $density
## [1] 0.000949410 0.006238980 0.008002170 0.003933270 0.001085040 0.000271260
## [7] 0.000000000 0.000000000 0.000067815
## 
## $mids
## [1] 150.3333 199.0000 247.6667 296.3333 345.0000 393.6667 442.3333 491.0000
## [9] 539.6667
## 
## $xname
## [1] &quot;data[[dense_var]]&quot;
## 
## $equidist
## [1] TRUE
## 
## attr(,&quot;class&quot;)
## [1] &quot;histogram&quot;</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="data-science-in-r_files/figure-html/histogram_condense-6.png" width="672" /></p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="missing-values-and-imputation.html#cb234-1"></a><span class="co"># Check for missing data.</span></span>
<span id="cb234-2"><a href="missing-values-and-imputation.html#cb234-2"></a><span class="kw">colSums</span>(<span class="kw">is.na</span>(data[, dense_vars<span class="op">$</span>var]))</span></code></pre></div>
<pre><code>## thalach    chol 
##       0       0</code></pre>
</div>
<div id="update-predictor-summary-1" class="section level2">
<h2><span class="header-section-number">3.7</span> Update predictor summary</h2>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="missing-values-and-imputation.html#cb236-1"></a>result =<span class="st"> </span><span class="kw">summarize_vars</span>(data, vars<span class="op">$</span>predictors, <span class="dt">groups =</span> vars<span class="op">$</span>groups)</span></code></pre></div>
<pre><code>## Var: chol 
## 
## 150.333333333333              199 247.666666666667 296.333333333333 
##               14               92              118               58 
##              345 393.666666666667 539.666666666667 
##               16                4                1 
## Var: fbs 
## 
##                  0 0.0771160802470997  0.170076509369194  0.363667408225791 
##                255                  1                  1                  1 
##                  1 
##                 45 
## Var: restecg 
## 
##                 0 0.276255291712452 0.620070370142201  0.66372197263869 
##               146                 1                 1                 1 
## 0.950072559816494                 1  1.19642276841703                 2 
##                 1               149                 1                 3 
## Var: thalach 
## 
##  77.55  90.65 103.75 116.85 129.95 143.05 156.15 169.25 182.35 195.45 
##      1      6     11     26     35     53     78     63     26      4</code></pre>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="missing-values-and-imputation.html#cb238-1"></a><span class="co"># Export as a spreadsheet</span></span>
<span id="cb238-2"><a href="missing-values-and-imputation.html#cb238-2"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: use prettier variable names for this export and the latex table.</span></span>
<span id="cb238-3"><a href="missing-values-and-imputation.html#cb238-3"></a>rio<span class="op">::</span><span class="kw">export</span>(result<span class="op">$</span>table, <span class="dt">file =</span> <span class="st">&quot;tables/predictor-summary-imputed-condensed.xlsx&quot;</span>)</span>
<span id="cb238-4"><a href="missing-values-and-imputation.html#cb238-4"></a></span>
<span id="cb238-5"><a href="missing-values-and-imputation.html#cb238-5"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: output as a kableExtra latex table.</span></span>
<span id="cb238-6"><a href="missing-values-and-imputation.html#cb238-6"></a>var_df =<span class="st"> </span>result<span class="op">$</span>table</span></code></pre></div>
</div>
<div id="save-imputed-dataset" class="section level2 unnumbered">
<h2>Save imputed dataset</h2>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="missing-values-and-imputation.html#cb239-1"></a><span class="kw">save</span>(data, vars, var_df,</span>
<span id="cb239-2"><a href="missing-values-and-imputation.html#cb239-2"></a>     <span class="dt">file =</span> <span class="st">&quot;data/clean-impute.RData&quot;</span>)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="initial-data-import.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="dataset-finalization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
